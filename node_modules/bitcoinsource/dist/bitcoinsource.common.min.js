"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var _=_interopDefault(require("lodash")),elliptic=_interopDefault(require("elliptic")),BN=_interopDefault(require("bn.js")),bs58=_interopDefault(require("bs58")),cashaddr=_interopDefault(require("cashaddrjs")),hash=_interopDefault(require("hash.js")),assert=_interopDefault(require("assert")),randomBytes=_interopDefault(require("randombytes")),bufferCompare=_interopDefault(require("buffer-compare")),unorm=_interopDefault(require("unorm")),URL=_interopDefault(require("url"));const docsURL="http://bitcore.io/";var data=[{name:"InvalidB58Char",message:"Invalid Base58 character: {0} in {1}"},{name:"InvalidB58Checksum",message:"Invalid Base58 checksum for {0}"},{name:"InvalidNetwork",message:"Invalid version for network: got {0}"},{name:"InvalidState",message:"Invalid state: {0}"},{name:"NotImplemented",message:"Function {0} was not implemented yet"},{name:"InvalidNetworkArgument",message:'Invalid network: must be "livenet" or "testnet", got {0}'},{name:"InvalidArgument",message(){return"Invalid Argument".concat((0>=arguments.length?void 0:arguments[0])?": ".concat(0>=arguments.length?void 0:arguments[0]):"").concat((1>=arguments.length?void 0:arguments[1])?" Documentation: ".concat(docsURL).concat(1>=arguments.length?void 0:arguments[1]):"")}},{name:"AbstractMethodInvoked",message:"Abstract Method Invocation: {0}"},{name:"InvalidArgumentType",message(){return"Invalid Argument for ".concat(2>=arguments.length?void 0:arguments[2],", expected ").concat(1>=arguments.length?void 0:arguments[1]," but got ").concat(typeof(0>=arguments.length?void 0:arguments[0]))}},{name:"Unit",message:"Internal Error on Unit {0}",errors:[{name:"UnknownCode",message:"Unrecognized unit code: {0}"},{name:"InvalidRate",message:"Invalid exchange rate: {0}"}]},{name:"Transaction",message:"Internal Error on Transaction {0}",errors:[{name:"Input",message:"Internal Error on Input {0}",errors:[{name:"MissingScript",message:"Need a script to create an input"},{name:"UnsupportedScript",message:"Unsupported input script type: {0}"},{name:"MissingPreviousOutput",message:"No previous output information."}]},{name:"NeedMoreInfo",message:"{0}"},{name:"InvalidSorting",message:"The sorting function provided did not return the change output as one of the array elements"},{name:"InvalidOutputAmountSum",message:"{0}"},{name:"MissingSignatures",message:"Some inputs have not been fully signed"},{name:"InvalidIndex",message:"Invalid index: {0} is not between 0, {1}"},{name:"UnableToVerifySignature",message:"Unable to verify signature: {0}"},{name:"DustOutputs",message:"Dust amount detected in one output"},{name:"InvalidSatoshis",message:"Output satoshis are invalid"},{name:"FeeError",message:"Internal Error on Fee {0}",errors:[{name:"TooSmall",message:"Fee is too small: {0}"},{name:"TooLarge",message:"Fee is too large: {0}"},{name:"Different",message:"Unspent value is different from specified fee: {0}"}]},{name:"ChangeAddressMissing",message:"Change address is missing"},{name:"BlockHeightTooHigh",message:"Block Height can be at most 2^32 -1"},{name:"NLockTimeOutOfRange",message:"Block Height can only be between 0 and 499 999 999"},{name:"LockTimeTooEarly",message:"Lock Time can't be earlier than UNIX date 500 000 000"}]},{name:"Script",message:"Internal Error on Script {0}",errors:[{name:"UnrecognizedAddress",message:"Expected argument {0} to be an address"},{name:"CantDeriveAddress",message:"Can't derive address associated with script {0}, needs to be p2pkh in, p2pkh out, p2sh in, or p2sh out."},{name:"InvalidBuffer",message:"Invalid script buffer: can't parse valid script from given buffer {0}"}]},{name:"HDPrivateKey",message:"Internal Error on HDPrivateKey {0}",errors:[{name:"InvalidDerivationArgument",message:"Invalid derivation argument {0}, expected string, or number and boolean"},{name:"InvalidEntropyArgument",message:"Invalid entropy: must be an hexa string or binary buffer, got {0}",errors:[{name:"TooMuchEntropy",message:'Invalid entropy: more than 512 bits is non standard, got "{0}"'},{name:"NotEnoughEntropy",message:'Invalid entropy: at least 128 bits needed, got "{0}"'}]},{name:"InvalidLength",message:"Invalid length for xprivkey string in {0}"},{name:"InvalidPath",message:"Invalid derivation path: {0}"},{name:"UnrecognizedArgument",message:'Invalid argument: creating a HDPrivateKey requires a string, buffer, json or object, got "{0}"'}]},{name:"HDPublicKey",message:"Internal Error on HDPublicKey {0}",errors:[{name:"ArgumentIsPrivateExtended",message:"Argument is an extended private key: {0}"},{name:"InvalidDerivationArgument",message:"Invalid derivation argument: got {0}"},{name:"InvalidLength",message:'Invalid length for xpubkey: got "{0}"'},{name:"InvalidPath",message:'Invalid derivation path, it should look like: "m/1/100", got "{0}"'},{name:"InvalidIndexCantDeriveHardened",message:"Invalid argument: creating a hardened path requires an HDPrivateKey"},{name:"MustSupplyArgument",message:"Must supply an argument to create a HDPublicKey"},{name:"UnrecognizedArgument",message:"Invalid argument for creation, must be string, json, buffer, or object"}]},{name:"Mnemonic",message:"Internal Error on bitcore-mnemonic module {0}",errors:[{name:"InvalidEntropy",message:"Entropy length must be an even multiple of 11 bits: {0}"},{name:"UnknownWordlist",message:"Could not detect the used word list: {0}"},{name:"InvalidMnemonic",message:"Mnemonic string is invalid: {0}"}]}];function format(e,t){return e.replace("{0}",t[0]).replace("{1}",t[1]).replace("{2}",t[2])}const traverseNode=function(e,t){const r=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];if(_.isString(t.message))this.message=format(t.message,r);else{if(!_.isFunction(t.message))throw new Error("Invalid error definition for ".concat(t.name));this.message=t.message.apply(null,r)}this.stack="".concat(this.message,"\n").concat((new Error).stack)};return(r.prototype=Object.create(e.prototype)).name=e.prototype.name+t.name,e[t.name]=r,t.errors&&childDefinitions(r,t.errors),r},childDefinitions=function(e,t){_.each(t,t=>traverseNode(e,t))},traverseRoot=function(e,t){return childDefinitions(e,t),e},bitcore={Error:function(){this.message="Internal error",this.stack="".concat(this.message,"\n").concat((new Error).stack)}};bitcore.Error.prototype=Object.create(Error.prototype),bitcore.Error.prototype.name="bitcore.Error",traverseRoot(bitcore.Error,data),bitcore.Error.extend=function(e){return traverseNode(bitcore.Error,e)};var errors=bitcore.Error,preconditions={checkState(e,t){if(!e)throw new errors.InvalidState(t)},checkArgument(e,t,r,i){if(!e)throw new errors.InvalidArgument(t,r,i)},checkArgumentType(e,t,r){if(r=r||"(unknown name)",_.isString(t)){if("Buffer"===t){if(!Buffer.isBuffer(e))throw new errors.InvalidArgumentType(e,t,r)}else if(typeof e!==t)throw new errors.InvalidArgumentType(e,t,r)}else if(!(e instanceof t))throw new errors.InvalidArgumentType(e,t.name,r)}};const ALPHABET=["1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Base58=function e(t){if(!(this instanceof e))return new e(t);Buffer.isBuffer(t)?this.fromBuffer(t):"string"==typeof t?this.fromString(t):t&&this.set(t)};Base58.validCharacters=function(e){return Buffer.isBuffer(e)&&(e=e.toString()),_.every(_.map(e,e=>_.includes(ALPHABET,e)))},Base58.prototype.set=function(e){return this.buf=e.buf||this.buf||void 0,this},Base58.encode=function(e){if(!Buffer.isBuffer(e))throw new Error("Input should be a buffer");return bs58.encode(e)},Base58.decode=function(e){if("string"!=typeof e)throw new Error("Input should be a string");return Buffer.from(bs58.decode(e))},Base58.prototype.fromBuffer=function(e){return this.buf=e,this},Base58.prototype.fromString=function(e){const t=Base58.decode(e);return this.buf=t,this},Base58.prototype.toBuffer=function(){return this.buf},Base58.prototype.toString=function(){return Base58.encode(this.buf)};const isHexa=function(e){return!!_.isString(e)&&/^[0-9a-fA-F]+$/.test(e)};var JSUtil={isValidJSON:function(e){let t;if(!_.isString(e))return!1;try{t=JSON.parse(e)}catch(e){return!1}return!("object"!=typeof t)},isHexa:isHexa,isHexaString:isHexa,cloneArray:e=>[].concat(e),defineImmutable:function(e,t){return Object.keys(t).forEach(r=>{Object.defineProperty(e,r,{configurable:!1,enumerable:!0,value:t[r]})}),e},isNaturalNumber:function(e){return"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e&&0<=e}};function equals(e,t){if(e.length!==t.length)return!1;const r=e.length;for(let i=0;i<r;i+=1)if(e[i]!==t[i])return!1;return!0}const BufferUtil={fill:function(e,t){preconditions.checkArgumentType(e,"Buffer","buffer"),preconditions.checkArgumentType(t,"number","value");const r=e.length;for(let i=0;i<r;i+=1)e[i]=t;return e},copy(e){const t=Buffer.alloc(e.length);return e.copy(t),t},isBuffer:function(e){return Buffer.isBuffer(e)||e instanceof Uint8Array},emptyBuffer:function(e){preconditions.checkArgumentType(e,"number","bytes");const t=Buffer.alloc(e);for(let r=0;r<e;r+=1)t.write("\0",r);return t},concat:Buffer.concat,equals:equals,equal:equals,integerAsSingleByteBuffer:function(e){return preconditions.checkArgumentType(e,"number","integer"),Buffer.from([255&e])},integerAsBuffer:function(e){return preconditions.checkArgumentType(e,"number","integer"),Buffer.from([255&e>>24,255&e>>16,255&e>>8,255&e])},integerFromBuffer:function(e){return preconditions.checkArgumentType(e,"Buffer","buffer"),e[0]<<24|e[1]<<16|e[2]<<8|e[3]},integerFromSingleByteBuffer:function(e){return preconditions.checkArgumentType(e,"Buffer","buffer"),e[0]},bufferToHex:function(e){return preconditions.checkArgumentType(e,"Buffer","buffer"),e.toString("hex")},reverse:function(e){const t=Buffer.alloc(e.length);for(let r=0;r<e.length;r+=1)t[r]=e[e.length-r-1];return t},hexToBuffer:function(e){return assert(JSUtil.isHexa(e)),Buffer.from(e,"hex")}};BufferUtil.NULL_HASH=BufferUtil.fill(Buffer.alloc(32),0),BufferUtil.EMPTY_BUFFER=Buffer.alloc(0);const Hash={sha1:function(e){preconditions.checkArgument(BufferUtil.isBuffer(e));const t=hash.sha1().update(e).digest("hex");return Buffer.from(t,"hex")}};Hash.sha1.blocksize=512,Hash.sha256=function(e){preconditions.checkArgument(BufferUtil.isBuffer(e));const t=hash.sha256().update(e).digest("hex");return Buffer.from(t,"hex")},Hash.sha256.blocksize=512,Hash.sha256sha256=function(e){return preconditions.checkArgument(BufferUtil.isBuffer(e)),Hash.sha256(Hash.sha256(e))},Hash.ripemd160=function(e){preconditions.checkArgument(BufferUtil.isBuffer(e));const t=hash.ripemd160().update(e).digest("hex");return Buffer.from(t,"hex")},Hash.sha256ripemd160=function(e){return preconditions.checkArgument(BufferUtil.isBuffer(e)),Hash.ripemd160(Hash.sha256(e))},Hash.sha512=function(e){preconditions.checkArgument(BufferUtil.isBuffer(e));const t=hash.sha512().update(e).digest("hex");return Buffer.from(t,"hex")},Hash.sha512.blocksize=1024,Hash.hmac=function(e,t,r){preconditions.checkArgument(BufferUtil.isBuffer(t)),preconditions.checkArgument(BufferUtil.isBuffer(r)),preconditions.checkArgument(e.blocksize);const i=e.blocksize/8;if(r.length>i)r=e(r);else if(r<i){const e=Buffer.alloc(i);e.fill(0),r.copy(e),r=e}const o=Buffer.alloc(i);o.fill(92);const n=Buffer.alloc(i);n.fill(54);const a=Buffer.alloc(i),s=Buffer.alloc(i);for(let e=0;e<i;e+=1)a[e]=o[e]^r[e],s[e]=n[e]^r[e];return e(Buffer.concat([a,e(Buffer.concat([s,t]))]))},Hash.sha256hmac=function(e,t){return Hash.hmac(Hash.sha256,e,t)},Hash.sha512hmac=function(e,t){return Hash.hmac(Hash.sha512,e,t)};const Base58Check=function e(t){if(!(this instanceof e))return new e(t);Buffer.isBuffer(t)?this.fromBuffer(t):"string"==typeof t?this.fromString(t):t&&this.set(t)};Base58Check.prototype.set=function(e){return this.buf=e.buf||this.buf||void 0,this},Base58Check.validChecksum=function(e,t){return _.isString(e)&&(e=Buffer.from(Base58.decode(e))),_.isString(t)&&(t=Buffer.from(Base58.decode(t))),t||(t=e.slice(-4),e=e.slice(0,-4)),Base58Check.checksum(e).toString("hex")===t.toString("hex")},Base58Check.decode=function(e){if("string"!=typeof e)throw new Error("Input must be a string");const t=Buffer.from(Base58.decode(e));if(4>t.length)throw new Error("Input string too short");const r=t.slice(0,-4),i=t.slice(-4),o=Hash.sha256sha256(r).slice(0,4);if(i.toString("hex")!==o.toString("hex"))throw new Error("Checksum mismatch");return r},Base58Check.checksum=function(e){return Hash.sha256sha256(e).slice(0,4)},Base58Check.encode=function(e){if(!Buffer.isBuffer(e))throw new Error("Input must be a buffer");const t=Buffer.alloc(e.length+4),r=Base58Check.checksum(e);return e.copy(t),r.copy(t,e.length),Base58.encode(t)},Base58Check.prototype.fromBuffer=function(e){return this.buf=e,this},Base58Check.prototype.fromString=function(e){const t=Base58Check.decode(e);return this.buf=t,this},Base58Check.prototype.toBuffer=function(){return this.buf},Base58Check.prototype.toString=function(){return Base58Check.encode(this.buf)};const networks=[],networkMaps={};function Network(){}function get(e,t){if(~networks.indexOf(e))return e;if(t){_.isArray(t)||(t=[t]);const r=networks.findIndex(r=>_.some(t,t=>r[t]===e));return-1===r?void 0:networks[r]}return networkMaps[e]}function addNetwork(e){const t=new Network;return JSUtil.defineImmutable(t,{name:e.name,alias:e.alias,pubkeyhash:e.pubkeyhash,privatekey:e.privatekey,scripthash:e.scripthash,xpubkey:e.xpubkey,xprivkey:e.xprivkey}),e.networkMagic&&JSUtil.defineImmutable(t,{networkMagic:BufferUtil.integerAsBuffer(e.networkMagic)}),e.port&&JSUtil.defineImmutable(t,{port:e.port}),e.dnsSeeds&&JSUtil.defineImmutable(t,{dnsSeeds:e.dnsSeeds}),_.each(t,e=>{_.isUndefined(e)||_.isObject(e)||(networkMaps[e]=t)}),networks.push(t),t}function removeNetwork(e){for(let t=0;t<networks.length;t+=1)networks[t]===e&&networks.splice(t,1);Object.keys(networkMaps).forEach(t=>{networkMaps[t]===e&&delete networkMaps[t]})}Network.prototype.toString=function(){return this.name},addNetwork({name:"livenet",alias:"mainnet",pubkeyhash:0,privatekey:128,scripthash:5,xpubkey:76067358,xprivkey:76066276,networkMagic:4190024921,port:8333,dnsSeeds:["seed.bitcoin.sipa.be","dnsseed.bluematt.me","dnsseed.bitcoin.dashjr.org","seed.bitcoinstats.com","seed.bitnodes.io","bitseed.xf2.org"]});const livenet=get("livenet");addNetwork({name:"testnet",alias:"regtest",pubkeyhash:111,privatekey:239,scripthash:196,xpubkey:70617039,xprivkey:70615956});const testnet=get("testnet"),TESTNET={PORT:18333,NETWORK_MAGIC:BufferUtil.integerAsBuffer(185665799),DNS_SEEDS:["testnet-seed.bitcoin.petertodd.org","testnet-seed.bluematt.me","testnet-seed.alexykot.me","testnet-seed.bitcoin.schildbach.de"]};Object.keys(TESTNET).forEach(e=>{_.isObject(TESTNET[e])||(networkMaps[TESTNET[e]]=testnet)});const REGTEST={PORT:18444,NETWORK_MAGIC:BufferUtil.integerAsBuffer(4206867930),DNS_SEEDS:[]};function enableRegtest(){testnet.regtestEnabled=!0}function disableRegtest(){testnet.regtestEnabled=!1}Object.keys(REGTEST).forEach(e=>{_.isObject(REGTEST[e])||(networkMaps[REGTEST[e]]=testnet)}),Object.defineProperty(testnet,"port",{enumerable:!0,configurable:!1,get(){return this.regtestEnabled?REGTEST.PORT:TESTNET.PORT}}),Object.defineProperty(testnet,"networkMagic",{enumerable:!0,configurable:!1,get(){return this.regtestEnabled?REGTEST.NETWORK_MAGIC:TESTNET.NETWORK_MAGIC}}),Object.defineProperty(testnet,"dnsSeeds",{enumerable:!0,configurable:!1,get(){return this.regtestEnabled?REGTEST.DNS_SEEDS:TESTNET.DNS_SEEDS}});var Networks={add:addNetwork,remove:removeNetwork,defaultNetwork:livenet,livenet:livenet,mainnet:livenet,testnet:testnet,get:get,enableRegtest:enableRegtest,disableRegtest:disableRegtest};const reversebuf=function(e){const t=Buffer.alloc(e.length);for(let r=0;r<e.length;r+=1)t[r]=e[e.length-1-r];return t};BN.Zero=new BN(0),BN.One=new BN(1),BN.Minus1=new BN(-1),BN.fromNumber=function(e){return preconditions.checkArgument(_.isNumber(e)),new BN(e)},BN.fromString=function(e,t){return preconditions.checkArgument(_.isString(e)),new BN(e,t)},BN.fromBuffer=function(e,t){void 0!==t&&"little"===t.endian&&(e=reversebuf(e));const r=e.toString("hex");return new BN(r,16)},BN.fromSM=function(e,t){let r;if(0===e.length)return BN.fromBuffer(Buffer.from([0]));let i="big";return t&&(i=t.endian),"little"===i&&(e=reversebuf(e)),128&e[0]?(e[0]&=127,(r=BN.fromBuffer(e)).neg().copy(r)):r=BN.fromBuffer(e),r},BN.prototype.toNumber=function(){return parseInt(this.toString(10),10)},BN.prototype.toBuffer=function(e){let t,r;if(e&&e.size){const i=(r=this.toString(16,2)).length/2;t=Buffer.from(r,"hex"),i>e.size?t=BN.trim(t,i):i<e.size&&(t=BN.pad(t,i,e.size))}else r=this.toString(16,2),t=Buffer.from(r,"hex");return void 0!==e&&"little"===e.endian&&(t=reversebuf(t)),t},BN.prototype.toSMBigEndian=function(){let e;return-1===this.cmp(BN.Zero)?128&(e=this.neg().toBuffer())[0]?e=Buffer.concat([Buffer.from([128]),e]):e[0]|=128:128&(e=this.toBuffer())[0]&&(e=Buffer.concat([Buffer.from([0]),e])),1===e.length&0===e[0]&&(e=Buffer.from([])),e},BN.prototype.toSM=function(e){const t=e?e.endian:"big";let r=this.toSMBigEndian();return"little"===t&&(r=reversebuf(r)),r},BN.fromScriptNumBuffer=function(e,t,r){if(preconditions.checkArgument(e.length<=(r||4),new Error("script number overflow")),t&&0<e.length&&0==(127&e[e.length-1])&&(1>=e.length||0==(128&e[e.length-2])))throw new Error("non-minimally encoded script number");return BN.fromSM(e,{endian:"little"})},BN.prototype.toScriptNumBuffer=function(){return this.toSM({endian:"little"})},BN.trim=function(e,t){return e.slice(t-e.length,e.length)},BN.pad=function(e,t,r){const i=Buffer.alloc(r);for(let t=0;t<e.length;t+=1)i[i.length-1-t]=e[e.length-1-t];for(let e=0;e<r-t;e+=1)i[e]=0;return i};const ec=elliptic.curves.secp256k1,ecPoint=ec.curve.point.bind(ec.curve),ecPointFromX=ec.curve.pointFromX.bind(ec.curve),Point=function(e,t,r){let i;try{i=ecPoint(e,t,r)}catch(e){throw new Error("Invalid point on curve")}return i.validate(),i};Point.prototype=Object.getPrototypeOf(ec.curve.point()),Point.fromX=function(e,t){let r;try{r=ecPointFromX(t,e)}catch(e){throw new Error("Invalid x value for curve.")}return r.validate(),r},Point.getG=function(){return ec.curve.g},Point.getN=function(){return new BN(ec.curve.n.toArray())},Point.prototype._getX=Point.prototype.getX,Point.prototype.getX=function(){return new BN(this._getX().toArray())},Point.prototype._getY=Point.prototype.getY,Point.prototype.getY=function(){return new BN(this._getY().toArray())},Point.prototype.validate=function(){if(this.isInfinity())throw new Error("Point cannot be equal to Infinity");let e;try{e=ecPointFromX(this.getX(),this.getY().isOdd())}catch(e){throw new Error("Point does not lie on the curve.")}if(0!==e.y.cmp(this.y))throw new Error("Invalid y value for curve.");if(!this.mul(Point.getN()).isInfinity())throw new Error("Point times N must be infinity");return this},Point.pointToCompressed=function(e){const t=e.getX().toBuffer({size:32}),r=e.getY().toBuffer({size:32});let i;return i=r[r.length-1]%2?Buffer.from([3]):Buffer.from([2]),BufferUtil.concat([i,t])};const Random={};function PrivateKey(e,t){if(!(this instanceof PrivateKey))return new PrivateKey(e,t);if(e instanceof PrivateKey)return e;const r=this._classifyArguments(e,t);if(!r.bn||0===r.bn.cmp(new BN(0)))throw new TypeError("Number can not be equal to zero, undefined, null or false");if(!r.bn.lt(Point.getN()))throw new TypeError("Number must be less than N");if(void 0===r.network)throw new TypeError('Must specify the network ("livenet" or "testnet")');return JSUtil.defineImmutable(this,{bn:r.bn,compressed:r.compressed,network:r.network}),Object.defineProperty(this,"publicKey",{configurable:!1,enumerable:!0,get:this.toPublicKey.bind(this)}),this}function PublicKey(e,t){if(!(this instanceof PublicKey))return new PublicKey(e,t);if(preconditions.checkArgument(e,"First argument is required, please include public key data."),e instanceof PublicKey)return e;t=t||{};const r=this._classifyArgs(e,t);return r.point.validate(),JSUtil.defineImmutable(this,{point:r.point,compressed:r.compressed,network:r.network||Networks.defaultNetwork}),this}Random.getRandomBufferNode=function(e){return randomBytes(e)},Random.getRandomBufferBrowser=function(e){let t;if(window.crypto&&window.crypto.getRandomValues)t=window.crypto;else{if(!window.msCrypto||!window.msCrypto.getRandomValues)throw new Error("window crypto.getRandomValues not available");t=window.msCrypto}const r=new Uint8Array(e);return t.getRandomValues(r),Buffer.from(r)},Random.getRandomBuffer=function(e){return"undefined"==typeof window||void 0===window.crypto&&void 0===window.msCrypto?Random.getRandomBufferNode(e):Random.getRandomBufferBrowser(e)},Random.getPseudoRandomBuffer=function(e){const t=Buffer.alloc(e);let r=0;for(let i=0;i<=e;i+=1){0===i-4*Math.floor(i/4)?(r=4294967296*Math.random(),t[i]=255&r):t[i]=255&(r>>>=8)}return t},PrivateKey.prototype._classifyArguments=function(e,t){let r={compressed:!0,network:t?Networks.get(t):Networks.defaultNetwork};if(_.isUndefined(e)||_.isNull(e))r.bn=PrivateKey._getRandomBN();else if(e instanceof BN)r.bn=e;else if(e instanceof Buffer||e instanceof Uint8Array)r=PrivateKey._transformBuffer(e,t);else if(e.bn&&e.network)r=PrivateKey._transformObject(e);else if(!t&&Networks.get(e))r.bn=PrivateKey._getRandomBN(),r.network=Networks.get(e);else{if("string"!=typeof e)throw new TypeError("First argument is an unrecognized data type.");JSUtil.isHexa(e)?r.bn=new BN(Buffer.from(e,"hex")):r=PrivateKey._transformWIF(e,t)}return r},PrivateKey._getRandomBN=function(){let e,t;do{const r=Random.getRandomBuffer(32);e=(t=BN.fromBuffer(r)).lt(Point.getN())}while(!e);return t},PrivateKey._transformBuffer=function(e,t){const r={};if(32===e.length)return PrivateKey._transformBNBuffer(e,t);if(r.network=Networks.get(e[0],"privatekey"),!r.network)throw new Error("Invalid network");if(t&&r.network!==Networks.get(t))throw new TypeError("Private key network mismatch");if(34===e.length&&1===e[33])r.compressed=!0;else{if(33!==e.length)throw new Error("Length of buffer must be 33 (uncompressed) or 34 (compressed)");r.compressed=!1}return r.bn=BN.fromBuffer(e.slice(1,33)),r},PrivateKey._transformBNBuffer=function(e,t){return{network:Networks.get(t)||Networks.defaultNetwork,bn:BN.fromBuffer(e),compressed:!1}},PrivateKey._transformWIF=function(e,t){return PrivateKey._transformBuffer(Base58Check.decode(e),t)},PrivateKey.fromBuffer=function(e,t){return new PrivateKey(e,t)},PrivateKey._transformObject=function(e){return{bn:new BN(e.bn,"hex"),network:Networks.get(e.network),compressed:e.compressed}},PrivateKey.fromWIF=function(e){return preconditions.checkArgument(_.isString(e),"First argument is expected to be a string."),new PrivateKey(e)},PrivateKey.fromString=PrivateKey.fromWIF,PrivateKey.fromObject=function(e){return preconditions.checkArgument(_.isObject(e),"First argument is expected to be an object."),new PrivateKey(e)},PrivateKey.fromRandom=function(e){const t=PrivateKey._getRandomBN();return new PrivateKey(t,e)},PrivateKey.getValidationError=function(e,t){let r;try{new PrivateKey(e,t)}catch(e){r=e}return r},PrivateKey.isValid=function(e,t){return!!e&&!PrivateKey.getValidationError(e,t)},PrivateKey.prototype.toString=function(){return this.toBuffer().toString("hex")},PrivateKey.prototype.toWIF=function(){let e;return e=this.compressed?Buffer.concat([Buffer.from([this.network.privatekey]),this.bn.toBuffer({size:32}),Buffer.from([1])]):Buffer.concat([Buffer.from([this.network.privatekey]),this.bn.toBuffer({size:32})]),Base58Check.encode(e)},PrivateKey.prototype.toBigNumber=function(){return this.bn},PrivateKey.prototype.toBuffer=function(){return this.bn.toBuffer()},PrivateKey.prototype.toBufferNoPadding=function(){return this.bn.toBuffer()},PrivateKey.prototype.toPublicKey=function(){return this._pubkey||(this._pubkey=PublicKey.fromPrivateKey(this)),this._pubkey},PrivateKey.prototype.toAddress=function(e){const t=this.toPublicKey();return Address.fromPublicKey(t,e||this.network)},PrivateKey.prototype.toJSON=function(){return{bn:this.bn.toString("hex"),compressed:this.compressed,network:this.network.toString()}},PrivateKey.prototype.toObject=PrivateKey.prototype.toJSON,PrivateKey.prototype.inspect=function(){const e=this.compressed?"":", uncompressed";return"<PrivateKey: ".concat(this.toString(),", network: ").concat(this.network).concat(e,">")},PublicKey.prototype._classifyArgs=function(e,t){let r={compressed:_.isUndefined(t.compressed)||t.compressed};if(e instanceof Point)r.point=e;else if(e.x&&e.y)r=PublicKey._transformObject(e);else if("string"==typeof e)r=PublicKey._transformDER(Buffer.from(e,"hex"));else if(PublicKey._isBuffer(e))r=PublicKey._transformDER(e);else{if(!PublicKey._isPrivateKey(e))throw new TypeError("First argument is an unrecognized data format.");r=PublicKey._transformPrivateKey(e)}return r.network||(r.network=_.isUndefined(t.network)?void 0:Networks.get(t.network)),r},PublicKey._isPrivateKey=function(e){return e instanceof PrivateKey},PublicKey._isBuffer=function(e){return e instanceof Buffer||e instanceof Uint8Array},PublicKey._transformPrivateKey=function(e){return preconditions.checkArgument(PublicKey._isPrivateKey(e),"Must be an instance of PrivateKey"),{point:Point.getG().mul(e.bn),compressed:e.compressed,network:e.network}},PublicKey._transformDER=function(e,t){preconditions.checkArgument(PublicKey._isBuffer(e),"Must be a hex buffer of DER encoded public key");let r,i,o,n,a={};if(t=!!_.isUndefined(t)||t,4!==e[0]&&(t||6!==e[0]&&7!==e[0]))if(3===e[0])o=e.slice(1),r=new BN(o),(a=PublicKey._transformX(!0,r)).compressed=!0;else{if(2!==e[0])throw new TypeError("Invalid DER format public key");o=e.slice(1),r=new BN(o),(a=PublicKey._transformX(!1,r)).compressed=!0}else{if(o=e.slice(1,33),n=e.slice(33,65),32!==o.length||32!==n.length||65!==e.length)throw new TypeError("Length of x and y must be 32 bytes");r=new BN(o),i=new BN(n),a.point=new Point(r,i),a.compressed=!1}return a},PublicKey._transformX=function(e,t){return preconditions.checkArgument("boolean"==typeof e,"Must specify whether y is odd or not (true or false)"),{point:Point.fromX(e,t)}},PublicKey._transformObject=function(e){const t=new BN(e.x,"hex"),r=new BN(e.y,"hex");return new PublicKey(new Point(t,r),{compressed:e.compressed})},PublicKey.fromPrivateKey=function(e){preconditions.checkArgument(PublicKey._isPrivateKey(e),"Must be an instance of PrivateKey");const t=PublicKey._transformPrivateKey(e);return new PublicKey(t.point,{compressed:t.compressed,network:t.network})},PublicKey.fromBuffer=function(e,t){preconditions.checkArgument(PublicKey._isBuffer(e),"Must be a hex buffer of DER encoded public key");const r=PublicKey._transformDER(e,t);return new PublicKey(r.point,{compressed:r.compressed})},PublicKey.fromDER=PublicKey.fromBuffer,PublicKey.fromPoint=function(e,t){return preconditions.checkArgument(e instanceof Point,"First argument must be an instance of Point."),new PublicKey(e,{compressed:t})},PublicKey.fromString=function(e,t){const r=Buffer.from(e,t||"hex"),i=PublicKey._transformDER(r);return new PublicKey(i.point,{compressed:i.compressed})},PublicKey.fromX=function(e,t){const r=PublicKey._transformX(e,t);return new PublicKey(r.point,{compressed:r.compressed})},PublicKey.getValidationError=function(e){let t;try{new PublicKey(e)}catch(e){t=e}return t},PublicKey.isValid=function(e){return!PublicKey.getValidationError(e)},PublicKey.prototype.toJSON=function(){return{x:this.point.getX().toString("hex",2),y:this.point.getY().toString("hex",2),compressed:this.compressed}},PublicKey.prototype.toObject=PublicKey.prototype.toJSON,PublicKey.prototype.toDER=function(){const e=this.point.getX(),t=this.point.getY(),r=e.toBuffer({size:32}),i=t.toBuffer({size:32});let o;if(!this.compressed)return o=Buffer.from([4]),Buffer.concat([o,r,i]);return o=i[i.length-1]%2?Buffer.from([3]):Buffer.from([2]),Buffer.concat([o,r])},PublicKey.prototype.toBuffer=PublicKey.prototype.toDER,PublicKey.prototype._getID=function(){return Hash.sha256ripemd160(this.toBuffer())},PublicKey.prototype.toAddress=function(e){return Address.fromPublicKey(this,e||this.network)},PublicKey.prototype.toString=function(){return this.toDER().toString("hex")},PublicKey.prototype.inspect=function(){return"<PublicKey: ".concat(this.toString()).concat(this.compressed?"":", uncompressed",">")};const BufferReader=function e(t){if(!(this instanceof e))return new e(t);if(!_.isUndefined(t))if(Buffer.isBuffer(t))this.set({buf:t});else if(_.isString(t)){const e=Buffer.from(t,"hex");if(2*e.length!==t.length)throw new TypeError("Invalid hex string");this.set({buf:e})}else{if(!_.isObject(t))throw new TypeError("Unrecognized argument for BufferReader");this.set(t)}};BufferReader.prototype.set=function(e){return this.buf=e.buf||this.buf||void 0,this.pos=e.pos||this.pos||0,this},BufferReader.prototype.eof=function(){return this.pos>=this.buf.length},BufferReader.prototype.finished=BufferReader.prototype.eof,BufferReader.prototype.read=function(e){preconditions.checkArgument(!_.isUndefined(e),"Must specify a length");const t=this.buf.slice(this.pos,this.pos+e);return this.pos+=e,t},BufferReader.prototype.readAll=function(){const e=this.buf.slice(this.pos,this.buf.length);return this.pos=this.buf.length,e},BufferReader.prototype.readUInt8=function(){const e=this.buf.readUInt8(this.pos);return++this.pos,e},BufferReader.prototype.readUInt16BE=function(){const e=this.buf.readUInt16BE(this.pos);return this.pos+=2,e},BufferReader.prototype.readUInt16LE=function(){const e=this.buf.readUInt16LE(this.pos);return this.pos+=2,e},BufferReader.prototype.readUInt32BE=function(){const e=this.buf.readUInt32BE(this.pos);return this.pos+=4,e},BufferReader.prototype.readUInt32LE=function(){const e=this.buf.readUInt32LE(this.pos);return this.pos+=4,e},BufferReader.prototype.readInt32LE=function(){const e=this.buf.readInt32LE(this.pos);return this.pos+=4,e},BufferReader.prototype.readUInt64BEBN=function(){const e=this.buf.slice(this.pos,this.pos+8),t=BN.fromBuffer(e);return this.pos+=8,t},BufferReader.prototype.readUInt64LEBN=function(){const e=this.buf.readUInt32LE(this.pos),t=4294967296*this.buf.readUInt32LE(this.pos+4)+e;let r;if(9007199254740991>=t)r=new BN(t);else{const e=Array.prototype.slice.call(this.buf,this.pos,this.pos+8);r=new BN(e,10,"le")}return this.pos+=8,r},BufferReader.prototype.readVarintNum=function(){const e=this.readUInt8();switch(e){case 253:return this.readUInt16LE();case 254:return this.readUInt32LE();case 255:{const e=this.readUInt64LEBN().toNumber();if(e<=9007199254740992)return e;throw new Error("number too large to retain precision - use readVarintBN")}default:return e}},BufferReader.prototype.readVarLengthBuffer=function(){const e=this.readVarintNum(),t=this.read(e);return preconditions.checkState(t.length===e,"Invalid length while reading varlength buffer. Expected: ".concat(e,", Received: ").concat(t.length)),t},BufferReader.prototype.readVarintBuf=function(){const e=this.buf.readUInt8(this.pos);return 253===e?this.read(3):254===e?this.read(5):255===e?this.read(9):this.read(1)},BufferReader.prototype.readVarintBN=function(){const e=this.readUInt8();return 253===e?new BN(this.readUInt16LE()):254===e?new BN(this.readUInt32LE()):255===e?this.readUInt64LEBN():new BN(e)},BufferReader.prototype.reverse=function(){const e=Buffer.alloc(this.buf.length);for(let t=0;t<e.length;t+=1)e[t]=this.buf[this.buf.length-1-t];return this.buf=e,this},BufferReader.prototype.readReverse=function(e){_.isUndefined(e)&&(e=this.buf.length);const t=this.buf.slice(this.pos,this.pos+e);return this.pos+=e,BufferUtil.reverse(t)};const BufferWriter=function e(t){return this instanceof e?void(t?this.set(t):this.bufs=[]):new e(t)};function Opcode(e){if(!(this instanceof Opcode))return new Opcode(e);let t;if(_.isNumber(e))t=e;else{if(!_.isString(e))throw new TypeError('Unrecognized num type: "'.concat(typeof e,'" for Opcode'));t=Opcode.map[e]}return JSUtil.defineImmutable(this,{num:t}),this}BufferWriter.prototype.set=function(e){return this.bufs=e.bufs||this.bufs||[],this},BufferWriter.prototype.toBuffer=function(){return this.concat()},BufferWriter.prototype.concat=function(){return Buffer.concat(this.bufs)},BufferWriter.prototype.write=function(e){return assert(BufferUtil.isBuffer(e)),this.bufs.push(e),this},BufferWriter.prototype.writeReverse=function(e){return assert(BufferUtil.isBuffer(e)),this.bufs.push(BufferUtil.reverse(e)),this},BufferWriter.prototype.writeUInt8=function(e){const t=Buffer.alloc(1);return t.writeUInt8(e,0),this.write(t),this},BufferWriter.prototype.writeUInt16BE=function(e){const t=Buffer.alloc(2);return t.writeUInt16BE(e,0),this.write(t),this},BufferWriter.prototype.writeUInt16LE=function(e){const t=Buffer.alloc(2);return t.writeUInt16LE(e,0),this.write(t),this},BufferWriter.prototype.writeUInt32BE=function(e){const t=Buffer.alloc(4);return t.writeUInt32BE(e,0),this.write(t),this},BufferWriter.prototype.writeInt32LE=function(e){const t=Buffer.alloc(4);return t.writeInt32LE(e,0),this.write(t),this},BufferWriter.prototype.writeUInt32LE=function(e){const t=Buffer.alloc(4);return t.writeUInt32LE(e,0),this.write(t),this},BufferWriter.prototype.writeUInt64BEBN=function(e){const t=e.toBuffer({size:8});return this.write(t),this},BufferWriter.prototype.writeUInt64LEBN=function(e){const t=e.toBuffer({size:8});return this.writeReverse(t),this},BufferWriter.prototype.writeVarintNum=function(e){const t=BufferWriter.varintBufNum(e);return this.write(t),this},BufferWriter.prototype.writeVarintBN=function(e){const t=BufferWriter.varintBufBN(e);return this.write(t),this},BufferWriter.varintBufNum=function(e){let t;return 253>e?(t=Buffer.alloc(1)).writeUInt8(e,0):65536>e?((t=Buffer.alloc(3)).writeUInt8(253,0),t.writeUInt16LE(e,1)):4294967296>e?((t=Buffer.alloc(5)).writeUInt8(254,0),t.writeUInt32LE(e,1)):((t=Buffer.alloc(9)).writeUInt8(255,0),t.writeInt32LE(-1&e,1),t.writeUInt32LE(Math.floor(e/4294967296),5)),t},BufferWriter.varintBufBN=function(e){let t;const r=e.toNumber();if(253>r)(t=Buffer.alloc(1)).writeUInt8(r,0);else if(65536>r)(t=Buffer.alloc(3)).writeUInt8(253,0),t.writeUInt16LE(r,1);else if(4294967296>r)(t=Buffer.alloc(5)).writeUInt8(254,0),t.writeUInt32LE(r,1);else{const r=new BufferWriter;r.writeUInt8(255),r.writeUInt64LEBN(e),t=r.concat()}return t},Opcode.fromBuffer=function(e){return preconditions.checkArgument(BufferUtil.isBuffer(e)),new Opcode(+"0x".concat(e.toString("hex")))},Opcode.fromNumber=function(e){return preconditions.checkArgument(_.isNumber(e)),new Opcode(e)},Opcode.fromString=function(e){preconditions.checkArgument(_.isString(e));const t=Opcode.map[e];if(void 0===t)throw new TypeError("Invalid opcodestr");return new Opcode(t)},Opcode.prototype.toHex=function(){return this.num.toString(16)},Opcode.prototype.toBuffer=function(){return Buffer.from(this.toHex(),"hex")},Opcode.prototype.toNumber=function(){return this.num},Opcode.prototype.toString=function(){const e=Opcode.reverseMap[this.num];if(void 0===e)throw new Error("Opcode does not have a string representation");return e},Opcode.smallInt=function(e){return preconditions.checkArgument(_.isNumber(e),"Invalid Argument: n should be number"),preconditions.checkArgument(0<=e&&16>=e,"Invalid Argument: n must be between 0 and 16"),0===e?Opcode("OP_0"):new Opcode(Opcode.map.OP_1+e-1)},Opcode.map={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP1:176,OP_NOP2:177,OP_NOP3:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},Opcode.reverseMap=[],Object.keys(Opcode.map).forEach(e=>{Opcode.reverseMap[Opcode.map[e]]=e}),_.extend(Opcode,Opcode.map),Opcode.isSmallIntOp=function(e){return e instanceof Opcode&&(e=e.toNumber()),e===Opcode.map.OP_0||e>=Opcode.map.OP_1&&e<=Opcode.map.OP_16},Opcode.prototype.inspect=function(){return"<Opcode: ".concat(this.toString(),", hex: ").concat(this.toHex(),", decimal: ").concat(this.num,">")};const Signature=function e(t,r){if(!(this instanceof e))return new e(t,r);t instanceof BN?this.set({r:t,s:r}):t&&this.set(t)};Signature.prototype.set=function(e){return this.r=e.r||this.r||void 0,this.s=e.s||this.s||void 0,this.i=void 0===e.i?this.i:e.i,this.compressed=void 0===e.compressed?this.compressed:e.compressed,this.nhashtype=e.nhashtype||this.nhashtype||void 0,this},Signature.fromCompact=function(e){preconditions.checkArgument(BufferUtil.isBuffer(e),"Argument is expected to be a Buffer");const t=new Signature;let r=!0,i=e.slice(0,1)[0]-27-4;0>i&&(r=!1,i+=4);const o=e.slice(1,33),n=e.slice(33,65);return preconditions.checkArgument(0===i||1===i||2===i||3===i,new Error("i must be 0, 1, 2, or 3")),preconditions.checkArgument(32===o.length,new Error("r must be 32 bytes")),preconditions.checkArgument(32===n.length,new Error("s must be 32 bytes")),t.compressed=r,t.i=i,t.r=BN.fromBuffer(o),t.s=BN.fromBuffer(n),t},Signature.fromDER=function(e,t){const r=Signature.parseDER(e,t),i=new Signature;return i.r=r.r,i.s=r.s,i},Signature.fromBuffer=Signature.fromDER,Signature.fromTxFormat=function(e){const t=e.readUInt8(e.length-1),r=e.slice(0,e.length-1),i=Signature.fromDER(r,!1);return i.nhashtype=t,i},Signature.fromString=function(e){const t=Buffer.from(e,"hex");return Signature.fromDER(t)},Signature.parseDER=function(e,t){preconditions.checkArgument(BufferUtil.isBuffer(e),"DER formatted signature should be a buffer"),_.isUndefined(t)&&(t=!0);const r=e[0];preconditions.checkArgument(48===r,"Header byte should be 0x30");let i=e[1];const o=e.slice(2).length;preconditions.checkArgument(!t||i===o,"Length byte should length of what follows"),i=i<o?i:o;const n=e[2];preconditions.checkArgument(2===n,"Integer byte for r should be 0x02");const a=e[3],s=e.slice(4,4+a),u=BN.fromBuffer(s),c=0===e[4];preconditions.checkArgument(a===s.length,"Length of r incorrect");const l=e[4+a+0];preconditions.checkArgument(2===l,"Integer byte for s should be 0x02");const p=e[4+a+1],h=e.slice(4+a+2,4+a+2+p),f=BN.fromBuffer(h),d=0===e[4+a+2+2];return preconditions.checkArgument(p===h.length,"Length of s incorrect"),preconditions.checkArgument(i===4+a+2+p-2,"Length of signature incorrect"),{header:r,length:i,rheader:n,rlength:a,rneg:c,rbuf:s,r:u,sheader:l,slength:p,sneg:d,sbuf:h,s:f}},Signature.prototype.toCompact=function(e,t){if(e="number"==typeof e?e:this.i,t="boolean"==typeof t?t:this.compressed,0!==e&&1!==e&&2!==e&&3!==e)throw new Error("i must be equal to 0, 1, 2, or 3");let r=e+27+4;!1===t&&(r-=4);const i=Buffer.from([r]),o=this.r.toBuffer({size:32}),n=this.s.toBuffer({size:32});return Buffer.concat([i,o,n])},Signature.prototype.toBuffer=function(){const e=this.r.toBuffer(),t=this.s.toBuffer(),r=!!(128&e[0]),i=!!(128&t[0]),o=r?Buffer.concat([Buffer.from([0]),e]):e,n=i?Buffer.concat([Buffer.from([0]),t]):t,a=o.length,s=n.length;return Buffer.concat([Buffer.from([48,2+a+2+s,2,a]),o,Buffer.from([2,s]),n])},Signature.prototype.toDER=Signature.prototype.toBuffer,Signature.prototype.toString=function(){return this.toDER().toString("hex")},Signature.isTxDER=function(e){if(9>e.length)return!1;if(73<e.length)return!1;if(48!==e[0])return!1;if(e[1]!==e.length-3)return!1;const t=e[3];if(5+t>=e.length)return!1;const r=e[5+t];if(t+r+7!==e.length)return!1;const i=e.slice(4);if(2!==e[2])return!1;if(0===t)return!1;if(128&i[0])return!1;if(1<t&&0===i[0]&&!(128&i[1]))return!1;const o=e.slice(6+t);return!(2!==e[6+t-2])&&0!==r&&!(128&o[0])&&(!(1<r)||0!==o[0]||128&o[1])},Signature.prototype.hasLowS=function(){return!(this.s.lt(new BN(1))||this.s.gt(new BN("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex")))},Signature.prototype.hasDefinedHashtype=function(){if(!JSUtil.isNaturalNumber(this.nhashtype))return!1;const e=this.nhashtype&~Signature.SIGHASH_ANYONECANPAY;return!(e<Signature.SIGHASH_ALL||e>Signature.SIGHASH_SINGLE)},Signature.prototype.toTxFormat=function(){const e=this.toDER(),t=Buffer.alloc(1);return t.writeUInt8(this.nhashtype,0),Buffer.concat([e,t])},Signature.SIGHASH_ALL=1,Signature.SIGHASH_NONE=2,Signature.SIGHASH_SINGLE=3,Signature.SIGHASH_FORKID=64,Signature.SIGHASH_ANYONECANPAY=128;const Script=function e(t){return this instanceof e?(this.chunks=[],BufferUtil.isBuffer(t)?e.fromBuffer(t):t instanceof Address?e.fromAddress(t):t instanceof e?e.fromBuffer(t.toBuffer()):"string"==typeof t?e.fromString(t):void(void 0!==t&&this.set(t))):new e(t)};Script.prototype.set=function(e){return this.chunks=e.chunks||this.chunks,this},Script.fromBuffer=function(e){const t=new Script;t.chunks=[];for(const r=new BufferReader(e);!r.finished();)try{const i=r.readUInt8();let o,n;0<i&&i<Opcode.OP_PUSHDATA1?(o=i,t.chunks.push({buf:r.read(o),len:o,opcodenum:i})):i===Opcode.OP_PUSHDATA1?(o=r.readUInt8(),n=r.read(o),t.chunks.push({buf:n,len:o,opcodenum:i})):i===Opcode.OP_PUSHDATA2?(o=r.readUInt16LE(),n=r.read(o),t.chunks.push({buf:n,len:o,opcodenum:i})):i===Opcode.OP_PUSHDATA4?(o=r.readUInt32LE(),n=r.read(o),t.chunks.push({buf:n,len:o,opcodenum:i})):t.chunks.push({opcodenum:i})}catch(t){if(t instanceof RangeError)throw new errors.Script.InvalidBuffer(e.toString("hex"));throw t}return t},Script.prototype.toBuffer=function(){return this.chunks.reduce((e,t)=>(e.writeUInt8(t.opcodenum),t.buf&&(t.opcodenum<Opcode.OP_PUSHDATA1?e.write(t.buf):t.opcodenum===Opcode.OP_PUSHDATA1?(e.writeUInt8(t.len),e.write(t.buf)):t.opcodenum===Opcode.OP_PUSHDATA2?(e.writeUInt16LE(t.len),e.write(t.buf)):t.opcodenum===Opcode.OP_PUSHDATA4&&(e.writeUInt32LE(t.len),e.write(t.buf))),e),new BufferWriter).concat()},Script.fromASM=function(e){const t=new Script;t.chunks=[];const r=e.split(" ");for(let e=0;e<r.length;){const i=Opcode(r[e]).toNumber();if(void 0===i){const i=Buffer.from(r[e],"hex");t.chunks.push({buf:i,len:i.length,opcodenum:i.length}),e+=1}else i===Opcode.OP_PUSHDATA1||i===Opcode.OP_PUSHDATA2||i===Opcode.OP_PUSHDATA4?(t.chunks.push({buf:Buffer.from(r[e+2],"hex"),len:parseInt(r[e+1],16),opcodenum:i}),e+=3):(t.chunks.push({opcodenum:i}),e+=1)}return t},Script.fromHex=function(e){return new this(Buffer.from(e,"hex"))},Script.fromString=function(e){if(JSUtil.isHexa(e)||0===e.length)return new this(Buffer.from(e,"hex"));const t=new this;t.chunks=[];const r=e.split(" ");for(let i=0;i<r.length;){const o=r[i];let n=Opcode(o).toNumber();if(_.isUndefined(n)){if(!(0<(n=o.startsWith("0x")?parseInt(o,16):parseInt(o,10))&&n<Opcode.OP_PUSHDATA1))throw new Error("Invalid script: ".concat(JSON.stringify(e)));t.chunks.push({buf:Buffer.from(r[i+1].slice(2),"hex"),len:n,opcodenum:n}),i+=2}else if(n===Opcode.OP_PUSHDATA1||n===Opcode.OP_PUSHDATA2||n===Opcode.OP_PUSHDATA4){if("0x"!==r[i+2].slice(0,2))throw new Error("Pushdata data must start with 0x");t.chunks.push({buf:Buffer.from(r[i+2].slice(2),"hex"),len:parseInt(r[i+1],10),opcodenum:n}),i+=3}else t.chunks.push({opcodenum:n}),i+=1}return t},Script.prototype._chunkToString=function(e,t){const r=e.opcodenum,i="asm"===t;let o="";if(e.buf)(r===Opcode.OP_PUSHDATA1||r===Opcode.OP_PUSHDATA2||r===Opcode.OP_PUSHDATA4)&&(o="".concat(o," ").concat(Opcode(r).toString())),0<e.len&&(o=i?"".concat(o," ").concat(e.buf.toString("hex")):"".concat(o," ").concat(e.len," 0x").concat(e.buf.toString("hex")));else if(void 0!==Opcode.reverseMap[r])o="".concat(o," ").concat(Opcode(r).toString());else{let e=r.toString(16);0!=e.length%2&&(e="0".concat(e)),o=i?"".concat(o," ").concat(e):"".concat(o," 0x").concat(e)}return o},Script.prototype.toASM=function(){return this.chunks.reduce((e,t)=>e+this._chunkToString(t,"asm"),"").substr(1)},Script.prototype.toString=function(){return this.chunks.reduce((e,t)=>e+this._chunkToString(t),"").substr(1)},Script.prototype.toHex=function(){return this.toBuffer().toString("hex")},Script.prototype.inspect=function(){return"<Script: ".concat(this.toString(),">")},Script.prototype.isPublicKeyHashOut=function(){return!(5!==this.chunks.length||this.chunks[0].opcodenum!==Opcode.OP_DUP||this.chunks[1].opcodenum!==Opcode.OP_HASH160||!this.chunks[2].buf||20!==this.chunks[2].buf.length||this.chunks[3].opcodenum!==Opcode.OP_EQUALVERIFY||this.chunks[4].opcodenum!==Opcode.OP_CHECKSIG)},Script.prototype.isPublicKeyHashIn=function(){if(2===this.chunks.length){const e=this.chunks[0].buf,t=this.chunks[1].buf;if(e&&e.length&&48===e[0]&&t&&t.length){const e=t[0];if((4===e||6===e||7===e)&&65===t.length)return!0;if((3===e||2===e)&&33===t.length)return!0}}return!1},Script.prototype.getPublicKey=function(){return preconditions.checkState(this.isPublicKeyOut(),"Can't retrieve PublicKey from a non-PublicKey output"),this.chunks[0].buf},Script.prototype.getPublicKeyHash=function(){return preconditions.checkState(this.isPublicKeyHashOut(),"Can't retrieve PublicKeyHash from a non-PublicKeyHash output"),this.chunks[2].buf},Script.prototype.isPublicKeyOut=function(){if(2===this.chunks.length&&this.chunks[0].buf&&this.chunks[0].buf.length&&this.chunks[1].opcodenum===Opcode.OP_CHECKSIG){const e=this.chunks[0].buf,t=e[0];let r=!1;if(4!==t&&6!==t&&7!==t||65!==e.length?(3===t||2===t)&&33===e.length&&(r=!0):r=!0,r)return PublicKey.isValid(e)}return!1},Script.prototype.isPublicKeyIn=function(){if(1===this.chunks.length){const e=this.chunks[0].buf;if(e&&e.length&&48===e[0])return!0}return!1},Script.prototype.isScriptHashOut=function(){const e=this.toBuffer();return 23===e.length&&e[0]===Opcode.OP_HASH160&&20===e[1]&&e[e.length-1]===Opcode.OP_EQUAL},Script.prototype.isScriptHashIn=function(){if(1>=this.chunks.length)return!1;const e=this.chunks[this.chunks.length-1].buf;if(!e)return!1;let t;try{t=Script.fromBuffer(e)}catch(e){if(e instanceof errors.Script.InvalidBuffer)return!1;throw e}return t.classify()!==Script.types.UNKNOWN},Script.prototype.isMultisigOut=function(){return 3<this.chunks.length&&Opcode.isSmallIntOp(this.chunks[0].opcodenum)&&this.chunks.slice(1,this.chunks.length-2).every(e=>e.buf&&BufferUtil.isBuffer(e.buf))&&Opcode.isSmallIntOp(this.chunks[this.chunks.length-2].opcodenum)&&this.chunks[this.chunks.length-1].opcodenum===Opcode.OP_CHECKMULTISIG},Script.prototype.isMultisigIn=function(){return 2<=this.chunks.length&&0===this.chunks[0].opcodenum&&this.chunks.slice(1,this.chunks.length).every(e=>e.buf&&BufferUtil.isBuffer(e.buf)&&Signature.isTxDER(e.buf))},Script.prototype.isDataOut=function(){return 1<=this.chunks.length&&this.chunks[0].opcodenum===Opcode.OP_RETURN&&(1===this.chunks.length||2===this.chunks.length&&this.chunks[1].buf&&this.chunks[1].buf.length<=Script.OP_RETURN_STANDARD_SIZE&&this.chunks[1].length===this.chunks.len)},Script.prototype.getData=function(){if(this.isDataOut()||this.isScriptHashOut())return void 0===this.chunks[1]?Buffer.alloc(0):Buffer.from(this.chunks[1].buf);if(this.isPublicKeyHashOut())return Buffer.from(this.chunks[2].buf);throw new Error("Unrecognized script type to get data from")},Script.prototype.isPushOnly=function(){return this.chunks.every(e=>e.opcodenum<=Opcode.OP_16)},Script.types={},Script.types.UNKNOWN="Unknown",Script.types.PUBKEY_OUT="Pay to public key",Script.types.PUBKEY_IN="Spend from public key",Script.types.PUBKEYHASH_OUT="Pay to public key hash",Script.types.PUBKEYHASH_IN="Spend from public key hash",Script.types.SCRIPTHASH_OUT="Pay to script hash",Script.types.SCRIPTHASH_IN="Spend from script hash",Script.types.MULTISIG_OUT="Pay to multisig",Script.types.MULTISIG_IN="Spend from multisig",Script.types.DATA_OUT="Data push",Script.OP_RETURN_STANDARD_SIZE=80,Script.prototype.classify=function(){if(this._isInput)return this.classifyInput();if(this._isOutput)return this.classifyOutput();const e=this.classifyOutput();return e===Script.types.UNKNOWN?this.classifyInput():e},Script.outputIdentifiers={},Script.outputIdentifiers.PUBKEY_OUT=Script.prototype.isPublicKeyOut,Script.outputIdentifiers.PUBKEYHASH_OUT=Script.prototype.isPublicKeyHashOut,Script.outputIdentifiers.MULTISIG_OUT=Script.prototype.isMultisigOut,Script.outputIdentifiers.SCRIPTHASH_OUT=Script.prototype.isScriptHashOut,Script.outputIdentifiers.DATA_OUT=Script.prototype.isDataOut,Script.prototype.classifyOutput=function(){const e=Object.keys(Script.outputIdentifiers);for(let t=0;t<e.length;t+=1)if(Script.outputIdentifiers[e[t]].bind(this)())return Script.types[e[t]];return Script.types.UNKNOWN},Script.inputIdentifiers={},Script.inputIdentifiers.PUBKEY_IN=Script.prototype.isPublicKeyIn,Script.inputIdentifiers.PUBKEYHASH_IN=Script.prototype.isPublicKeyHashIn,Script.inputIdentifiers.MULTISIG_IN=Script.prototype.isMultisigIn,Script.inputIdentifiers.SCRIPTHASH_IN=Script.prototype.isScriptHashIn,Script.prototype.classifyInput=function(){const e=Object.keys(Script.inputIdentifiers);for(let t=0;t<e.length;t+=1)if(Script.inputIdentifiers[e[t]].bind(this)())return Script.types[e[t]];return Script.types.UNKNOWN},Script.prototype.isStandard=function(){return this.classify()!==Script.types.UNKNOWN},Script.prototype.prepend=function(e){return this._addByType(e,!0),this},Script.prototype.equals=function(e){if(preconditions.checkState(e instanceof Script,"Must provide another script"),this.chunks.length!==e.chunks.length)return!1;let t;for(t=0;t<this.chunks.length;t+=1){if(BufferUtil.isBuffer(this.chunks[t].buf)&&!BufferUtil.isBuffer(e.chunks[t].buf))return!1;if(BufferUtil.isBuffer(this.chunks[t].buf)&&!BufferUtil.equals(this.chunks[t].buf,e.chunks[t].buf))return!1;if(this.chunks[t].opcodenum!==e.chunks[t].opcodenum)return!1}return!0},Script.prototype.add=function(e){return this._addByType(e,!1),this},Script.prototype._addByType=function(e,t){if("string"==typeof e)this._addOpcode(e,t);else if("number"==typeof e)this._addOpcode(e,t);else if(e instanceof Opcode)this._addOpcode(e,t);else if(BufferUtil.isBuffer(e))this._addBuffer(e,t);else if(e instanceof Script)this.chunks=this.chunks.concat(e.chunks);else{if("object"!=typeof e)throw new Error("Invalid script chunk");this._insertAtPosition(e,t)}},Script.prototype._insertAtPosition=function(e,t){t?this.chunks.unshift(e):this.chunks.push(e)},Script.prototype._addOpcode=function(e,t){let r;return r="number"==typeof e?e:e instanceof Opcode?e.toNumber():Opcode(e).toNumber(),this._insertAtPosition({opcodenum:r},t),this},Script.prototype._addBuffer=function(e,t){let r;const i=e.length;if(0<=i&&i<Opcode.OP_PUSHDATA1)r=i;else if(256>i)r=Opcode.OP_PUSHDATA1;else if(65536>i)r=Opcode.OP_PUSHDATA2;else{if(!(4294967296>i))throw new Error("You can't push that much data");r=Opcode.OP_PUSHDATA4}return this._insertAtPosition({buf:e,len:i,opcodenum:r},t),this},Script.prototype.removeCodeseparators=function(){return this.chunks=this.chunks.filter(e=>e.opcodenum!==Opcode.OP_CODESEPARATOR),this},Script.buildMultisigOut=function(e,t,r){preconditions.checkArgument(t<=e.length,"Number of required signatures must be less than or equal to the number of public keys"),r=r||{};const i=new this;i.add(Opcode.smallInt(t));let o=e=e.map(PublicKey);return r.noSorting||(o=_.sortBy(e,e=>e.toString("hex"))),o.forEach(e=>i.add(e.toBuffer())),i.add(Opcode.smallInt(e.length)),i.add(Opcode.OP_CHECKMULTISIG),i},Script.buildMultisigIn=function(e,t,r,i){preconditions.checkArgument(_.isArray(e)),preconditions.checkArgument(_.isNumber(t)),preconditions.checkArgument(_.isArray(r)),i=i||{};const o=new this;return o.add(Opcode.OP_0),r.forEach(e=>{preconditions.checkArgument(BufferUtil.isBuffer(e),"Signatures must be an array of Buffers"),o.add(e)}),o},Script.buildP2SHMultisigIn=function(e,t,r,i){preconditions.checkArgument(_.isArray(e)),preconditions.checkArgument(_.isNumber(t)),preconditions.checkArgument(_.isArray(r)),i=i||{};const o=new this;return o.add(Opcode.OP_0),r.forEach(e=>{preconditions.checkArgument(BufferUtil.isBuffer(e),"Signatures must be an array of Buffers"),o.add(e)}),o.add((i.cachedMultisig||Script.buildMultisigOut(e,t,i)).toBuffer()),o},Script.buildPublicKeyHashOut=function(e){preconditions.checkArgument(!_.isUndefined(e)),preconditions.checkArgument(e instanceof PublicKey||e instanceof Address||_.isString(e)),e instanceof PublicKey?e=e.toAddress():_.isString(e)&&(e=new Address(e));const t=new this;return t.add(Opcode.OP_DUP).add(Opcode.OP_HASH160).add(e.hashBuffer).add(Opcode.OP_EQUALVERIFY).add(Opcode.OP_CHECKSIG),t._network=e.network,t},Script.buildPublicKeyOut=function(e){preconditions.checkArgument(e instanceof PublicKey);const t=new this;return t.add(e.toBuffer()).add(Opcode.OP_CHECKSIG),t},Script.buildDataOut=function(e,t){preconditions.checkArgument(_.isUndefined(e)||_.isString(e)||BufferUtil.isBuffer(e)),_.isString(e)&&(e=Buffer.from(e,t));const r=new this;return r.add(Opcode.OP_RETURN),_.isUndefined(e)||r.add(e),r},Script.buildScriptHashOut=function(e){preconditions.checkArgument(e instanceof Script||e instanceof Address&&e.isPayToScriptHash());const t=(new this).add(Opcode.OP_HASH160).add(e instanceof Address?e.hashBuffer:Hash.sha256ripemd160(e.toBuffer())).add(Opcode.OP_EQUAL);return t._network=e._network||e.network,t},Script.buildPublicKeyIn=function(e,t){preconditions.checkArgument(e instanceof Signature||BufferUtil.isBuffer(e)),preconditions.checkArgument(_.isUndefined(t)||_.isNumber(t)),e instanceof Signature&&(e=e.toBuffer());const r=new this;return r.add(BufferUtil.concat([e,BufferUtil.integerAsSingleByteBuffer(t||Signature.SIGHASH_ALL)])),r},Script.buildPublicKeyHashIn=function(e,t,r){return preconditions.checkArgument(t instanceof Signature||BufferUtil.isBuffer(t)),preconditions.checkArgument(_.isUndefined(r)||_.isNumber(r)),t instanceof Signature&&(t=t.toBuffer()),(new this).add(BufferUtil.concat([t,BufferUtil.integerAsSingleByteBuffer(r||Signature.SIGHASH_ALL)])).add(new PublicKey(e).toBuffer())},Script.empty=function(){return new this},Script.prototype.toScriptHashOut=function(){return Script.buildScriptHashOut(this)},Script.fromAddress=function(e){if((e=new Address(e)).isPayToScriptHash())return Script.buildScriptHashOut(e);if(e.isPayToPublicKeyHash())return Script.buildPublicKeyHashOut(e);throw new errors.Script.UnrecognizedAddress(e)},Script.prototype.getAddressInfo=function(){if(this._isInput)return this._getInputAddressInfo();if(this._isOutput)return this._getOutputAddressInfo();const e=this._getOutputAddressInfo();return e||this._getInputAddressInfo()},Script.prototype._getOutputAddressInfo=function(){const e={};if(this.isScriptHashOut())e.hashBuffer=this.getData(),e.type=Address.PayToScriptHash;else{if(!this.isPublicKeyHashOut())return!1;e.hashBuffer=this.getData(),e.type=Address.PayToPublicKeyHash}return e},Script.prototype._getInputAddressInfo=function(){const e={};if(this.isPublicKeyHashIn())e.hashBuffer=Hash.sha256ripemd160(this.chunks[1].buf),e.type=Address.PayToPublicKeyHash;else{if(!this.isScriptHashIn())return!1;e.hashBuffer=Hash.sha256ripemd160(this.chunks[this.chunks.length-1].buf),e.type=Address.PayToScriptHash}return e},Script.prototype.toAddress=function(e){const t=this.getAddressInfo();return!!t&&(t.network=Networks.get(e)||this._network||Networks.defaultNetwork,new Address(t))},Script.prototype.findAndDelete=function(e){const t=e.toBuffer().toString("hex");for(let e=0;e<this.chunks.length;e+=1){t===Script({chunks:[this.chunks[e]]}).toBuffer().toString("hex")&&this.chunks.splice(e,1)}return this},Script.prototype.checkMinimalPush=function(e){const t=this.chunks[e],r=t.buf,i=t.opcodenum;return!(r&&(0===r.length?i!==Opcode.OP_0:1===r.length&&1<=r[0]&&16>=r[0]?i!==Opcode.OP_1+(r[0]-1):1===r.length&&129===r[0]?i!==Opcode.OP_1NEGATE:75>=r.length?i!==r.length:255>=r.length?i!==Opcode.OP_PUSHDATA1:65535>=r.length&&i!==Opcode.OP_PUSHDATA2))},Script.prototype._decodeOP_N=function(e){if(e===Opcode.OP_0)return 0;if(e>=Opcode.OP_1&&e<=Opcode.OP_16)return e-(Opcode.OP_1-1);throw new Error("Invalid opcode: ".concat(JSON.stringify(e)))},Script.prototype.getSignatureOperationsCount=function(e){e=!!_.isUndefined(e)||e;const t=this;let r=0,i=Opcode.OP_INVALIDOPCODE;return t.chunks.forEach(o=>{const n=o.opcodenum;n===Opcode.OP_CHECKSIG||n===Opcode.OP_CHECKSIGVERIFY?r+=1:(n===Opcode.OP_CHECKMULTISIG||n===Opcode.OP_CHECKMULTISIGVERIFY)&&(e&&i>=Opcode.OP_1&&i<=Opcode.OP_16?r+=t._decodeOP_N(i):r+=20),i=n}),r};const BITPAY_P2PKH_VERSION_BYTE=28,BITPAY_P2SH_VERSION_BYTE=40;class Address{constructor(e,t,r){if(!(this instanceof Address))return new Address(e,t,r);if(_.isArray(e)&&_.isNumber(t))return Address.createMultisig(e,t,r);if(e instanceof Address)return e;if(preconditions.checkArgument(e,"Address data required in first argument.","guide/address.html"),t&&!Networks.get(t))throw new TypeError('Second argument must be "livenet" or "testnet".');if(r&&r!==Address.PayToPublicKeyHash&&r!==Address.PayToScriptHash)throw new TypeError('Third argument must be "pubkeyhash" or "scripthash".');const i=Address._classifyArguments(e,t,r);i.network=i.network||Networks.get(t)||Networks.defaultNetwork,i.type=i.type||r||Address.PayToPublicKeyHash,JSUtil.defineImmutable(this,{hashBuffer:i.hashBuffer,network:i.network,type:i.type})}static _classifyArguments(e,t,r){if((e instanceof Buffer||e instanceof Uint8Array)&&20===e.length)return Address._transformHash(e);if((e instanceof Buffer||e instanceof Uint8Array)&&21===e.length)return Address._transformBuffer(e,t,r);if(e instanceof PublicKey)return Address._transformPublicKey(e);if(e instanceof Script)return Address._transformScript(e,t);if("string"==typeof e)return Address._transformString(e,t,r,Address.DefaultFormat);if(_.isObject(e))return Address._transformObject(e);throw new TypeError("First argument is an unrecognized data format.")}static _transformHash(e){const t={};if(!(e instanceof Buffer||e instanceof Uint8Array))throw new TypeError("Address supplied is not a buffer.");if(20!==e.length)throw new TypeError("Address hashbuffers must be exactly 20 bytes.");return t.hashBuffer=e,t}static _transformObject(e){return preconditions.checkArgument(e.hash||e.hashBuffer,"Must provide a `hash` or `hashBuffer` property"),preconditions.checkArgument(e.type,"Must provide a `type` property"),{hashBuffer:e.hash?Buffer.from(e.hash,"hex"):e.hashBuffer,network:Networks.get(e.network)||Networks.defaultNetwork,type:e.type}}static _classifyFromVersion(e){const t={},r=Networks.get(e[0],"pubkeyhash"),i=Networks.get(e[0],"scripthash");return r?(t.network=r,t.type=this.PayToPublicKeyHash):i&&(t.network=i,t.type=this.PayToScriptHash),t}static _transformBuffer(e,t,r){const i={};if(!(e instanceof Buffer||e instanceof Uint8Array))throw new TypeError("Address supplied is not a buffer.");if(21!==e.length)throw new TypeError("Address buffers must be exactly 21 bytes.");t=Networks.get(t);const o=Address._classifyFromVersion(e);if(!o.network||t&&t!==o.network)throw new TypeError("Address has mismatched network type.");if(!o.type||r&&r!==o.type)throw new TypeError("Address has mismatched type.");return i.hashBuffer=e.slice(1),i.network=o.network,i.type=o.type,i}static _transformPublicKey(e){const t={};if(!(e instanceof PublicKey))throw new TypeError("Address must be an instance of PublicKey.");return t.hashBuffer=Hash.sha256ripemd160(e.toBuffer()),t.type=this.PayToPublicKeyHash,t}static _transformScript(e,t){preconditions.checkArgument(e instanceof Script,"script must be a Script instance");const r=e.getAddressInfo(t);if(!r)throw new errors.Script.CantDeriveAddress(e);return r}static createMultisig(e,t,r){return r=r||e[0].network||Networks.defaultNetwork,Address.payingTo(Script.buildMultisigOut(e,t),r)}static _transformString(e,t,r,i){if("string"!=typeof e)throw new TypeError("data parameter supplied is not a string.");if(e=e.trim(),i===this.LegacyFormat)return this._transformStringLegacy(e,t,r);if(i===this.BitpayFormat)return this._transformStringBitpay(e,t,r);if(i===this.CashAddrFormat)return this._transformStringCashAddr(e,t,r);throw new TypeError("Unrecognized address format.")}static _transformStringLegacy(e,t,r){const i=Base58Check.decode(e);return this._transformBuffer(i,t,r)}static _transformStringBitpay(e,t,r){const i=Base58Check.decode(e);return i[0]===BITPAY_P2PKH_VERSION_BYTE?i[0]=0:i[0]===BITPAY_P2SH_VERSION_BYTE&&(i[0]=5),this._transformBuffer(i,t,r)}static _transformStringCashAddr(e,t,r){"string"==typeof t||(t=t.toString());const i=cashaddr.decode(e);preconditions.checkArgument(!t||"livenet"===t&&"bitcoincash"===i.prefix||"testnet"===t&&"bchtest"===i.prefix,"Invalid network."),preconditions.checkArgument(!r||r===this.PayToPublicKeyHash&&"P2PKH"===i.type||r===this.PayToScriptHash&&"P2SH"===i.type,"Invalid type."),t=Networks.get(t||("bitcoincash"===i.prefix?"livenet":"testnet")),r=r||("P2PKH"===i.type?this.PayToPublicKeyHash:this.PayToScriptHash);const o=Buffer.from([t[r]]),n=Buffer.from(i.hash),a=Buffer.concat([o,n]);return this._transformBuffer(a,t,r)}static fromPublicKey(e,t){const r=this._transformPublicKey(e);return t=t||Networks.defaultNetwork,new Address(r.hashBuffer,t,r.type)}static fromPublicKeyHash(e,t){const r=this._transformHash(e);return new Address(r.hashBuffer,t,this.PayToPublicKeyHash)}static fromScriptHash(e,t){preconditions.checkArgument(e,"hash parameter is required");const r=this._transformHash(e);return new Address(r.hashBuffer,t,this.PayToScriptHash)}static payingTo(e,t){return preconditions.checkArgument(e,"script is required"),preconditions.checkArgument(e instanceof Script,"script must be instance of Script"),this.fromScriptHash(Hash.sha256ripemd160(e.toBuffer()),t)}static fromScript(e,t){preconditions.checkArgument(e instanceof Script,"script must be a Script instance");const r=this._transformScript(e,t);return new Address(r.hashBuffer,t,r.type)}static fromBuffer(e,t,r){const i=this._transformBuffer(e,t,r);return new Address(i.hashBuffer,i.network,i.type)}static fromString(e,t,r,i){i=i||this.DefaultFormat;const o=this._transformString(e,t,r,i);return new Address(o.hashBuffer,o.network,o.type)}static fromObject(e){preconditions.checkState(JSUtil.isHexa(e.hash),'Unexpected hash, "'.concat(e.hash,'", expected to be hex.'));const t=Buffer.from(e.hash,"hex");return new Address(t,e.network,e.type)}static getValidationError(e,t,r){let i;try{new Address(e,t,r)}catch(e){i=e}return i}static isValid(e,t,r){return!this.getValidationError(e,t,r)}isPayToPublicKeyHash(){return this.type===Address.PayToPublicKeyHash}isPayToScriptHash(){return this.type===Address.PayToScriptHash}toBuffer(){const e=Buffer.from([this.network[this.type]]);return Buffer.concat([e,this.hashBuffer])}toObject(){return{hash:this.hashBuffer.toString("hex"),type:this.type,network:this.network.toString()}}toJSON(){return this.toObject()}toString(e){if((e=e||Address.DefaultFormat)===Address.LegacyFormat)return this._toStringLegacy();if(e===Address.BitpayFormat)return this._toStringBitpay();if(e===Address.CashAddrFormat)return this._toStringCashAddr();throw new TypeError("Unrecognized address format.")}_toStringLegacy(){return Base58Check.encode(this.toBuffer())}_toStringBitpay(){const e=this.toBuffer();return"livenet"===this.network.toString()&&(this.type===Address.PayToPublicKeyHash?e[0]=BITPAY_P2PKH_VERSION_BYTE:this.type===Address.PayToScriptHash&&(e[0]=BITPAY_P2SH_VERSION_BYTE)),Base58Check.encode(e)}_toStringCashAddr(){const e="livenet"===this.network.toString()?"bitcoincash":"bchtest",t=this.type===Address.PayToPublicKeyHash?"P2PKH":"P2SH";return cashaddr.encode(e,t,this.hashBuffer)}inspect(){return"<Address: ".concat(this.toString(),", type: ").concat(this.type,", network: ").concat(this.network,">")}}Address.LegacyFormat="legacy",Address.BitpayFormat="bitpay",Address.CashAddrFormat="cashaddr",Address.DefaultFormat=Address.LegacyFormat,Address.PayToPublicKeyHash="pubkeyhash",Address.PayToScriptHash="scripthash";const GENESIS_BITS=486604799;class BlockHeader{constructor(e){if(!(this instanceof BlockHeader))return new BlockHeader(e);const t=BlockHeader._from(e);return this.version=t.version,this.prevHash=t.prevHash,this.merkleRoot=t.merkleRoot,this.time=t.time,this.timestamp=t.time,this.bits=t.bits,this.nonce=t.nonce,t.hash&&preconditions.checkState(this.hash===t.hash,"Argument object hash does not match block hash."),this}static _from(e){let t={};if(BufferUtil.isBuffer(e))t=BlockHeader._fromBufferReader(BufferReader(e));else{if(!_.isObject(e))throw new TypeError("Unrecognized argument for BlockHeader");t=BlockHeader._fromObject(e)}return t}static _fromObject(e){preconditions.checkArgument(e,"data is required");let t=e.prevHash,r=e.merkleRoot;return _.isString(e.prevHash)&&(t=BufferUtil.reverse(Buffer.from(e.prevHash,"hex"))),_.isString(e.merkleRoot)&&(r=BufferUtil.reverse(Buffer.from(e.merkleRoot,"hex"))),{hash:e.hash,version:e.version,prevHash:t,merkleRoot:r,time:e.time,timestamp:e.time,bits:e.bits,nonce:e.nonce}}static fromObject(e){const t=this._fromObject(e);return new BlockHeader(t)}static fromRawBlock(e){BufferUtil.isBuffer(e)||(e=Buffer.from(e,"binary"));const t=BufferReader(e);t.pos=BlockHeader.Constants.START_OF_HEADER;const r=this._fromBufferReader(t);return new BlockHeader(r)}static fromBuffer(e){const t=this._fromBufferReader(BufferReader(e));return new BlockHeader(t)}static fromString(e){const t=Buffer.from(e,"hex");return this.fromBuffer(t)}static _fromBufferReader(e){return{version:e.readInt32LE(),prevHash:e.read(32),merkleRoot:e.read(32),time:e.readUInt32LE(),bits:e.readUInt32LE(),nonce:e.readUInt32LE()}}static fromBufferReader(e){const t=this._fromBufferReader(e);return new BlockHeader(t)}toJSON(){return{hash:this.hash,version:this.version,prevHash:BufferUtil.reverse(this.prevHash).toString("hex"),merkleRoot:BufferUtil.reverse(this.merkleRoot).toString("hex"),time:this.time,bits:this.bits,nonce:this.nonce}}toObject(){return this.toJSON()}toBuffer(){return this.toBufferWriter().concat()}toString(){return this.toBuffer().toString("hex")}toBufferWriter(e){return e||(e=new BufferWriter),e.writeInt32LE(this.version),e.write(this.prevHash),e.write(this.merkleRoot),e.writeUInt32LE(this.time),e.writeUInt32LE(this.bits),e.writeUInt32LE(this.nonce),e}getTargetDifficulty(e){e=e||this.bits;let t=new BN(16777215&e),r=8*((e>>>24)-3);for(;0<r;)t=t.mul(new BN(2)),r-=1;return t}getDifficulty(){const e=this.getTargetDifficulty(GENESIS_BITS).mul(new BN(1e8)),t=this.getTargetDifficulty();let r=e.div(t).toString(10);const i=r.length-8,o="".concat(r.slice(0,i)),n="".concat(r.slice(i));return r="".concat(o,".").concat(n),parseFloat(r)}_getHash(){const e=this.toBuffer();return Hash.sha256sha256(e)}validTimestamp(){const e=Math.round((new Date).getTime()/1e3);return!(this.time>e+BlockHeader.Constants.MAX_TIME_OFFSET)}validProofOfWork(){const e=new BN(this.id,"hex"),t=this.getTargetDifficulty();return!(0<e.cmp(t))}inspect(){return"<BlockHeader ".concat(this.id,">")}}const idProperty={configurable:!1,enumerable:!0,get(){return this._id||(this._id=BufferReader(this._getHash()).readReverse().toString("hex")),this._id},set:_.noop};Object.defineProperty(BlockHeader.prototype,"id",idProperty),Object.defineProperty(BlockHeader.prototype,"hash",idProperty),BlockHeader.Constants={START_OF_HEADER:8,MAX_TIME_OFFSET:7200,LARGEST_HASH:new BN("10000000000000000000000000000000000000000000000000000000000000000","hex")};const MAX_SAFE_INTEGER=9007199254740991;class Output{constructor(e){if(!_.isObject(e))throw new TypeError("Unrecognized argument for Output");if(this.satoshis=e.satoshis,BufferUtil.isBuffer(e.script))this._scriptBuffer=e.script;else{let t;t=_.isString(e.script)&&JSUtil.isHexa(e.script)?Buffer.from(e.script,"hex"):e.script,this.setScript(t)}}get script(){return this._script?this._script:(this.setScriptFromBuffer(this._scriptBuffer),this._script)}get satoshis(){return this._satoshis}set satoshis(e){e instanceof BN?(this._satoshisBN=e,this._satoshis=e.toNumber()):_.isString(e)?(this._satoshis=parseInt(e,10),this._satoshisBN=BN.fromNumber(this._satoshis)):(preconditions.checkArgument(JSUtil.isNaturalNumber(e),"Output satoshis is not a natural number"),this._satoshisBN=BN.fromNumber(e),this._satoshis=e),preconditions.checkState(JSUtil.isNaturalNumber(this._satoshis),"Output satoshis is not a natural number")}get satoshisBN(){return this._satoshisBN}set satoshisBN(e){this._satoshisBN=e,this._satoshis=e.toNumber(),preconditions.checkState(JSUtil.isNaturalNumber(this._satoshis),"Output satoshis is not a natural number")}static fromObject(e){return new Output(e)}static fromBufferReader(e){const t={satoshis:e.readUInt64LEBN()},r=e.readVarintNum();return t.script=0===r?Buffer.from([]):e.read(r),new Output(t)}invalidSatoshis(){return this._satoshis>MAX_SAFE_INTEGER?"transaction txout satoshis greater than max safe integer":this._satoshis===this._satoshisBN.toNumber()?!!(0>this._satoshis)&&"transaction txout negative":"transaction txout satoshis has corrupted value"}toJSON(){return{satoshis:this.satoshis,script:this._scriptBuffer.toString("hex")}}toObject(){return this.toJSON()}setScriptFromBuffer(e){this._scriptBuffer=e;try{this._script=Script.fromBuffer(this._scriptBuffer),this._script._isOutput=!0}catch(e){if(!(e instanceof errors.Script.InvalidBuffer))throw e;this._script=null}}setScript(e){if(e instanceof Script)this._scriptBuffer=e.toBuffer(),this._script=e,this._script._isOutput=!0;else if(_.isString(e))this._script=Script.fromString(e),this._scriptBuffer=this._script.toBuffer(),this._script._isOutput=!0;else{if(!BufferUtil.isBuffer(e))throw new TypeError("Invalid argument type: script");this.setScriptFromBuffer(e)}return this}inspect(){let e;return e=this.script?this.script.inspect():this._scriptBuffer.toString("hex"),"<Output (".concat(this.satoshis," sats) ").concat(e,">")}toBufferWriter(e){e||(e=new BufferWriter),e.writeUInt64LEBN(this._satoshisBN);const t=this._scriptBuffer;return e.writeVarintNum(t.length),e.write(t),e}}const ECDSA=function e(t){return this instanceof e?void(t&&this.set(t)):new e(t)};ECDSA.prototype.set=function(e){return this.hashbuf=e.hashbuf||this.hashbuf,this.endian=e.endian||this.endian,this.privkey=e.privkey||this.privkey,this.pubkey=e.pubkey||(this.privkey?this.privkey.publicKey:this.pubkey),this.sig=e.sig||this.sig,this.k=e.k||this.k,this.verified=e.verified||this.verified,this},ECDSA.prototype.privkey2pubkey=function(){this.pubkey=this.privkey.toPublicKey()},ECDSA.prototype.calci=function(){for(let e=0;4>e;e+=1){let t;this.sig.i=e;try{if((t=this.toPublicKey()).point.eq(this.pubkey.point))return this.sig.compressed=this.pubkey.compressed,this}catch(e){console.error(e)}}throw this.sig.i=void 0,new Error("Unable to find valid recovery factor")},ECDSA.fromString=function(e){const t=JSON.parse(e);return new ECDSA(t)},ECDSA.prototype.randomK=function(){const e=Point.getN();let t;do{t=BN.fromBuffer(Random.getRandomBuffer(32))}while(!t.lt(e)||!t.gt(BN.Zero));return this.k=t,this},ECDSA.prototype.deterministicK=function(e){_.isUndefined(e)&&(e=0);let t=Buffer.alloc(32);t.fill(1);let r=Buffer.alloc(32);r.fill(0);const i=this.privkey.bn.toBuffer({size:32}),o="little"===this.endian?BufferUtil.reverse(this.hashbuf):this.hashbuf;r=Hash.sha256hmac(Buffer.concat([t,Buffer.from([0]),i,o]),r),t=Hash.sha256hmac(t,r),r=Hash.sha256hmac(Buffer.concat([t,Buffer.from([1]),i,o]),r),t=Hash.sha256hmac(t,r),t=Hash.sha256hmac(t,r);let n=BN.fromBuffer(t);const a=Point.getN();for(let i=0;i<e||!n.lt(a)||!n.gt(BN.Zero);i+=1)r=Hash.sha256hmac(Buffer.concat([t,Buffer.from([0])]),r),t=Hash.sha256hmac(t,r),t=Hash.sha256hmac(t,r),n=BN.fromBuffer(t);return this.k=n,this},ECDSA.prototype.toPublicKey=function(){const e=this.sig.i;preconditions.checkArgument(0===e||1===e||2===e||3===e,"i must be equal to 0, 1, 2, or 3");const t=BN.fromBuffer(this.hashbuf),r=this.sig.r,i=this.sig.s,o=Point.getN(),n=Point.getG(),a=e>>1?r.add(o):r,s=Point.fromX(1&e,a);if(!s.mul(o).isInfinity())throw new Error("nR is not a valid curve point");const u=t.neg().umod(o),c=r.invm(o),l=s.mul(i).add(n.mul(u)).mul(c);return PublicKey.fromPoint(l,this.sig.compressed)},ECDSA.prototype.sigError=function(){if(!BufferUtil.isBuffer(this.hashbuf)||32!==this.hashbuf.length)return"hashbuf must be a 32 byte buffer";const e=this.sig.r,t=this.sig.s;if(!(e.gt(BN.Zero)&&e.lt(Point.getN())&&t.gt(BN.Zero)&&t.lt(Point.getN())))return"r and s not in range";const r=BN.fromBuffer(this.hashbuf,this.endian?{endian:this.endian}:void 0),i=Point.getN(),o=t.invm(i),n=o.mul(r).umod(i),a=o.mul(e).umod(i),s=Point.getG().mulAdd(n,this.pubkey.point,a);return s.isInfinity()?"p is infinity":0!==s.getX().umod(i).cmp(e)&&"Invalid signature"},ECDSA.toLowS=function(e){return e.gt(BN.fromBuffer(Buffer.from("7FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF5D576E7357A4501DDFE92F46681B20A0","hex")))&&(e=Point.getN().sub(e)),e},ECDSA.prototype._findSignature=function(e,t){const r=Point.getN(),i=Point.getG();let o,n,a,s=0;do{(!this.k||0<s)&&this.deterministicK(s),s+=1;const u=this.k;n=(o=i.mul(u)).x.umod(r),a=u.invm(r).mul(t.add(e.mul(n))).umod(r)}while(0>=n.cmp(BN.Zero)||0>=a.cmp(BN.Zero));return{s:a=ECDSA.toLowS(a),r:n}},ECDSA.prototype.sign=function(){const e=this.hashbuf,t=this.privkey,r=t.bn;preconditions.checkState(e&&t&&r,"invalid parameters"),preconditions.checkState(BufferUtil.isBuffer(e),"hashbuf must be a buffer"),preconditions.checkState(32===e.length,"hashbuf must be 32 bytes");const i=BN.fromBuffer(e,this.endian?{endian:this.endian}:void 0),o=this._findSignature(r,i);return o.compressed=this.pubkey.compressed,this.sig=new Signature(o),this},ECDSA.prototype.signRandomK=function(){return this.randomK(),this.sign()},ECDSA.prototype.toString=function(){const e={};return this.hashbuf&&(e.hashbuf=this.hashbuf.toString("hex")),this.privkey&&(e.privkey=this.privkey.toString()),this.pubkey&&(e.pubkey=this.pubkey.toString()),this.sig&&(e.sig=this.sig.toString()),this.k&&(e.k=this.k.toString()),JSON.stringify(e)},ECDSA.prototype.verify=function(){return this.verified=!this.sigError(),this},ECDSA.sign=function(e,t,r){return ECDSA().set({hashbuf:e,endian:r,privkey:t}).sign().sig},ECDSA.verify=function(e,t,r,i){return ECDSA().set({hashbuf:e,endian:i,sig:t,pubkey:r}).verify().verified};const SIGHASH_SINGLE_BUG="0000000000000000000000000000000000000000000000000000000000000001",BITS_64_ON="ffffffffffffffff",ENABLE_SIGHASH_FORKID=!0;class Sighash{static sighashForForkId(e,t,r,i,o){function n(e,t){const r=new BufferWriter;_.isUndefined(t)?_.each(e.outputs,e=>{e.toBufferWriter(r)}):e.outputs[t].toBufferWriter(r);const i=r.toBuffer();return Hash.sha256sha256(i)}const a=e.inputs[r];preconditions.checkArgument(o instanceof BN,"For ForkId=0 signatures, satoshis or complete input must be provided");let s=BufferUtil.emptyBuffer(32),u=BufferUtil.emptyBuffer(32),c=BufferUtil.emptyBuffer(32);t&Signature.SIGHASH_ANYONECANPAY||(s=function(e){const t=new BufferWriter;_.each(e.inputs,e=>{t.writeReverse(e.prevTxId),t.writeUInt32LE(e.outputIndex)});const r=t.toBuffer();return Hash.sha256sha256(r)}(e)),t&Signature.SIGHASH_ANYONECANPAY||(31&t)===Signature.SIGHASH_SINGLE||(31&t)===Signature.SIGHASH_NONE||(u=function(e){const t=new BufferWriter;_.each(e.inputs,e=>{t.writeUInt32LE(e.sequenceNumber)});const r=t.toBuffer();return Hash.sha256sha256(r)}(e)),(31&t)!==Signature.SIGHASH_SINGLE&&(31&t)!==Signature.SIGHASH_NONE?c=n(e):(31&t)===Signature.SIGHASH_SINGLE&&r<e.outputs.length&&(c=n(e,r));const l=new BufferWriter;l.writeInt32LE(e.version),l.write(s),l.write(u),l.writeReverse(a.prevTxId),l.writeUInt32LE(a.outputIndex),l.writeVarintNum(i.toBuffer().length),l.write(i.toBuffer()),l.writeUInt64LEBN(o);const p=a.sequenceNumber;l.writeUInt32LE(p),l.write(c),l.writeUInt32LE(e.nLockTime),l.writeUInt32LE(t>>>0);const h=l.toBuffer();let f=Hash.sha256sha256(h);return f=new BufferReader(f).readReverse()}static sighash(e,t,r,i,o){const n=Transaction.shallowCopy(e);if(i=new Script(i),t&Signature.SIGHASH_FORKID&&ENABLE_SIGHASH_FORKID)return Sighash.sighashForForkId(n,t,r,i,o);let a;for(i.removeCodeseparators(),a=0;a<n.inputs.length;a+=1)n.inputs[a]=new Input(n.inputs[a]).setScript(Script.empty());if(n.inputs[r]=new Input(n.inputs[r]).setScript(i),(31&t)===Signature.SIGHASH_NONE||(31&t)===Signature.SIGHASH_SINGLE)for(a=0;a<n.inputs.length;a+=1)a!==r&&(n.inputs[a].sequenceNumber=0);if((31&t)===Signature.SIGHASH_NONE)n.outputs=[];else if((31&t)===Signature.SIGHASH_SINGLE){if(r>=n.outputs.length)return Buffer.from(SIGHASH_SINGLE_BUG,"hex");for(n.outputs.length=r+1,a=0;a<r;a+=1)n.outputs[a]=new Output({satoshis:BN.fromBuffer(Buffer.from(BITS_64_ON,"hex")),script:Script.empty()})}t&Signature.SIGHASH_ANYONECANPAY&&(n.inputs=[n.inputs[r]]);const s=(new BufferWriter).write(n.toBuffer()).writeInt32LE(t).toBuffer();let u=Hash.sha256sha256(s);return u=new BufferReader(u).readReverse()}static sign(e,t,r,i,o,n){const a=Sighash.sighash(e,r,i,o,n);return ECDSA.sign(a,t,"little").set({nhashtype:r})}static verify(e,t,r,i,o,n){preconditions.checkArgument(!_.isUndefined(e)),preconditions.checkArgument(!_.isUndefined(t)&&!_.isUndefined(t.nhashtype));const a=Sighash.sighash(e,t.nhashtype,i,o,n);return ECDSA.verify(a,t,r,"little")}}const DEFAULT_RBF_SEQNUMBER=4294967293,DEFAULT_SEQNUMBER=4294967295,DEFAULT_LOCKTIME_SEQNUMBER=4294967294;class Input{constructor(e){return this instanceof Input?e?this._fromObject(e):void 0:new Input(e)}get script(){return this.isNull()?null:(this._script||(this._script=new Script(this._scriptBuffer),this._script._isInput=!0),this._script)}static fromObject(e){return preconditions.checkArgument(null!==e&&"object"==typeof e),(new Input)._fromObject(e)}_fromObject(e){if(void 0===e.script&&void 0===e.scriptBuffer)throw new errors.Transaction.Input.MissingScript;return this.prevTxId="string"==typeof e.prevTxId&&JSUtil.isHexa(e.prevTxId)?Buffer.from(e.prevTxId,"hex"):e.prevTxId,e.output&&(this.output=e.output instanceof Output?e.output:new Output(e.output)),this.outputIndex=void 0===e.outputIndex?e.txoutnum:e.outputIndex,this.sequenceNumber=void 0===e.sequenceNumber?void 0===e.seqnum?DEFAULT_SEQNUMBER:e.seqnum:e.sequenceNumber,this.setScript(e.scriptBuffer||e.script),this}toJSON(){const e={prevTxId:this.prevTxId.toString("hex"),outputIndex:this.outputIndex,sequenceNumber:this.sequenceNumber,script:this._scriptBuffer.toString("hex")};return this.script&&(e.scriptString=this.script.toString()),this.output&&(e.output=this.output.toObject()),e}toObject(){return this.toJSON()}static fromBufferReader(e){const t=new Input;return t.prevTxId=e.readReverse(32),t.outputIndex=e.readUInt32LE(),t._scriptBuffer=e.readVarLengthBuffer(),t.sequenceNumber=e.readUInt32LE(),t}toBufferWriter(e){(e=e||new BufferWriter).writeReverse(this.prevTxId),e.writeUInt32LE(this.outputIndex);const t=this._scriptBuffer;return e.writeVarintNum(t.length),e.write(t),e.writeUInt32LE(this.sequenceNumber),e}setScript(e){if(this._script=null,e instanceof Script)this._script=e,this._script._isInput=!0,this._scriptBuffer=e.toBuffer();else if(JSUtil.isHexa(e))this._scriptBuffer=Buffer.from(e,"hex");else if("string"==typeof e)this._script=new Script(e),this._script._isInput=!0,this._scriptBuffer=this._script.toBuffer();else{if(!BufferUtil.isBuffer(e))throw new TypeError("Invalid argument type: script");this._scriptBuffer=Buffer.from(e)}return this}getSignatures(){throw new errors.AbstractMethodInvoked("".concat("Trying to sign unsupported output type (only P2PKH and P2SH multisig inputs are supported) for input: ").concat(JSON.stringify(this)))}isFullySigned(){throw new errors.AbstractMethodInvoked("Input#isFullySigned")}isFinal(){return 4294967295!==this.sequenceNumber}addSignature(){throw new errors.AbstractMethodInvoked("Input#addSignature")}clearSignatures(){throw new errors.AbstractMethodInvoked("Input#clearSignatures")}isValidSignature(e,t){return t.signature.nhashtype=t.sigtype,Sighash.verify(e,t.signature,t.publicKey,t.inputIndex,this.output.script,this.output.satoshisBN)}isNull(){return"0000000000000000000000000000000000000000000000000000000000000000"===this.prevTxId.toString("hex")&&4294967295===this.outputIndex}_estimateSize(){return this.toBufferWriter().toBuffer().length}}Input.MAXINT=4294967295,Input.DEFAULT_SEQNUMBER=DEFAULT_SEQNUMBER,Input.DEFAULT_LOCKTIME_SEQNUMBER=4294967294,Input.DEFAULT_RBF_SEQNUMBER=4294967293;class TransactionSignature extends Signature{constructor(e){if(super(e),e instanceof TransactionSignature)return e;if(_.isObject(e))return this._fromObject(e);throw new errors.InvalidArgument("TransactionSignatures must be instantiated from an object")}_fromObject(e){return TransactionSignature._checkObjectArgs(e),this.publicKey=new PublicKey(e.publicKey),this.prevTxId=BufferUtil.isBuffer(e.prevTxId)?e.prevTxId:Buffer.from(e.prevTxId,"hex"),this.outputIndex=e.outputIndex,this.inputIndex=e.inputIndex,this.signature=e.signature instanceof Signature?e.signature:BufferUtil.isBuffer(e.signature)?Signature.fromBuffer(e.signature):Signature.fromString(e.signature),this.sigtype=e.sigtype,this}static _checkObjectArgs(e){preconditions.checkArgument(PublicKey(e.publicKey),"publicKey"),preconditions.checkArgument(!_.isUndefined(e.inputIndex),"inputIndex"),preconditions.checkArgument(!_.isUndefined(e.outputIndex),"outputIndex"),preconditions.checkState(_.isNumber(e.inputIndex),"inputIndex must be a number"),preconditions.checkState(_.isNumber(e.outputIndex),"outputIndex must be a number"),preconditions.checkArgument(e.signature,"signature"),preconditions.checkArgument(e.prevTxId,"prevTxId"),preconditions.checkState(e.signature instanceof Signature||BufferUtil.isBuffer(e.signature)||JSUtil.isHexa(e.signature),"signature must be a buffer or hexa value"),preconditions.checkState(BufferUtil.isBuffer(e.prevTxId)||JSUtil.isHexa(e.prevTxId),"prevTxId must be a buffer or hexa value"),preconditions.checkArgument(e.sigtype,"sigtype"),preconditions.checkState(_.isNumber(e.sigtype),"sigtype must be a number")}toJSON(){return{publicKey:this.publicKey.toString(),prevTxId:this.prevTxId.toString("hex"),outputIndex:this.outputIndex,inputIndex:this.inputIndex,signature:this.signature.toString(),sigtype:this.sigtype}}toObject(){return this.toJSON()}static fromObject(e){return preconditions.checkArgument(e),new TransactionSignature(e)}}class MultiSigScriptHashInput extends Input{constructor(e,t,r,i,o){super(e,t,r,i,o);const n=this;t=t||e.publicKeys,this.threshold=r||e.threshold,i=i||e.signatures,this.publicKeys=_.sortBy(t,e=>e.toString("hex")),this.redeemScript=o||Script.buildMultisigOut(this.publicKeys,this.threshold),preconditions.checkState(Script.buildScriptHashOut(this.redeemScript).equals(this.output.script),"RedeemScript does not hash to the provided output"),this.publicKeyIndex={},this.publicKeys.forEach((e,t)=>{n.publicKeyIndex[e.toString()]=t}),this.signatures=i?this._deserializeSignatures(i):Array(this.publicKeys.length)}toObject(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=Input.prototype.toObject.apply(this,t);return i.threshold=this.threshold,i.publicKeys=this.publicKeys.map(e=>e.toString()),i.signatures=this._serializeSignatures(),i}_deserializeSignatures(e){return e.map(e=>e?new TransactionSignature(e):void 0)}_serializeSignatures(){return this.signatures.map(e=>e?e.toObject():void 0)}getSignatures(e,t,r,i){return preconditions.checkState(this.output instanceof Output,"Malformed output found when signing transaction"),i=i||Signature.SIGHASH_ALL|Signature.SIGHASH_FORKID,this.publicKeys.filter(e=>e.toString()===t.publicKey.toString()).map(o=>new TransactionSignature({publicKey:o,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:r,signature:Sighash.sign(e,t,i,r,this.redeemScript,this.output.satoshisBN),sigtype:i}))}addSignature(e,t){return preconditions.checkState(!this.isFullySigned(),"All needed signatures have already been added"),preconditions.checkArgument(void 0!==this.publicKeyIndex[t.publicKey.toString()],"Signature has no matching public key"),preconditions.checkState(this.isValidSignature(e,t),"Signature invalid"),this.signatures[this.publicKeyIndex[t.publicKey.toString()]]=t,this._updateScript(),this}_updateScript(){return this.setScript(Script.buildP2SHMultisigIn(this.publicKeys,this.threshold,this._createSignatures(),{cachedMultisig:this.redeemScript})),this}_createSignatures(){return this.signatures.filter(e=>void 0!==e).map(e=>BufferUtil.concat([e.signature.toDER(),BufferUtil.integerAsSingleByteBuffer(e.sigtype)]))}clearSignatures(){this.signatures=Array(this.publicKeys.length),this._updateScript()}isFullySigned(){return this.countSignatures()===this.threshold}countMissingSignatures(){return this.threshold-this.countSignatures()}countSignatures(){return this.signatures.reduce((e,t)=>e+!!t,0)}publicKeysWithoutSignature(){return this.publicKeys.filter(e=>!this.signatures[this.publicKeyIndex[e.toString()]])}isValidSignature(e,t){return t.signature.nhashtype=t.sigtype,Sighash.verify(e,t.signature,t.publicKey,t.inputIndex,this.redeemScript,this.output.satoshisBN)}_estimateSize(){return MultiSigScriptHashInput.OPCODES_SIZE+this.threshold*MultiSigScriptHashInput.SIGNATURE_SIZE+this.publicKeys.length*MultiSigScriptHashInput.PUBKEY_SIZE}}MultiSigScriptHashInput.OPCODES_SIZE=7,MultiSigScriptHashInput.SIGNATURE_SIZE=74,MultiSigScriptHashInput.PUBKEY_SIZE=34;class MultiSigInput extends Input{constructor(e,t,r,i){super(e,t,r,i),t=t||e.publicKeys,this.threshold=r||e.threshold,i=i||e.signatures,this.publicKeys=_.sortBy(t,e=>e.toString("hex")),preconditions.checkState(Script.buildMultisigOut(this.publicKeys,this.threshold).equals(this.output.script),"Provided public keys don't match to the provided output script"),this.publicKeyIndex={},this.publicKeys.forEach((e,t)=>{this.publicKeyIndex[e.toString()]=t}),this.signatures=i?this._deserializeSignatures(i):Array(this.publicKeys.length)}toObject(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=Input.prototype.toObject.apply(this,t);return i.threshold=this.threshold,i.publicKeys=this.publicKeys.map(e=>e.toString()),i.signatures=this._serializeSignatures(),i}_deserializeSignatures(e){return e.map(e=>e?new TransactionSignature(e):void 0)}_serializeSignatures(){return this.signatures.map(e=>e?e.toObject():void 0)}getSignatures(e,t,r,i){return preconditions.checkState(this.output instanceof Output,"Malformed output found when signing transaction"),i=i||Signature.SIGHASH_ALL|Signature.SIGHASH_FORKID,this.publicKeys.filter(e=>e.toString()===t.publicKey.toString()).map(o=>new TransactionSignature({publicKey:o,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:r,signature:Sighash.sign(e,t,i,r,this.output.script,this.output.satoshisBN),sigtype:i}))}addSignature(e,t){return preconditions.checkState(!this.isFullySigned(),"All needed signatures have already been added"),preconditions.checkArgument(void 0!==this.publicKeyIndex[t.publicKey.toString()],"Signature has no matching public key"),preconditions.checkState(this.isValidSignature(e,t),"Signature invalid"),this.signatures[this.publicKeyIndex[t.publicKey.toString()]]=t,this._updateScript(),this}_updateScript(){return this.setScript(Script.buildMultisigIn(this.publicKeys,this.threshold,this._createSignatures())),this}_createSignatures(){return this.signatures.filter(e=>void 0!==e).map(e=>BufferUtil.concat([e.signature.toDER(),BufferUtil.integerAsSingleByteBuffer(e.sigtype)]))}clearSignatures(){this.signatures=Array(this.publicKeys.length),this._updateScript()}isFullySigned(){return this.countSignatures()===this.threshold}countMissingSignatures(){return this.threshold-this.countSignatures()}countSignatures(){return this.signatures.reduce((e,t)=>e+!!t,0)}publicKeysWithoutSignature(){return this.publicKeys.filter(e=>!this.signatures[this.publicKeyIndex[e.toString()]])}isValidSignature(e,t){return t.signature.nhashtype=t.sigtype,Sighash.verify(e,t.signature,t.publicKey,t.inputIndex,this.output.script,this.output.satoshisBN)}static normalizeSignatures(e,t,r,i,o){return o.map(o=>{let n=null;return i=i.filter(i=>{if(n)return!0;const a=new TransactionSignature({signature:Signature.fromTxFormat(i),publicKey:o,prevTxId:t.prevTxId,outputIndex:t.outputIndex,inputIndex:r,sigtype:Signature.SIGHASH_ALL});return a.signature.nhashtype=a.sigtype,!Sighash.verify(e,a.signature,a.publicKey,a.inputIndex,t.output.script)||(n=a,!1)}),n||null})}_estimateSize(){return MultiSigInput.OPCODES_SIZE+this.threshold*MultiSigInput.SIGNATURE_SIZE}}MultiSigInput.OPCODES_SIZE=1,MultiSigInput.SIGNATURE_SIZE=73;class PublicKeyInput extends Input{getSignatures(e,t,r,i){preconditions.checkState(this.output instanceof Output,"Malformed output found when signing transaction"),i=i||Signature.SIGHASH_ALL|Signature.SIGHASH_FORKID;const o=t.toPublicKey();return o.toString()===this.output.script.getPublicKey().toString("hex")?[new TransactionSignature({publicKey:o,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:r,signature:Sighash.sign(e,t,i,r,this.output.script,this.output.satoshisBN),sigtype:i})]:[]}addSignature(e,t){return preconditions.checkState(this.isValidSignature(e,t),"Signature invalid"),this.setScript(Script.buildPublicKeyIn(t.signature.toDER(),t.sigtype)),this}clearSignatures(){return this.setScript(Script.empty()),this}isFullySigned(){return this.script.isPublicKeyIn()}_estimateSize(){return PublicKeyInput.SCRIPT_MAX_SIZE}}PublicKeyInput.SCRIPT_MAX_SIZE=73;class PublicKeyHashInput extends Input{getSignatures(e,t,r,i,o){return preconditions.checkState(this.output instanceof Output,"Malformed output found when signing transaction"),o=o||Hash.sha256ripemd160(t.publicKey.toBuffer()),i=i||Signature.SIGHASH_ALL|Signature.SIGHASH_FORKID,BufferUtil.equals(o,this.output.script.getPublicKeyHash())?[new TransactionSignature({publicKey:t.toPublicKey(),prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:r,signature:Sighash.sign(e,t,i,r,this.output.script,this.output.satoshisBN),sigtype:i})]:[]}addSignature(e,t){preconditions.checkState(this.isValidSignature(e,t),"Signature invalid");const r=Script.buildPublicKeyHashIn(t.publicKey,t.signature.toDER(),t.sigtype);return this.setScript(r),this}clearSignatures(){return this.setScript(Script.empty()),this}isFullySigned(){return this.script.isPublicKeyHashIn()}_estimateSize(){return PublicKeyHashInput.SCRIPT_MAX_SIZE}}PublicKeyHashInput.SCRIPT_MAX_SIZE=107;const UNITS={BTC:[1e8,8],mBTC:[1e5,5],uBTC:[100,2],bits:[100,2],satoshis:[1,0]};function Unit(e,t){if(!(this instanceof Unit))return new Unit(e,t);if(_.isNumber(t)){if(0>=t)throw new errors.Unit.InvalidRate(t);e/=t,t=Unit.BTC}this._value=this._from(e,t);const r=this;Object.keys(UNITS).forEach(function(e){Object.defineProperty(r,e,{get:()=>r.to(e),enumerable:!0})})}Object.keys(UNITS).forEach(e=>{Unit[e]=e}),Unit.fromObject=function(e){return preconditions.checkArgument(_.isObject(e),"Argument is expected to be an object"),new Unit(e.amount,e.code)},Unit.fromBTC=function(e){return new Unit(e,Unit.BTC)},Unit.fromMilis=function(e){return new Unit(e,Unit.mBTC)},Unit.fromMillis=Unit.fromMilis,Unit.fromBits=function(e){return new Unit(e,Unit.bits)},Unit.fromMicros=Unit.fromBits,Unit.fromSatoshis=function(e){return new Unit(e,Unit.satoshis)},Unit.fromFiat=function(e,t){return new Unit(e,t)},Unit.prototype._from=function(e,t){if(!UNITS[t])throw new errors.Unit.UnknownCode(t);return parseInt((e*UNITS[t][0]).toFixed(),10)},Unit.prototype.to=function(e){if(_.isNumber(e)){if(0>=e)throw new errors.Unit.InvalidRate(e);return parseFloat((this.BTC*e).toFixed(2))}if(!UNITS[e])throw new errors.Unit.UnknownCode(e);const t=this._value/UNITS[e][0];return parseFloat(t.toFixed(UNITS[e][1]))},Unit.prototype.toBTC=function(){return this.to(Unit.BTC)},Unit.prototype.toMilis=function(){return this.to(Unit.mBTC)},Unit.prototype.toMillis=Unit.prototype.toMilis,Unit.prototype.toBits=function(){return this.to(Unit.bits)},Unit.prototype.toMicros=Unit.prototype.toBits,Unit.prototype.toSatoshis=function(){return this.to(Unit.satoshis)},Unit.prototype.atRate=function(e){return this.to(e)},Unit.prototype.toString=function(){return"".concat(this.satoshis," satoshis")},Unit.prototype.toJSON=function(){return{amount:this.BTC,code:Unit.BTC}},Unit.prototype.toObject=Unit.prototype.toJSON,Unit.prototype.inspect=function(){return"<Unit: ".concat(this.toString(),">")};class UnspentOutput{constructor(e){preconditions.checkArgument(_.isObject(e),"Must provide an object from where to extract data");const t=e.address?new Address(e.address):void 0,r=e.txid?e.txid:e.txId;if(!r||!JSUtil.isHexaString(r)||64<r.length)throw new Error("Invalid TXID in object",e);const i=_.isUndefined(e.vout)?e.outputIndex:e.vout;if(!_.isNumber(i))throw new Error("Invalid outputIndex, received ".concat(i));preconditions.checkArgument(!_.isUndefined(e.scriptPubKey)||!_.isUndefined(e.script),"Must provide the scriptPubKey for that output!");const o=new Script(e.scriptPubKey||e.script);preconditions.checkArgument(!_.isUndefined(e.amount)||!_.isUndefined(e.satoshis),"Must provide an amount for the output");const n=_.isUndefined(e.amount)?e.satoshis:Unit.fromBTC(e.amount).toSatoshis();preconditions.checkArgument(_.isNumber(n),"Amount must be a number"),JSUtil.defineImmutable(this,{address:t,txId:r,outputIndex:i,script:o,satoshis:n})}inspect(){const e="UnspentOutput: ".concat(this.txId,":").concat(this.outputIndex),t="satoshis: ".concat(this.satoshis),r="address: ".concat(this.address);return"<".concat(e,", ").concat(t,", ").concat(r,">")}toString(){return"".concat(this.txId,":").concat(this.outputIndex)}static fromObject(e){return new UnspentOutput(e)}toJSON(){return{address:this.address?this.address.toString():void 0,txid:this.txId,vout:this.outputIndex,scriptPubKey:this.script.toBuffer().toString("hex"),amount:Unit.fromSatoshis(this.satoshis).toBTC()}}toObject(){return this.toJSON()}}const compare=Buffer.compare||bufferCompare,CURRENT_VERSION=1,DEFAULT_NLOCKTIME=0,MAX_BLOCK_SIZE=1e6;class Transaction{constructor(e){if(this.inputs=[],this.outputs=[],this._inputAmount=void 0,this._outputAmount=void 0,e){if(e instanceof Transaction)return Transaction.shallowCopy(e);if(JSUtil.isHexa(e))this.fromString(e);else if(BufferUtil.isBuffer(e))this.fromBuffer(e);else{if(!_.isObject(e))throw new errors.InvalidArgument("Must provide an object or string to deserialize a transaction");this.fromObject(e)}}else this._newTransaction()}get hash(){return new BufferReader(this._getHash()).readReverse().toString("hex")}get id(){return new BufferReader(this._getHash()).readReverse().toString("hex")}get inputAmount(){return this._getInputAmount()}get outputAmount(){return this._getOutputAmount()}_getHash(){return Hash.sha256sha256(this.toBuffer())}serialize(e){return!0===e||e&&e.disableAll?this.uncheckedSerialize():this.checkedSerialize(e)}toString(){return this.toBuffer().toString("hex")}uncheckedSerialize(){return this.toString()}checkedSerialize(e){const t=this.getSerializationError(e);if(t)throw t.message+=" - For more information please see: https://bitcore.io/api/lib/transaction#serialization-checks",t;return this.uncheckedSerialize()}invalidSatoshis(){return this.outputs.some(e=>e.invalidSatoshis())}getSerializationError(){let e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(this.invalidSatoshis())return new errors.Transaction.InvalidSatoshis;const t=this._getUnspentValue();let r;return 0>t?!e.disableMoreOutputThanInput&&(r=new errors.Transaction.InvalidOutputAmountSum):r=this._hasFeeError(e,t),r||this._hasDustOutputs(e)||this._isMissingSignatures(e)}_hasFeeError(e,t){if(void 0!==this._fee&&this._fee!==t)return new errors.Transaction.FeeError.Different("Unspent value is ".concat(t," but specified fee is ").concat(this._fee));if(!e.disableLargeFees){const e=Math.floor(Transaction.FEE_SECURITY_MARGIN*this._estimateFee());if(t>e)return this._missingChange()?new errors.Transaction.ChangeAddressMissing("Fee is too large and no change address was provided"):new errors.Transaction.FeeError.TooLarge("expected less than ".concat(e," but got ").concat(t))}if(!e.disableSmallFees){const e=Math.ceil(this._estimateFee()/Transaction.FEE_SECURITY_MARGIN);if(t<e)return new errors.Transaction.FeeError.TooSmall("expected more than ".concat(e," but got ").concat(t))}}_missingChange(){return!this._changeScript}_hasDustOutputs(e){if(!e.disableDustOutputs){if(0<this.outputs.filter(e=>e.satoshis<Transaction.DUST_AMOUNT&&!e.script.isDataOut()).length)return new errors.Transaction.DustOutputs}}_isMissingSignatures(e){return e.disableIsFullySigned||this.isFullySigned()?void 0:new errors.Transaction.MissingSignatures}inspect(){return"<Transaction: ".concat(this.uncheckedSerialize(),">")}toBuffer(){const e=new BufferWriter;return this.toBufferWriter(e).toBuffer()}toBufferWriter(e){return e.writeInt32LE(this.version),e.writeVarintNum(this.inputs.length),this.inputs.forEach(t=>t.toBufferWriter(e)),e.writeVarintNum(this.outputs.length),this.outputs.forEach(t=>t.toBufferWriter(e)),e.writeUInt32LE(this.nLockTime),e}fromBuffer(e){const t=new BufferReader(e);return this.fromBufferReader(t)}fromBufferReader(e){let t;preconditions.checkArgument(!e.finished(),"No transaction data received when creating transaction from buffer"),this.version=e.readInt32LE();const r=e.readVarintNum();for(t=0;t<r;t+=1){const t=Input.fromBufferReader(e);this.inputs.push(t)}const i=e.readVarintNum();for(t=0;t<i;t+=1)this.outputs.push(Output.fromBufferReader(e));return this.nLockTime=e.readUInt32LE(),this}toJSON(){const e=this.inputs.map(e=>e.toObject()),t=this.outputs.map(e=>e.toObject()),r={hash:this.hash,version:this.version,inputs:e,outputs:t,nLockTime:this.nLockTime};return this._changeScript&&(r.changeScript=this._changeScript.toString()),void 0!==this._changeIndex&&(r.changeIndex=this._changeIndex),void 0!==this._fee&&(r.fee=this._fee),void 0!==this._dataInputs&&(r.dataInputs=this._dataInputs),void 0!==this._dataOutputs&&(r.dataOutputs=this._dataOutputs),r}toObject(){return this.toJSON()}fromObject(e){preconditions.checkArgument(_.isObject(e)||e instanceof Transaction);const t=e instanceof Transaction?e.toObject():e;return t.inputs.forEach(e=>{if(!e.output||!e.output.script)return void this.uncheckedAddInput(new Input(e));const t=new Script(e.output.script);let r;if(t.isPublicKeyHashOut())r=new PublicKeyHashInput(e);else if(t.isScriptHashOut()&&e.publicKeys&&e.threshold)r=new MultiSigScriptHashInput(e,e.publicKeys,e.threshold,e.signatures);else{if(!t.isPublicKeyOut())throw new errors.Transaction.Input.UnsupportedScript(e.output.script);r=new PublicKeyInput(e)}this.addInput(r)}),t.outputs.forEach(e=>this.addOutput(new Output(e))),t.changeIndex&&(this._changeIndex=t.changeIndex),t.changeScript&&(this._changeScript=new Script(t.changeScript)),t.fee&&(this._fee=t.fee),this.nLockTime=t.nLockTime,this.version=t.version,this._checkConsistency(e),this}_checkConsistency(e){void 0!==this._changeIndex&&(preconditions.checkState(this._changeScript,"Change script missing"),preconditions.checkState(this.outputs[this._changeIndex],"Change output missing"),preconditions.checkState(this.outputs[this._changeIndex].script.toString()===this._changeScript.toString(),"Script in argument does not match script in transaction")),e&&e.hash&&preconditions.checkState(e.hash===this.hash,"Hash in argument does not match transaction hash")}lockUntilDate(e){if(preconditions.checkArgument(e),_.isNumber(e)&&e<Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT)throw new errors.Transaction.LockTimeTooEarly;return _.isDate(e)&&(e=e.getTime()/1e3),this.inputs.forEach(e=>{e.sequenceNumber===Input.DEFAULT_SEQNUMBER&&(e.sequenceNumber=Input.DEFAULT_LOCKTIME_SEQNUMBER)}),this.nLockTime=e,this}lockUntilBlockHeight(e){if(preconditions.checkArgument(_.isNumber(e),"Block height must be a number"),e>=Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT)throw new errors.Transaction.BlockHeightTooHigh;if(0>e)throw new errors.Transaction.NLockTimeOutOfRange;return this.inputs.forEach(e=>{e.sequenceNumber===Input.DEFAULT_SEQNUMBER&&(e.sequenceNumber=Input.DEFAULT_LOCKTIME_SEQNUMBER)}),this.nLockTime=e,this}getLockTime(){return this.nLockTime?this.nLockTime<Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT?this.nLockTime:new Date(1e3*this.nLockTime):null}fromString(e){this.fromBuffer(Buffer.from(e,"hex"))}_newTransaction(){this.version=CURRENT_VERSION,this.nLockTime=DEFAULT_NLOCKTIME}from(e,t,r){if(Array.isArray(e))return e.forEach(e=>this.from(e,t,r)),this;const i=this.inputs.some(t=>t.prevTxId.toString("hex")===e.txId&&t.outputIndex===e.outputIndex);let o;const n=new UnspentOutput(e);if(i)return this;if(t&&r)if(preconditions.checkArgument(r<=t.length,"Number of signatures must be greater than the number of public keys"),n.script.isMultisigOut())o=MultiSigInput;else{if(!n.script.isScriptHashOut())throw new Error("@TODO");o=MultiSigScriptHashInput}else o=n.script.isPublicKeyHashOut()?PublicKeyHashInput:n.script.isPublicKeyOut()?PublicKeyInput:Input;const a=new o({output:new Output({script:n.script,satoshis:n.satoshis}),prevTxId:n.txId,outputIndex:n.outputIndex,script:Script.empty()},t,r);return this.addInput(a),this}addInput(e,t,r){if(preconditions.checkArgumentType(e,Input,"Trying to add input of type other than input"),!e.output&&(void 0===t||void 0===r))throw new errors.Transaction.NeedMoreInfo("Need information about the UTXO script and satoshis");return!e.output&&t&&void 0!==r&&(t=t instanceof Script?t:new Script(t),preconditions.checkArgumentType(r,"number","Satoshis must be a number when adding input"),e.output=new Output({script:t,satoshis:r})),this.uncheckedAddInput(e)}uncheckedAddInput(e){return preconditions.checkArgumentType(e,Input,"Trying to add input of type other than input"),this.inputs.push(e),this._inputAmount=void 0,this._updateChangeOutput(),this}hasAllUtxoInfo(){return this.inputs.map(e=>!!e.output)}fee(e){return preconditions.checkArgument(_.isNumber(e),"Amount must be a number"),this._fee=e,this._updateChangeOutput(),this}feePerKb(e){return preconditions.checkArgument(_.isNumber(e),"Amount must be a number"),this._feePerKb=e,this._updateChangeOutput(),this}change(e){return preconditions.checkArgument(e,"Address is required"),this._changeScript=Script.fromAddress(e),this._updateChangeOutput(),this}getChangeOutput(){return void 0===this._changeIndex?null:this.outputs[this._changeIndex]}to(e,t){if(Array.isArray(e)){const t=this;return e.forEach(e=>t.to(e.address,e.satoshis)),this}return preconditions.checkArgument(JSUtil.isNaturalNumber(t),"Amount is expected to be a positive integer"),this.addOutput(new Output({script:Script(new Address(e)),satoshis:t})),this}addData(e){return this.addOutput(new Output({script:Script.buildDataOut(e),satoshis:0})),this}addOutput(e){return preconditions.checkArgumentType(e,Output,"Output needs to be of type output"),this._addOutput(e),this._updateChangeOutput(),this}clearOutputs(){return this.outputs=[],this._clearSignatures(),this._outputAmount=void 0,this._changeIndex=void 0,this._updateChangeOutput(),this}_addOutput(e){this.outputs.push(e),this._outputAmount=void 0}_getOutputAmount(){return void 0===this._outputAmount&&(this._outputAmount=this.outputs.reduce((e,t)=>e+t.satoshis,0)),this._outputAmount}_getInputAmount(){if(void 0===this._inputAmount){const e=this;this._inputAmount=0,this.inputs.forEach(t=>{if(void 0===t.output)throw new errors.Transaction.Input.MissingPreviousOutput;e._inputAmount+=t.output.satoshis})}return this._inputAmount}_updateChangeOutput(){if(!this._changeScript)return;this._clearSignatures(),void 0!==this._changeIndex&&this._removeOutput(this._changeIndex);const e=this._getUnspentValue()-this.getFee();0<e?(this._changeIndex=this.outputs.length,this._addOutput(new Output({script:this._changeScript,satoshis:e}))):this._changeIndex=void 0}getFee(){return this.isCoinbase()?0:void 0===this._fee?this._changeScript?this._estimateFee():this._getUnspentValue():this._fee}_estimateFee(){const e=this._estimateSize(),t=this._getUnspentValue();return Transaction._estimateFee(e,t,this._feePerKb)}_getUnspentValue(){return this._getInputAmount()-this._getOutputAmount()}_clearSignatures(){this.inputs.forEach(e=>e.clearSignatures())}_estimateSize(){let e=this.inputs.reduce((e,t)=>e+t._estimateSize(),Transaction.MAXIMUM_EXTRA_SIZE);return e=this.outputs.reduce((e,t)=>e+t.script.toBuffer().length+9,e)}_removeOutput(e){const t=this.outputs[e];this.outputs=this.outputs.filter(e=>e!==t),this._outputAmount=void 0}removeOutput(e){this._removeOutput(e),this._updateChangeOutput()}sort(){return this.sortInputs(e=>{const t=Array.prototype.concat.apply([],e);return t.sort((e,t)=>compare(e.prevTxId,t.prevTxId)||e.outputIndex-t.outputIndex),t}),this.sortOutputs(e=>{const t=Array.prototype.concat.apply([],e);return t.sort((e,t)=>e.satoshis-t.satoshis||compare(e.script.toBuffer(),t.script.toBuffer())),t}),this}shuffleOutputs(){return this.sortOutputs(_.shuffle)}sortOutputs(e){const t=e(this.outputs);return this._newOutputOrder(t)}sortInputs(e){return this.inputs=e(this.inputs),this._clearSignatures(),this}_newOutputOrder(e){if(this.outputs.length!==e.length||0!==_.difference(this.outputs,e).length)throw new errors.Transaction.InvalidSorting;if(void 0!==this._changeIndex){const t=this.outputs[this._changeIndex];this._changeIndex=_.findIndex(e,t)}return this.outputs=e,this}removeInput(e,t){let r;if(0>(r=!t&&_.isNumber(e)?e:_.findIndex(this.inputs,r=>r.prevTxId.toString("hex")===e&&r.outputIndex===t))||r>=this.inputs.length)throw new errors.Transaction.InvalidIndex(r,this.inputs.length);const i=this.inputs[r];this.inputs=_.without(this.inputs,i),this._inputAmount=void 0,this._updateChangeOutput()}sign(e,t){preconditions.checkState(this.hasAllUtxoInfo(),"Cannot sign because an input is not defined");const r=this;return Array.isArray(e)?(e.forEach(e=>r.sign(e,t)),this):(this.getSignatures(e,t).forEach(e=>r.applySignature(e)),this)}getSignatures(e,t){e=new PrivateKey(e),t=t||Signature.SIGHASH_ALL|Signature.SIGHASH_FORKID;const r=this,i=[],o=Hash.sha256ripemd160(e.publicKey.toBuffer());return this.inputs.forEach((n,a)=>{n.getSignatures(r,e,a,t,o).forEach(e=>i.push(e))}),i}applySignature(e){return this.inputs[e.inputIndex].addSignature(this,e),this}isFullySigned(){return this.inputs.forEach(e=>{if(e.isFullySigned===Input.prototype.isFullySigned)throw new errors.Transaction.UnableToVerifySignature("Unrecognized script kind, or not enough information to execute script.This usually happens when creating a transaction from a serialized transaction")}),this.inputs.map(e=>e.isFullySigned()).every(e=>e)}isValidSignature(e){if(this.inputs[e.inputIndex].isValidSignature===Input.prototype.isValidSignature)throw new errors.Transaction.UnableToVerifySignature("Unrecognized script kind, or not enough information to execute script.This usually happens when creating a transaction from a serialized transaction");return this.inputs[e.inputIndex].isValidSignature(this,e)}verifySignature(e,t,r,i){return Sighash.verify(this,e,t,r,i)}verify(){let e;if(0===this.inputs.length)return"transaction txins empty";if(0===this.outputs.length)return"transaction txouts empty";let t=new BN(0);for(e=0;e<this.outputs.length;e+=1){if(this.outputs[e].invalidSatoshis())return"Transaction output contains invalid amount";if(this.outputs[e]._satoshisBN.gt(new BN(Transaction.MAX_MONEY,10)))return"Transaction output contains too high satoshi amount";if((t=t.add(this.outputs[e]._satoshisBN)).gt(new BN(Transaction.MAX_MONEY)))return"Transaction output contains too high satoshi amount"}if(this.toBuffer().length>MAX_BLOCK_SIZE)return"Transaction over the maximum block size";const r={};for(e=0;e<this.inputs.length;e+=1){const t="".concat(this.inputs[e].prevTxId,":").concat(this.inputs[e].outputIndex);if(void 0!==r[t])return"Transaction contains duplicate input";r[t]=!0}if(this.isCoinbase()){const e=this.inputs[0]._scriptBuffer;if(2>e.length||100<e.length)return"Coinbase transaction script size invalid"}else if(0<this.inputs.filter(e=>e.isNull()).length)return"Transaction has null input";return!0}isCoinbase(){return 1===this.inputs.length&&this.inputs[0].isNull()}isRBF(){return this.inputs.some(e=>e.sequenceNumber<Input.MAXINT-1)}enableRBF(){return this.inputs=this.inputs.map(e=>(e.sequenceNumber>=Input.MAXINT-1&&(e.sequenceNumber=Input.DEFAULT_RBF_SEQNUMBER),e)),this}static shallowCopy(e){return new Transaction(e.toBuffer())}static _estimateFee(e,t,r){return t>Math.ceil(e/1e3)*(r||Transaction.FEE_PER_KB)&&(e+=Transaction.CHANGE_OUTPUT_MAX_SIZE),Math.ceil(e/1e3)*(r||Transaction.FEE_PER_KB)}}Transaction.DUST_AMOUNT=546,Transaction.FEE_SECURITY_MARGIN=150,Transaction.MAX_MONEY=21e14,Transaction.NLOCKTIME_BLOCKHEIGHT_LIMIT=5e8,Transaction.NLOCKTIME_MAX_VALUE=4294967295,Transaction.FEE_PER_KB=2e4,Transaction.CHANGE_OUTPUT_MAX_SIZE=62,Transaction.MAXIMUM_EXTRA_SIZE=26;class Block{constructor(e){return this instanceof Block?(_.extend(this,Block._from(e)),this):new Block(e)}static _from(e){let t={};if(BufferUtil.isBuffer(e))t=Block._fromBufferReader(BufferReader(e));else{if(!_.isObject(e))throw new TypeError("Unrecognized argument for Block");t=Block._fromObject(e)}return t}static _fromObject(e){const t=[];return e.transactions.forEach(e=>{e instanceof Transaction?t.push(e):t.push((new Transaction).fromObject(e))}),{header:BlockHeader.fromObject(e.header),transactions:t}}static fromObject(e){const t=Block._fromObject(e);return new Block(t)}static _fromBufferReader(e){const t={};preconditions.checkState(!e.finished(),"No block data received"),t.header=BlockHeader.fromBufferReader(e);const r=e.readVarintNum();t.transactions=[];for(let i=0;i<r;i+=1)t.transactions.push((new Transaction).fromBufferReader(e));return t}static fromBufferReader(e){preconditions.checkArgument(e,"br is required");const t=Block._fromBufferReader(e);return new Block(t)}static fromBuffer(e){return Block.fromBufferReader(new BufferReader(e))}static fromString(e){const t=Buffer.from(e,"hex");return Block.fromBuffer(t)}static fromRawBlock(e){BufferUtil.isBuffer(e)||(e=Buffer.from(e,"binary"));const t=BufferReader(e);t.pos=Block.Values.START_OF_BLOCK;const r=Block._fromBufferReader(t);return new Block(r)}toJSON(){const e=[];return this.transactions.forEach(t=>{e.push(t.toObject())}),{header:this.header.toObject(),transactions:e}}toObject(){return this.toJSON()}toBuffer(){return this.toBufferWriter().concat()}toString(){return this.toBuffer().toString("hex")}toBufferWriter(e){e||(e=new BufferWriter),e.write(this.header.toBuffer()),e.writeVarintNum(this.transactions.length);for(let t=0;t<this.transactions.length;t+=1)this.transactions[t].toBufferWriter(e);return e}getTransactionHashes(){const e=[];if(0===this.transactions.length)return[Block.Values.NULL_HASH];for(let t=0;t<this.transactions.length;t+=1)e.push(this.transactions[t]._getHash());return e}getMerkleTree(){const e=this.getTransactionHashes();let t=0;for(let r=this.transactions.length;1<r;r=Math.floor((r+1)/2)){for(let i=0;i<r;i+=2){const o=Math.min(i+1,r-1),n=Buffer.concat([e[t+i],e[t+o]]);e.push(Hash.sha256sha256(n))}t+=r}return e}getMerkleRoot(){const e=this.getMerkleTree();return e[e.length-1]}validMerkleRoot(){const e=new BN(this.header.merkleRoot.toString("hex"),"hex"),t=new BN(this.getMerkleRoot().toString("hex"),"hex");return!(0!==e.cmp(t))}_getHash(){return this.header._getHash()}inspect(){return"<Block ".concat(this.id,">")}}Block.MAX_BLOCK_SIZE=1e6;const idProperty$1={configurable:!1,enumerable:!0,get(){return this._id||(this._id=this.header.id),this._id},set:_.noop};Object.defineProperty(Block.prototype,"id",idProperty$1),Object.defineProperty(Block.prototype,"hash",idProperty$1),Block.Values={START_OF_BLOCK:8,NULL_HASH:Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex")};const hdErrors=errors.HDPublicKey;function HDPublicKey(e){if(e instanceof HDPublicKey)return e;if(!(this instanceof HDPublicKey))return new HDPublicKey(e);if(e){if(_.isString(e)||BufferUtil.isBuffer(e)){const t=HDPublicKey.getSerializedError(e);if(!t)return this._buildFromSerialized(e);if(BufferUtil.isBuffer(e)&&!HDPublicKey.getSerializedError(e.toString()))return this._buildFromSerialized(e.toString());if(t instanceof hdErrors.ArgumentIsPrivateExtended)return new HDPrivateKey(e).hdPublicKey;throw t}if(_.isObject(e))return e instanceof HDPrivateKey?this._buildFromPrivate(e):this._buildFromObject(e);throw new hdErrors.UnrecognizedArgument(e)}throw new hdErrors.MustSupplyArgument}HDPublicKey.isValidPath=function(e){if(_.isString(e)){const t=HDPrivateKey._getDerivationIndexes(e);return null!==t&&_.every(t,HDPublicKey.isValidPath)}return!!_.isNumber(e)&&0<=e&&e<HDPublicKey.Hardened},HDPublicKey.prototype.derive=function(e,t){return this.deriveChild(e,t)},HDPublicKey.prototype.deriveChild=function(e,t){if(_.isNumber(e))return this._deriveWithNumber(e,t);if(_.isString(e))return this._deriveFromString(e);throw new hdErrors.InvalidDerivationArgument(e)},HDPublicKey.prototype._deriveWithNumber=function(e,t){if(e>=HDPublicKey.Hardened||t)throw new hdErrors.InvalidIndexCantDeriveHardened;if(0>e)throw new hdErrors.InvalidPath(e);const r=BufferUtil.integerAsBuffer(e),i=BufferUtil.concat([this.publicKey.toBuffer(),r]),o=Hash.sha512hmac(i,this._buffers.chainCode),n=BN.fromBuffer(o.slice(0,32),{size:32}),a=o.slice(32,64);let s;try{s=PublicKey.fromPoint(Point.getG().mul(n).add(this.publicKey.point))}catch(t){return this._deriveWithNumber(e+1)}return new HDPublicKey({network:this.network,depth:this.depth+1,parentFingerPrint:this.fingerPrint,childIndex:e,chainCode:a,publicKey:s})},HDPublicKey.prototype._deriveFromString=function(e){if(_.includes(e,"'"))throw new hdErrors.InvalidIndexCantDeriveHardened;if(!HDPublicKey.isValidPath(e))throw new hdErrors.InvalidPath(e);return HDPrivateKey._getDerivationIndexes(e).reduce((e,t)=>e._deriveWithNumber(t),this)},HDPublicKey.isValidSerialized=function(e,t){return _.isNull(HDPublicKey.getSerializedError(e,t))},HDPublicKey.getSerializedError=function(e,t){if(!_.isString(e)&&!BufferUtil.isBuffer(e))return new hdErrors.UnrecognizedArgument("expected buffer or string");if(!Base58.validCharacters(e))return new errors.InvalidB58Char("(unknown)",e);try{e=Base58Check.decode(e)}catch(t){return new errors.InvalidB58Checksum(e)}if(e.length!==HDPublicKey.DataSize)return new hdErrors.InvalidLength(e);if(!_.isUndefined(t)){const r=HDPublicKey._validateNetwork(e,t);if(r)return r}const r=BufferUtil.integerFromBuffer(e.slice(0,4));return r===Networks.livenet.xprivkey||r===Networks.testnet.xprivkey?new hdErrors.ArgumentIsPrivateExtended:null},HDPublicKey._validateNetwork=function(e,t){const r=Networks.get(t);if(!r)return new errors.InvalidNetworkArgument(t);const i=e.slice(HDPublicKey.VersionStart,HDPublicKey.VersionEnd);return BufferUtil.integerFromBuffer(i)===r.xpubkey?null:new errors.InvalidNetwork(i)},HDPublicKey.prototype._buildFromPrivate=function(e){const t=_.clone(e._buffers),r=Point.getG().mul(BN.fromBuffer(t.privateKey));return t.publicKey=Point.pointToCompressed(r),t.version=BufferUtil.integerAsBuffer(Networks.get(BufferUtil.integerFromBuffer(t.version)).xpubkey),t.privateKey=void 0,t.checksum=void 0,t.xprivkey=void 0,this._buildFromBuffers(t)},HDPublicKey.prototype._buildFromObject=function(e){let t=_.isString(e.publicKey)?BufferUtil.hexToBuffer(e.publicKey):BufferUtil.isBuffer(e.publicKey)?e.publicKey:e.publicKey.toBuffer();const r={version:e.network?BufferUtil.integerAsBuffer(Networks.get(e.network).xpubkey):e.version,depth:_.isNumber(e.depth)?BufferUtil.integerAsSingleByteBuffer(e.depth):e.depth,parentFingerPrint:_.isNumber(e.parentFingerPrint)?BufferUtil.integerAsBuffer(e.parentFingerPrint):e.parentFingerPrint,childIndex:_.isNumber(e.childIndex)?BufferUtil.integerAsBuffer(e.childIndex):e.childIndex,chainCode:_.isString(e.chainCode)?BufferUtil.hexToBuffer(e.chainCode):e.chainCode,publicKey:t,checksum:_.isNumber(e.checksum)?BufferUtil.integerAsBuffer(e.checksum):e.checksum};return this._buildFromBuffers(r)},HDPublicKey.prototype._buildFromSerialized=function(e){const t=Base58Check.decode(e),r={version:t.slice(HDPublicKey.VersionStart,HDPublicKey.VersionEnd),depth:t.slice(HDPublicKey.DepthStart,HDPublicKey.DepthEnd),parentFingerPrint:t.slice(HDPublicKey.ParentFingerPrintStart,HDPublicKey.ParentFingerPrintEnd),childIndex:t.slice(HDPublicKey.ChildIndexStart,HDPublicKey.ChildIndexEnd),chainCode:t.slice(HDPublicKey.ChainCodeStart,HDPublicKey.ChainCodeEnd),publicKey:t.slice(HDPublicKey.PublicKeyStart,HDPublicKey.PublicKeyEnd),checksum:t.slice(HDPublicKey.ChecksumStart,HDPublicKey.ChecksumEnd),xpubkey:e};return this._buildFromBuffers(r)},HDPublicKey.prototype._buildFromBuffers=function(e){HDPublicKey._validateBufferArguments(e),JSUtil.defineImmutable(this,{_buffers:e});const t=[e.version,e.depth,e.parentFingerPrint,e.childIndex,e.chainCode,e.publicKey],r=BufferUtil.concat(t),i=Base58Check.checksum(r);if(e.checksum&&e.checksum.length){if(e.checksum.toString("hex")!==i.toString("hex"))throw new errors.InvalidB58Checksum(r,i)}else e.checksum=i;const o=Networks.get(BufferUtil.integerFromBuffer(e.version)),n=Base58Check.encode(BufferUtil.concat(t));e.xpubkey=Buffer.from(n);const a=new PublicKey(e.publicKey,{network:o}),s=HDPublicKey.ParentFingerPrintSize,u=Hash.sha256ripemd160(a.toBuffer()).slice(0,s);return JSUtil.defineImmutable(this,{xpubkey:n,network:o,depth:BufferUtil.integerFromSingleByteBuffer(e.depth),publicKey:a,fingerPrint:u}),this},HDPublicKey._validateBufferArguments=function(e){const t=function(t,r){const i=e[t];assert(BufferUtil.isBuffer(i),"".concat(t," argument is not a buffer, it's ").concat(typeof i)),assert(i.length===r,"".concat(t," size unexpected: found ").concat(i.length,", expected ").concat(r))};t("version",HDPublicKey.VersionSize),t("depth",HDPublicKey.DepthSize),t("parentFingerPrint",HDPublicKey.ParentFingerPrintSize),t("childIndex",HDPublicKey.ChildIndexSize),t("chainCode",HDPublicKey.ChainCodeSize),t("publicKey",HDPublicKey.PublicKeySize),e.checksum&&e.checksum.length&&t("checksum",HDPublicKey.CheckSumSize)},HDPublicKey.fromString=function(e){return preconditions.checkArgument(_.isString(e),"No valid string was provided"),new HDPublicKey(e)},HDPublicKey.fromObject=function(e){return preconditions.checkArgument(_.isObject(e),"No valid argument was provided"),new HDPublicKey(e)},HDPublicKey.prototype.toString=function(){return this.xpubkey},HDPublicKey.prototype.inspect=function(){return"<HDPublicKey: ".concat(this.xpubkey,">")},HDPublicKey.prototype.toJSON=function(){return{network:Networks.get(BufferUtil.integerFromBuffer(this._buffers.version)).name,depth:BufferUtil.integerFromSingleByteBuffer(this._buffers.depth),fingerPrint:BufferUtil.integerFromBuffer(this.fingerPrint),parentFingerPrint:BufferUtil.integerFromBuffer(this._buffers.parentFingerPrint),childIndex:BufferUtil.integerFromBuffer(this._buffers.childIndex),chainCode:BufferUtil.bufferToHex(this._buffers.chainCode),publicKey:this.publicKey.toString(),checksum:BufferUtil.integerFromBuffer(this._buffers.checksum),xpubkey:this.xpubkey}},HDPublicKey.prototype.toObject=HDPublicKey.prototype.toJSON,HDPublicKey.fromBuffer=function(e){return new HDPublicKey(e)},HDPublicKey.prototype.toBuffer=function(){return BufferUtil.copy(this._buffers.xpubkey)},HDPublicKey.Hardened=2147483648,HDPublicKey.RootElementAlias=["m","M"],HDPublicKey.VersionSize=4,HDPublicKey.DepthSize=1,HDPublicKey.ParentFingerPrintSize=4,HDPublicKey.ChildIndexSize=4,HDPublicKey.ChainCodeSize=32,HDPublicKey.PublicKeySize=33,HDPublicKey.CheckSumSize=4,HDPublicKey.DataSize=78,HDPublicKey.SerializedByteSize=82,HDPublicKey.VersionStart=0,HDPublicKey.VersionEnd=HDPublicKey.VersionStart+HDPublicKey.VersionSize,HDPublicKey.DepthStart=HDPublicKey.VersionEnd,HDPublicKey.DepthEnd=HDPublicKey.DepthStart+HDPublicKey.DepthSize,HDPublicKey.ParentFingerPrintStart=HDPublicKey.DepthEnd,HDPublicKey.ParentFingerPrintEnd=HDPublicKey.ParentFingerPrintStart+HDPublicKey.ParentFingerPrintSize,HDPublicKey.ChildIndexStart=HDPublicKey.ParentFingerPrintEnd,HDPublicKey.ChildIndexEnd=HDPublicKey.ChildIndexStart+HDPublicKey.ChildIndexSize,HDPublicKey.ChainCodeStart=HDPublicKey.ChildIndexEnd,HDPublicKey.ChainCodeEnd=HDPublicKey.ChainCodeStart+HDPublicKey.ChainCodeSize,HDPublicKey.PublicKeyStart=HDPublicKey.ChainCodeEnd,HDPublicKey.PublicKeyEnd=HDPublicKey.PublicKeyStart+HDPublicKey.PublicKeySize,HDPublicKey.ChecksumStart=HDPublicKey.PublicKeyEnd,HDPublicKey.ChecksumEnd=HDPublicKey.ChecksumStart+HDPublicKey.CheckSumSize,assert(HDPublicKey.PublicKeyEnd===HDPublicKey.DataSize),assert(HDPublicKey.ChecksumEnd===HDPublicKey.SerializedByteSize);const hdErrors$1=errors.HDPrivateKey,MINIMUM_ENTROPY_BITS=128,BITS_TO_BYTES=1/8,MAXIMUM_ENTROPY_BITS=512;function HDPrivateKey(e){if(e instanceof HDPrivateKey)return e;if(!(this instanceof HDPrivateKey))return new HDPrivateKey(e);if(!e)return this._generateRandomly();if(Networks.get(e))return this._generateRandomly(e);if(_.isString(e)||BufferUtil.isBuffer(e))if(HDPrivateKey.isValidSerialized(e))this._buildFromSerialized(e);else if(JSUtil.isValidJSON(e))this._buildFromJSON(e);else{if(!BufferUtil.isBuffer(e)||!HDPrivateKey.isValidSerialized(e.toString()))throw HDPrivateKey.getSerializedError(e);this._buildFromSerialized(e.toString())}else{if(!_.isObject(e))throw new hdErrors$1.UnrecognizedArgument(e);this._buildFromObject(e)}}HDPrivateKey.isValidPath=function(e,t){if(_.isString(e)){const t=HDPrivateKey._getDerivationIndexes(e);return null!==t&&_.every(t,HDPrivateKey.isValidPath)}return!!_.isNumber(e)&&(e<HDPrivateKey.Hardened&&!0===t&&(e+=HDPrivateKey.Hardened),0<=e&&e<HDPrivateKey.MaxIndex)},HDPrivateKey._getDerivationIndexes=function(e){const t=e.split("/");if(_.includes(HDPrivateKey.RootElementAlias,e))return[];if(!_.includes(HDPrivateKey.RootElementAlias,t[0]))return null;const r=t.slice(1).map(e=>{const t="'"===e.slice(-1);if(t&&(e=e.slice(0,-1)),!e||"-"===e[0])return NaN;let r=+e;return t&&(r+=HDPrivateKey.Hardened),r});return _.some(r,Number.isNaN)?null:r},HDPrivateKey.prototype.derive=function(e,t){return this.deriveNonCompliantChild(e,t)},HDPrivateKey.prototype.deriveChild=function(e,t){if(_.isNumber(e))return this._deriveWithNumber(e,t);if(_.isString(e))return this._deriveFromString(e);throw new hdErrors$1.InvalidDerivationArgument(e)},HDPrivateKey.prototype.deriveNonCompliantChild=function(e,t){if(_.isNumber(e))return this._deriveWithNumber(e,t,!0);if(_.isString(e))return this._deriveFromString(e,!0);throw new hdErrors$1.InvalidDerivationArgument(e)},HDPrivateKey.prototype._deriveWithNumber=function(e,t,r){if(!HDPrivateKey.isValidPath(e,t))throw new hdErrors$1.InvalidPath(e);t=!!(e>=HDPrivateKey.Hardened)||t,e<HDPrivateKey.Hardened&&!0===t&&(e+=HDPrivateKey.Hardened);const i=BufferUtil.integerAsBuffer(e);let o;if(t&&r){const e=this.privateKey.bn.toBuffer();o=BufferUtil.concat([Buffer.from([0]),e,i])}else if(t){const e=this.privateKey.bn.toBuffer({size:32});assert(32===e.length,"private key buffer is expected to be 32 bytes"),o=BufferUtil.concat([Buffer.from([0]),e,i])}else o=BufferUtil.concat([this.publicKey.toBuffer(),i]);const n=Hash.sha512hmac(o,this._buffers.chainCode),a=BN.fromBuffer(n.slice(0,32),{size:32}),s=n.slice(32,64),u=a.add(this.privateKey.toBigNumber()).umod(Point.getN()).toBuffer({size:32});return PrivateKey.isValid(u)?new HDPrivateKey({network:this.network,depth:this.depth+1,parentFingerPrint:this.fingerPrint,childIndex:e,chainCode:s,privateKey:u}):this._deriveWithNumber(e+1,null,r)},HDPrivateKey.prototype._deriveFromString=function(e,t){if(!HDPrivateKey.isValidPath(e))throw new hdErrors$1.InvalidPath(e);return HDPrivateKey._getDerivationIndexes(e).reduce((e,r)=>e._deriveWithNumber(r,null,t),this)},HDPrivateKey.isValidSerialized=function(e,t){return!HDPrivateKey.getSerializedError(e,t)},HDPrivateKey.getSerializedError=function(e,t){if(!_.isString(e)&&!BufferUtil.isBuffer(e))return new hdErrors$1.UnrecognizedArgument("Expected string or buffer");if(!Base58.validCharacters(e))return new errors.InvalidB58Char("(unknown)",e);try{e=Base58Check.decode(e)}catch(t){return new errors.InvalidB58Checksum(e)}if(e.length!==HDPrivateKey.DataLength)return new hdErrors$1.InvalidLength(e);if(!_.isUndefined(t)){const r=HDPrivateKey._validateNetwork(e,t);if(r)return r}return null},HDPrivateKey._validateNetwork=function(e,t){const r=Networks.get(t);if(!r)return new errors.InvalidNetworkArgument(t);const i=e.slice(0,4);return BufferUtil.integerFromBuffer(i)===r.xprivkey?null:new errors.InvalidNetwork(i)},HDPrivateKey.fromString=function(e){return preconditions.checkArgument(_.isString(e),"No valid string was provided"),new HDPrivateKey(e)},HDPrivateKey.fromObject=function(e){return preconditions.checkArgument(_.isObject(e),"No valid argument was provided"),new HDPrivateKey(e)},HDPrivateKey.prototype._buildFromJSON=function(e){return this._buildFromObject(JSON.parse(e))},HDPrivateKey.prototype._buildFromObject=function(e){let t;e.checksum&&(t=e.checksum.length?e.checksum:BufferUtil.integerAsBuffer(e.checksum));const r={version:e.network?BufferUtil.integerAsBuffer(Networks.get(e.network).xprivkey):e.version,depth:_.isNumber(e.depth)?BufferUtil.integerAsSingleByteBuffer(e.depth):e.depth,parentFingerPrint:_.isNumber(e.parentFingerPrint)?BufferUtil.integerAsBuffer(e.parentFingerPrint):e.parentFingerPrint,childIndex:_.isNumber(e.childIndex)?BufferUtil.integerAsBuffer(e.childIndex):e.childIndex,chainCode:_.isString(e.chainCode)?BufferUtil.hexToBuffer(e.chainCode):e.chainCode,privateKey:_.isString(e.privateKey)&&JSUtil.isHexa(e.privateKey)?BufferUtil.hexToBuffer(e.privateKey):e.privateKey,checksum:t};return this._buildFromBuffers(r)},HDPrivateKey.prototype._buildFromSerialized=function(e){const t=Base58Check.decode(e),r={version:t.slice(HDPrivateKey.VersionStart,HDPrivateKey.VersionEnd),depth:t.slice(HDPrivateKey.DepthStart,HDPrivateKey.DepthEnd),parentFingerPrint:t.slice(HDPrivateKey.ParentFingerPrintStart,HDPrivateKey.ParentFingerPrintEnd),childIndex:t.slice(HDPrivateKey.ChildIndexStart,HDPrivateKey.ChildIndexEnd),chainCode:t.slice(HDPrivateKey.ChainCodeStart,HDPrivateKey.ChainCodeEnd),privateKey:t.slice(HDPrivateKey.PrivateKeyStart,HDPrivateKey.PrivateKeyEnd),checksum:t.slice(HDPrivateKey.ChecksumStart,HDPrivateKey.ChecksumEnd),xprivkey:e};return this._buildFromBuffers(r)},HDPrivateKey.prototype._generateRandomly=function(e){return HDPrivateKey.fromSeed(Random.getRandomBuffer(64),e)},HDPrivateKey.fromSeed=function(e,t){if(JSUtil.isHexaString(e)&&(e=BufferUtil.hexToBuffer(e)),!Buffer.isBuffer(e))throw new hdErrors$1.InvalidEntropyArgument(e);if(e.length<16)throw new hdErrors$1.InvalidEntropyArgument.NotEnoughEntropy(e);if(e.length>64)throw new hdErrors$1.InvalidEntropyArgument.TooMuchEntropy(e);const r=Hash.sha512hmac(e,Buffer.from("Bitcoin seed"));return new HDPrivateKey({network:Networks.get(t)||Networks.defaultNetwork,depth:0,parentFingerPrint:0,childIndex:0,privateKey:r.slice(0,32),chainCode:r.slice(32,64)})},HDPrivateKey.prototype._calcHDPublicKey=function(){this._hdPublicKey||(this._hdPublicKey=new HDPublicKey(this))},HDPrivateKey.prototype._buildFromBuffers=function(e){HDPrivateKey._validateBufferArguments(e),JSUtil.defineImmutable(this,{_buffers:e});const t=[e.version,e.depth,e.parentFingerPrint,e.childIndex,e.chainCode,BufferUtil.emptyBuffer(1),e.privateKey],r=Buffer.concat(t);if(e.checksum&&e.checksum.length){if(e.checksum.toString()!==Base58Check.checksum(r).toString())throw new errors.InvalidB58Checksum(r)}else e.checksum=Base58Check.checksum(r);const i=Networks.get(BufferUtil.integerFromBuffer(e.version)),o=Base58Check.encode(Buffer.concat(t));e.xprivkey=Buffer.from(o);const n=new PrivateKey(BN.fromBuffer(e.privateKey),i),a=n.toPublicKey(),s=HDPrivateKey.ParentFingerPrintSize,u=Hash.sha256ripemd160(a.toBuffer()).slice(0,s);return JSUtil.defineImmutable(this,{xprivkey:o,network:i,depth:BufferUtil.integerFromSingleByteBuffer(e.depth),privateKey:n,publicKey:a,fingerPrint:u}),this._hdPublicKey=null,Object.defineProperty(this,"hdPublicKey",{configurable:!1,enumerable:!0,get(){return this._calcHDPublicKey(),this._hdPublicKey}}),Object.defineProperty(this,"xpubkey",{configurable:!1,enumerable:!0,get(){return this._calcHDPublicKey(),this._hdPublicKey.xpubkey}}),this},HDPrivateKey._validateBufferArguments=function(e){const t=function(t,r){const i=e[t];assert(BufferUtil.isBuffer(i),"".concat(t," argument is not a buffer")),assert(i.length===r,"".concat(t," size unexpected: found ").concat(i.length,", expected ").concat(r))};t("version",HDPrivateKey.VersionSize),t("depth",HDPrivateKey.DepthSize),t("parentFingerPrint",HDPrivateKey.ParentFingerPrintSize),t("childIndex",HDPrivateKey.ChildIndexSize),t("chainCode",HDPrivateKey.ChainCodeSize),t("privateKey",HDPrivateKey.PrivateKeySize),e.checksum&&e.checksum.length&&t("checksum",HDPrivateKey.CheckSumSize)},HDPrivateKey.prototype.toString=function(){return this.xprivkey},HDPrivateKey.prototype.toJSON=function(){return{network:Networks.get(BufferUtil.integerFromBuffer(this._buffers.version),"xprivkey").name,depth:BufferUtil.integerFromSingleByteBuffer(this._buffers.depth),fingerPrint:BufferUtil.integerFromBuffer(this.fingerPrint),parentFingerPrint:BufferUtil.integerFromBuffer(this._buffers.parentFingerPrint),childIndex:BufferUtil.integerFromBuffer(this._buffers.childIndex),chainCode:BufferUtil.bufferToHex(this._buffers.chainCode),privateKey:this.privateKey.toBuffer().toString("hex"),checksum:BufferUtil.integerFromBuffer(this._buffers.checksum),xprivkey:this.xprivkey}},HDPrivateKey.prototype.toObject=HDPrivateKey.prototype.toJSON,HDPrivateKey.fromBuffer=function(e){return new HDPrivateKey(e.toString())},HDPrivateKey.prototype.toBuffer=function(){return BufferUtil.copy(this._buffers.xprivkey)},HDPrivateKey.DefaultDepth=0,HDPrivateKey.DefaultFingerprint=0,HDPrivateKey.DefaultChildIndex=0,HDPrivateKey.Hardened=2147483648,HDPrivateKey.MaxIndex=2*HDPrivateKey.Hardened,HDPrivateKey.RootElementAlias=["m","M","m'","M'"],HDPrivateKey.VersionSize=4,HDPrivateKey.DepthSize=1,HDPrivateKey.ParentFingerPrintSize=4,HDPrivateKey.ChildIndexSize=4,HDPrivateKey.ChainCodeSize=32,HDPrivateKey.PrivateKeySize=32,HDPrivateKey.CheckSumSize=4,HDPrivateKey.DataLength=78,HDPrivateKey.SerializedByteSize=82,HDPrivateKey.VersionStart=0,HDPrivateKey.VersionEnd=HDPrivateKey.VersionStart+HDPrivateKey.VersionSize,HDPrivateKey.DepthStart=HDPrivateKey.VersionEnd,HDPrivateKey.DepthEnd=HDPrivateKey.DepthStart+HDPrivateKey.DepthSize,HDPrivateKey.ParentFingerPrintStart=HDPrivateKey.DepthEnd,HDPrivateKey.ParentFingerPrintEnd=HDPrivateKey.ParentFingerPrintStart+HDPrivateKey.ParentFingerPrintSize,HDPrivateKey.ChildIndexStart=HDPrivateKey.ParentFingerPrintEnd,HDPrivateKey.ChildIndexEnd=HDPrivateKey.ChildIndexStart+HDPrivateKey.ChildIndexSize,HDPrivateKey.ChainCodeStart=HDPrivateKey.ChildIndexEnd,HDPrivateKey.ChainCodeEnd=HDPrivateKey.ChainCodeStart+HDPrivateKey.ChainCodeSize,HDPrivateKey.PrivateKeyStart=HDPrivateKey.ChainCodeEnd+1,HDPrivateKey.PrivateKeyEnd=HDPrivateKey.PrivateKeyStart+HDPrivateKey.PrivateKeySize,HDPrivateKey.ChecksumStart=HDPrivateKey.PrivateKeyEnd,HDPrivateKey.ChecksumEnd=HDPrivateKey.ChecksumStart+HDPrivateKey.CheckSumSize,assert(HDPrivateKey.ChecksumEnd===HDPrivateKey.SerializedByteSize);class MerkleBlock{constructor(e){if(!(this instanceof MerkleBlock))return new MerkleBlock(e);let t={};if(BufferUtil.isBuffer(e))t=MerkleBlock._fromBufferReader(BufferReader(e));else{if(!_.isObject(e))throw new TypeError("Unrecognized argument for MerkleBlock");{let r;t={header:r=e.header instanceof BlockHeader?e.header:BlockHeader.fromObject(e.header),numTransactions:e.numTransactions,hashes:e.hashes,flags:e.flags}}}return _.extend(this,t),this._flagBitsUsed=0,this._hashesUsed=0,this}static fromBuffer(e){return MerkleBlock.fromBufferReader(BufferReader(e))}static fromBufferReader(e){return new MerkleBlock(MerkleBlock._fromBufferReader(e))}toBuffer(){return this.toBufferWriter().concat()}toBufferWriter(e){let t;for(e||(e=new BufferWriter),e.write(this.header.toBuffer()),e.writeUInt32LE(this.numTransactions),e.writeVarintNum(this.hashes.length),t=0;t<this.hashes.length;t+=1)e.write(Buffer.from(this.hashes[t],"hex"));for(e.writeVarintNum(this.flags.length),t=0;t<this.flags.length;t+=1)e.writeUInt8(this.flags[t]);return e}toJSON(){return{header:this.header.toObject(),numTransactions:this.numTransactions,hashes:this.hashes,flags:this.flags}}toObject(){return this.toJSON()}validMerkleTree(){if(preconditions.checkState(_.isArray(this.flags),"MerkleBlock flags is not an array"),preconditions.checkState(_.isArray(this.hashes),"MerkleBlock hashes is not an array"),this.hashes.length>this.numTransactions)return!1;if(8*this.flags.length<this.hashes.length)return!1;const e=this._calcTreeHeight(),t={hashesUsed:0,flagBitsUsed:0},r=this._traverseMerkleTree(e,0,t);return t.hashesUsed===this.hashes.length&&BufferUtil.equals(r,this.header.merkleRoot)}_traverseMerkleTree(e,t,r){if((r=r||{}).txs=r.txs||[],r.flagBitsUsed=r.flagBitsUsed||0,r.hashesUsed=r.hashesUsed||0,r.flagBitsUsed>8*this.flags.length)return null;const i=1&this.flags[r.flagBitsUsed>>3]>>>(7&r.flagBitsUsed);if(r.flagBitsUsed+=1,0===e||!i){if(r.hashesUsed>=this.hashes.length)return null;const t=this.hashes[r.hashesUsed];return r.hashesUsed+=1,0===e&&i&&r.txs.push(t),Buffer.from(t,"hex")}const o=this._traverseMerkleTree(e-1,2*t,r);let n=o;return 2*t+1<this._calcTreeWidth(e-1)&&(n=this._traverseMerkleTree(e-1,2*t+1,r)),Hash.sha256sha256(Buffer.concat([o,n]))}_calcTreeWidth(e){return this.numTransactions+(1<<e)-1>>e}_calcTreeHeight(){let e=0;for(;1<this._calcTreeWidth(e);)e+=1;return e}hasTransaction(e){preconditions.checkArgument(!_.isUndefined(e),"tx cannot be undefined"),preconditions.checkArgument(e instanceof Transaction||"string"==typeof e,'Invalid tx given, tx must be a "string" or "Transaction"');let t=e;e instanceof Transaction&&(t=BufferUtil.reverse(Buffer.from(e.id,"hex")).toString("hex"));const r=[],i=this._calcTreeHeight();return this._traverseMerkleTree(i,0,{txs:r}),-1!==r.indexOf(t)}static _fromBufferReader(e){let t;preconditions.checkState(!e.finished(),"No merkleblock data received");const r={header:BlockHeader.fromBufferReader(e),numTransactions:e.readUInt32LE()},i=e.readVarintNum();for(r.hashes=[],t=0;t<i;t+=1)r.hashes.push(e.read(32).toString("hex"));const o=e.readVarintNum();for(r.flags=[],t=0;t<o;t+=1)r.flags.push(e.readUInt8());return r}static fromObject(e){return new MerkleBlock(e)}}class Message{constructor(e){return preconditions.checkArgument(_.isString(e),"First argument should be a string"),this.message=e,this}magicHash(){const e=BufferWriter.varintBufNum(Message.MAGIC_BYTES.length),t=Buffer.from(this.message),r=BufferWriter.varintBufNum(t.length),i=Buffer.concat([e,Message.MAGIC_BYTES,r,t]);return Hash.sha256sha256(i)}_sign(e){preconditions.checkArgument(e instanceof PrivateKey,"First argument should be a PrivateKey");const t=this.magicHash(),r=new ECDSA;return r.hashbuf=t,r.privkey=e,r.pubkey=e.toPublicKey(),r.signRandomK(),r.calci(),r.sig}sign(e){return this._sign(e).toCompact().toString("base64")}_verify(e,t){preconditions.checkArgument(e instanceof PublicKey,"First argument should be a PublicKey"),preconditions.checkArgument(t instanceof Signature,"Second argument should be a Signature");const r=this.magicHash(),i=ECDSA.verify(r,t,e);return i||(this.error="The signature was invalid"),i}verify(e,t){preconditions.checkArgument(e),preconditions.checkArgument(t&&_.isString(t)),_.isString(e)&&(e=Address.fromString(e));const r=Signature.fromCompact(Buffer.from(t,"base64")),i=new ECDSA;i.hashbuf=this.magicHash(),i.sig=r;const o=i.toPublicKey(),n=Address.fromPublicKey(o,e.network);return e.toString()===n.toString()?this._verify(o,r):(this.error="The signature did not match the message digest",!1)}static fromString(e){return new Message(e)}static fromJSON(e){return JSUtil.isValidJSON(e)&&(e=JSON.parse(e)),new Message(e.message)}toObject(){return{message:this.message}}toJSON(){return JSON.stringify(this.toObject())}toString(){return this.message}inspect(){return"<Message: ".concat(this.toString(),">")}}function pbkdf2(e,t,r,i){if(i>274877906880)throw Error("Requested key length too long");if("string"!=typeof e&&!Buffer.isBuffer(e))throw new TypeError("key must a string or Buffer");if("string"!=typeof t&&!Buffer.isBuffer(t))throw new TypeError("salt must a string or Buffer");"string"==typeof e&&(e=Buffer.from(e)),"string"==typeof t&&(t=Buffer.from(t));const o=Buffer.alloc(i);let n=Buffer.alloc(64);const a=Buffer.alloc(64),s=Buffer.alloc(t.length+4),u=Math.ceil(i/64);t.copy(s,0,0,t.length);for(let c=1;c<=u;c+=1){s[t.length+0]=255&c>>24,s[t.length+1]=255&c>>16,s[t.length+2]=255&c>>8,s[t.length+3]=255&c>>0;const l=hash.hmac(hash.sha512,e).update(s).digest();(n=Buffer.from(l)).copy(a,0,0,64);for(let t=1;t<r;t+=1){const t=hash.hmac(hash.sha512,e).update(n).digest();n=Buffer.from(t);for(let e=0;e<64;e+=1)a[e]^=n[e]}const p=64*(c-1),h=c===u?i-64*(u-1):64;a.copy(o,p,0,h)}return o}Message.MAGIC_BYTES=Buffer.from("Bitcoin Signed Message:\n");var CHINESE=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],ENGLISH=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"],FRENCH=["abaisser","abandon","abdiquer","abeille","abolir","aborder","aboutir","aboyer","abrasif","abreuver","abriter","abroger","abrupt","absence","absolu","absurde","abusif","abyssal","academie","acajou","acarien","accabler","accepter","acclamer","accolade","accroche","accuser","acerbe","achat","acheter","aciduler","acier","acompte","acquerir","acronyme","acteur","actif","actuel","adepte","adequat","adhesif","adjectif","adjuger","admettre","admirer","adopter","adorer","adoucir","adresse","adroit","adulte","adverbe","aerer","aeronef","affaire","affecter","affiche","affreux","affubler","agacer","agencer","agile","agiter","agrafer","agreable","agrume","aider","aiguille","ailier","aimable","aisance","ajouter","ajuster","alarmer","alchimie","alerte","algebre","algue","aliener","aliment","alleger","alliage","allouer","allumer","alourdir","alpaga","altesse","alveole","amateur","ambigu","ambre","amenager","amertume","amidon","amiral","amorcer","amour","amovible","amphibie","ampleur","amusant","analyse","anaphore","anarchie","anatomie","ancien","aneantir","angle","angoisse","anguleux","animal","annexer","annonce","annuel","anodin","anomalie","anonyme","anormal","antenne","antidote","anxieux","apaiser","aperitif","aplanir","apologie","appareil","appeler","apporter","appuyer","aquarium","aqueduc","arbitre","arbuste","ardeur","ardoise","argent","arlequin","armature","armement","armoire","armure","arpenter","arracher","arriver","arroser","arsenic","arteriel","article","aspect","asphalte","aspirer","assaut","asservir","assiette","associer","assurer","asticot","astre","astuce","atelier","atome","atrium","atroce","attaque","attentif","attirer","attraper","aubaine","auberge","audace","audible","augurer","aurore","automne","autruche","avaler","avancer","avarice","avenir","averse","aveugle","aviateur","avide","avion","aviser","avoine","avouer","avril","axial","axiome","badge","bafouer","bagage","baguette","baignade","balancer","balcon","baleine","balisage","bambin","bancaire","bandage","banlieue","banniere","banquier","barbier","baril","baron","barque","barrage","bassin","bastion","bataille","bateau","batterie","baudrier","bavarder","belette","belier","belote","benefice","berceau","berger","berline","bermuda","besace","besogne","betail","beurre","biberon","bicycle","bidule","bijou","bilan","bilingue","billard","binaire","biologie","biopsie","biotype","biscuit","bison","bistouri","bitume","bizarre","blafard","blague","blanchir","blessant","blinder","blond","bloquer","blouson","bobard","bobine","boire","boiser","bolide","bonbon","bondir","bonheur","bonifier","bonus","bordure","borne","botte","boucle","boueux","bougie","boulon","bouquin","bourse","boussole","boutique","boxeur","branche","brasier","brave","brebis","breche","breuvage","bricoler","brigade","brillant","brioche","brique","brochure","broder","bronzer","brousse","broyeur","brume","brusque","brutal","bruyant","buffle","buisson","bulletin","bureau","burin","bustier","butiner","butoir","buvable","buvette","cabanon","cabine","cachette","cadeau","cadre","cafeine","caillou","caisson","calculer","calepin","calibre","calmer","calomnie","calvaire","camarade","camera","camion","campagne","canal","caneton","canon","cantine","canular","capable","caporal","caprice","capsule","capter","capuche","carabine","carbone","caresser","caribou","carnage","carotte","carreau","carton","cascade","casier","casque","cassure","causer","caution","cavalier","caverne","caviar","cedille","ceinture","celeste","cellule","cendrier","censurer","central","cercle","cerebral","cerise","cerner","cerveau","cesser","chagrin","chaise","chaleur","chambre","chance","chapitre","charbon","chasseur","chaton","chausson","chavirer","chemise","chenille","chequier","chercher","cheval","chien","chiffre","chignon","chimere","chiot","chlorure","chocolat","choisir","chose","chouette","chrome","chute","cigare","cigogne","cimenter","cinema","cintrer","circuler","cirer","cirque","citerne","citoyen","citron","civil","clairon","clameur","claquer","classe","clavier","client","cligner","climat","clivage","cloche","clonage","cloporte","cobalt","cobra","cocasse","cocotier","coder","codifier","coffre","cogner","cohesion","coiffer","coincer","colere","colibri","colline","colmater","colonel","combat","comedie","commande","compact","concert","conduire","confier","congeler","connoter","consonne","contact","convexe","copain","copie","corail","corbeau","cordage","corniche","corpus","correct","cortege","cosmique","costume","coton","coude","coupure","courage","couteau","couvrir","coyote","crabe","crainte","cravate","crayon","creature","crediter","cremeux","creuser","crevette","cribler","crier","cristal","critere","croire","croquer","crotale","crucial","cruel","crypter","cubique","cueillir","cuillere","cuisine","cuivre","culminer","cultiver","cumuler","cupide","curatif","curseur","cyanure","cycle","cylindre","cynique","daigner","damier","danger","danseur","dauphin","debattre","debiter","deborder","debrider","debutant","decaler","decembre","dechirer","decider","declarer","decorer","decrire","decupler","dedale","deductif","deesse","defensif","defiler","defrayer","degager","degivrer","deglutir","degrafer","dejeuner","delice","deloger","demander","demeurer","demolir","denicher","denouer","dentelle","denuder","depart","depenser","dephaser","deplacer","deposer","deranger","derober","desastre","descente","desert","designer","desobeir","dessiner","destrier","detacher","detester","detourer","detresse","devancer","devenir","deviner","devoir","diable","dialogue","diamant","dicter","differer","digerer","digital","digne","diluer","dimanche","diminuer","dioxyde","directif","diriger","discuter","disposer","dissiper","distance","divertir","diviser","docile","docteur","dogme","doigt","domaine","domicile","dompter","donateur","donjon","donner","dopamine","dortoir","dorure","dosage","doseur","dossier","dotation","douanier","double","douceur","douter","doyen","dragon","draper","dresser","dribbler","droiture","duperie","duplexe","durable","durcir","dynastie","eblouir","ecarter","echarpe","echelle","eclairer","eclipse","eclore","ecluse","ecole","economie","ecorce","ecouter","ecraser","ecremer","ecrivain","ecrou","ecume","ecureuil","edifier","eduquer","effacer","effectif","effigie","effort","effrayer","effusion","egaliser","egarer","ejecter","elaborer","elargir","electron","elegant","elephant","eleve","eligible","elitisme","eloge","elucider","eluder","emballer","embellir","embryon","emeraude","emission","emmener","emotion","emouvoir","empereur","employer","emporter","emprise","emulsion","encadrer","enchere","enclave","encoche","endiguer","endosser","endroit","enduire","energie","enfance","enfermer","enfouir","engager","engin","englober","enigme","enjamber","enjeu","enlever","ennemi","ennuyeux","enrichir","enrobage","enseigne","entasser","entendre","entier","entourer","entraver","enumerer","envahir","enviable","envoyer","enzyme","eolien","epaissir","epargne","epatant","epaule","epicerie","epidemie","epier","epilogue","epine","episode","epitaphe","epoque","epreuve","eprouver","epuisant","equerre","equipe","eriger","erosion","erreur","eruption","escalier","espadon","espece","espiegle","espoir","esprit","esquiver","essayer","essence","essieu","essorer","estime","estomac","estrade","etagere","etaler","etanche","etatique","eteindre","etendoir","eternel","ethanol","ethique","ethnie","etirer","etoffer","etoile","etonnant","etourdir","etrange","etroit","etude","euphorie","evaluer","evasion","eventail","evidence","eviter","evolutif","evoquer","exact","exagerer","exaucer","exceller","excitant","exclusif","excuse","executer","exemple","exercer","exhaler","exhorter","exigence","exiler","exister","exotique","expedier","explorer","exposer","exprimer","exquis","extensif","extraire","exulter","fable","fabuleux","facette","facile","facture","faiblir","falaise","fameux","famille","farceur","farfelu","farine","farouche","fasciner","fatal","fatigue","faucon","fautif","faveur","favori","febrile","feconder","federer","felin","femme","femur","fendoir","feodal","fermer","feroce","ferveur","festival","feuille","feutre","fevrier","fiasco","ficeler","fictif","fidele","figure","filature","filetage","filiere","filleul","filmer","filou","filtrer","financer","finir","fiole","firme","fissure","fixer","flairer","flamme","flasque","flatteur","fleau","fleche","fleur","flexion","flocon","flore","fluctuer","fluide","fluvial","folie","fonderie","fongible","fontaine","forcer","forgeron","formuler","fortune","fossile","foudre","fougere","fouiller","foulure","fourmi","fragile","fraise","franchir","frapper","frayeur","fregate","freiner","frelon","fremir","frenesie","frere","friable","friction","frisson","frivole","froid","fromage","frontal","frotter","fruit","fugitif","fuite","fureur","furieux","furtif","fusion","futur","gagner","galaxie","galerie","gambader","garantir","gardien","garnir","garrigue","gazelle","gazon","geant","gelatine","gelule","gendarme","general","genie","genou","gentil","geologie","geometre","geranium","germe","gestuel","geyser","gibier","gicler","girafe","givre","glace","glaive","glisser","globe","gloire","glorieux","golfeur","gomme","gonfler","gorge","gorille","goudron","gouffre","goulot","goupille","gourmand","goutte","graduel","graffiti","graine","grand","grappin","gratuit","gravir","grenat","griffure","griller","grimper","grogner","gronder","grotte","groupe","gruger","grutier","gruyere","guepard","guerrier","guide","guimauve","guitare","gustatif","gymnaste","gyrostat","habitude","hachoir","halte","hameau","hangar","hanneton","haricot","harmonie","harpon","hasard","helium","hematome","herbe","herisson","hermine","heron","hesiter","heureux","hiberner","hibou","hilarant","histoire","hiver","homard","hommage","homogene","honneur","honorer","honteux","horde","horizon","horloge","hormone","horrible","houleux","housse","hublot","huileux","humain","humble","humide","humour","hurler","hydromel","hygiene","hymne","hypnose","idylle","ignorer","iguane","illicite","illusion","image","imbiber","imiter","immense","immobile","immuable","impact","imperial","implorer","imposer","imprimer","imputer","incarner","incendie","incident","incliner","incolore","indexer","indice","inductif","inedit","ineptie","inexact","infini","infliger","informer","infusion","ingerer","inhaler","inhiber","injecter","injure","innocent","inoculer","inonder","inscrire","insecte","insigne","insolite","inspirer","instinct","insulter","intact","intense","intime","intrigue","intuitif","inutile","invasion","inventer","inviter","invoquer","ironique","irradier","irreel","irriter","isoler","ivoire","ivresse","jaguar","jaillir","jambe","janvier","jardin","jauger","jaune","javelot","jetable","jeton","jeudi","jeunesse","joindre","joncher","jongler","joueur","jouissif","journal","jovial","joyau","joyeux","jubiler","jugement","junior","jupon","juriste","justice","juteux","juvenile","kayak","kimono","kiosque","label","labial","labourer","lacerer","lactose","lagune","laine","laisser","laitier","lambeau","lamelle","lampe","lanceur","langage","lanterne","lapin","largeur","larme","laurier","lavabo","lavoir","lecture","legal","leger","legume","lessive","lettre","levier","lexique","lezard","liasse","liberer","libre","licence","licorne","liege","lievre","ligature","ligoter","ligue","limer","limite","limonade","limpide","lineaire","lingot","lionceau","liquide","lisiere","lister","lithium","litige","littoral","livreur","logique","lointain","loisir","lombric","loterie","louer","lourd","loutre","louve","loyal","lubie","lucide","lucratif","lueur","lugubre","luisant","lumiere","lunaire","lundi","luron","lutter","luxueux","machine","magasin","magenta","magique","maigre","maillon","maintien","mairie","maison","majorer","malaxer","malefice","malheur","malice","mallette","mammouth","mandater","maniable","manquant","manteau","manuel","marathon","marbre","marchand","mardi","maritime","marqueur","marron","marteler","mascotte","massif","materiel","matiere","matraque","maudire","maussade","mauve","maximal","mechant","meconnu","medaille","medecin","mediter","meduse","meilleur","melange","melodie","membre","memoire","menacer","mener","menhir","mensonge","mentor","mercredi","merite","merle","messager","mesure","metal","meteore","methode","metier","meuble","miauler","microbe","miette","mignon","migrer","milieu","million","mimique","mince","mineral","minimal","minorer","minute","miracle","miroiter","missile","mixte","mobile","moderne","moelleux","mondial","moniteur","monnaie","monotone","monstre","montagne","monument","moqueur","morceau","morsure","mortier","moteur","motif","mouche","moufle","moulin","mousson","mouton","mouvant","multiple","munition","muraille","murene","murmure","muscle","museum","musicien","mutation","muter","mutuel","myriade","myrtille","mystere","mythique","nageur","nappe","narquois","narrer","natation","nation","nature","naufrage","nautique","navire","nebuleux","nectar","nefaste","negation","negliger","negocier","neige","nerveux","nettoyer","neurone","neutron","neveu","niche","nickel","nitrate","niveau","noble","nocif","nocturne","noirceur","noisette","nomade","nombreux","nommer","normatif","notable","notifier","notoire","nourrir","nouveau","novateur","novembre","novice","nuage","nuancer","nuire","nuisible","numero","nuptial","nuque","nutritif","obeir","objectif","obliger","obscur","observer","obstacle","obtenir","obturer","occasion","occuper","ocean","octobre","octroyer","octupler","oculaire","odeur","odorant","offenser","officier","offrir","ogive","oiseau","oisillon","olfactif","olivier","ombrage","omettre","onctueux","onduler","onereux","onirique","opale","opaque","operer","opinion","opportun","opprimer","opter","optique","orageux","orange","orbite","ordonner","oreille","organe","orgueil","orifice","ornement","orque","ortie","osciller","osmose","ossature","otarie","ouragan","ourson","outil","outrager","ouvrage","ovation","oxyde","oxygene","ozone","paisible","palace","palmares","palourde","palper","panache","panda","pangolin","paniquer","panneau","panorama","pantalon","papaye","papier","papoter","papyrus","paradoxe","parcelle","paresse","parfumer","parler","parole","parrain","parsemer","partager","parure","parvenir","passion","pasteque","paternel","patience","patron","pavillon","pavoiser","payer","paysage","peigne","peintre","pelage","pelican","pelle","pelouse","peluche","pendule","penetrer","penible","pensif","penurie","pepite","peplum","perdrix","perforer","periode","permuter","perplexe","persil","perte","peser","petale","petit","petrir","peuple","pharaon","phobie","phoque","photon","phrase","physique","piano","pictural","piece","pierre","pieuvre","pilote","pinceau","pipette","piquer","pirogue","piscine","piston","pivoter","pixel","pizza","placard","plafond","plaisir","planer","plaque","plastron","plateau","pleurer","plexus","pliage","plomb","plonger","pluie","plumage","pochette","poesie","poete","pointe","poirier","poisson","poivre","polaire","policier","pollen","polygone","pommade","pompier","ponctuel","ponderer","poney","portique","position","posseder","posture","potager","poteau","potion","pouce","poulain","poumon","pourpre","poussin","pouvoir","prairie","pratique","precieux","predire","prefixe","prelude","prenom","presence","pretexte","prevoir","primitif","prince","prison","priver","probleme","proceder","prodige","profond","progres","proie","projeter","prologue","promener","propre","prospere","proteger","prouesse","proverbe","prudence","pruneau","psychose","public","puceron","puiser","pulpe","pulsar","punaise","punitif","pupitre","purifier","puzzle","pyramide","quasar","querelle","question","quietude","quitter","quotient","racine","raconter","radieux","ragondin","raideur","raisin","ralentir","rallonge","ramasser","rapide","rasage","ratisser","ravager","ravin","rayonner","reactif","reagir","realiser","reanimer","recevoir","reciter","reclamer","recolter","recruter","reculer","recycler","rediger","redouter","refaire","reflexe","reformer","refrain","refuge","regalien","region","reglage","regulier","reiterer","rejeter","rejouer","relatif","relever","relief","remarque","remede","remise","remonter","remplir","remuer","renard","renfort","renifler","renoncer","rentrer","renvoi","replier","reporter","reprise","reptile","requin","reserve","resineux","resoudre","respect","rester","resultat","retablir","retenir","reticule","retomber","retracer","reunion","reussir","revanche","revivre","revolte","revulsif","richesse","rideau","rieur","rigide","rigoler","rincer","riposter","risible","risque","rituel","rival","riviere","rocheux","romance","rompre","ronce","rondin","roseau","rosier","rotatif","rotor","rotule","rouge","rouille","rouleau","routine","royaume","ruban","rubis","ruche","ruelle","rugueux","ruiner","ruisseau","ruser","rustique","rythme","sabler","saboter","sabre","sacoche","safari","sagesse","saisir","salade","salive","salon","saluer","samedi","sanction","sanglier","sarcasme","sardine","saturer","saugrenu","saumon","sauter","sauvage","savant","savonner","scalpel","scandale","scelerat","scenario","sceptre","schema","science","scinder","score","scrutin","sculpter","seance","secable","secher","secouer","secreter","sedatif","seduire","seigneur","sejour","selectif","semaine","sembler","semence","seminal","senateur","sensible","sentence","separer","sequence","serein","sergent","serieux","serrure","serum","service","sesame","sevir","sevrage","sextuple","sideral","siecle","sieger","siffler","sigle","signal","silence","silicium","simple","sincere","sinistre","siphon","sirop","sismique","situer","skier","social","socle","sodium","soigneux","soldat","soleil","solitude","soluble","sombre","sommeil","somnoler","sonde","songeur","sonnette","sonore","sorcier","sortir","sosie","sottise","soucieux","soudure","souffle","soulever","soupape","source","soutirer","souvenir","spacieux","spatial","special","sphere","spiral","stable","station","sternum","stimulus","stipuler","strict","studieux","stupeur","styliste","sublime","substrat","subtil","subvenir","succes","sucre","suffixe","suggerer","suiveur","sulfate","superbe","supplier","surface","suricate","surmener","surprise","sursaut","survie","suspect","syllabe","symbole","symetrie","synapse","syntaxe","systeme","tabac","tablier","tactile","tailler","talent","talisman","talonner","tambour","tamiser","tangible","tapis","taquiner","tarder","tarif","tartine","tasse","tatami","tatouage","taupe","taureau","taxer","temoin","temporel","tenaille","tendre","teneur","tenir","tension","terminer","terne","terrible","tetine","texte","theme","theorie","therapie","thorax","tibia","tiede","timide","tirelire","tiroir","tissu","titane","titre","tituber","toboggan","tolerant","tomate","tonique","tonneau","toponyme","torche","tordre","tornade","torpille","torrent","torse","tortue","totem","toucher","tournage","tousser","toxine","traction","trafic","tragique","trahir","train","trancher","travail","trefle","tremper","tresor","treuil","triage","tribunal","tricoter","trilogie","triomphe","tripler","triturer","trivial","trombone","tronc","tropical","troupeau","tuile","tulipe","tumulte","tunnel","turbine","tuteur","tutoyer","tuyau","tympan","typhon","typique","tyran","ubuesque","ultime","ultrason","unanime","unifier","union","unique","unitaire","univers","uranium","urbain","urticant","usage","usine","usuel","usure","utile","utopie","vacarme","vaccin","vagabond","vague","vaillant","vaincre","vaisseau","valable","valise","vallon","valve","vampire","vanille","vapeur","varier","vaseux","vassal","vaste","vecteur","vedette","vegetal","vehicule","veinard","veloce","vendredi","venerer","venger","venimeux","ventouse","verdure","verin","vernir","verrou","verser","vertu","veston","veteran","vetuste","vexant","vexer","viaduc","viande","victoire","vidange","video","vignette","vigueur","vilain","village","vinaigre","violon","vipere","virement","virtuose","virus","visage","viseur","vision","visqueux","visuel","vital","vitesse","viticole","vitrine","vivace","vivipare","vocation","voguer","voile","voisin","voiture","volaille","volcan","voltiger","volume","vorace","vortex","voter","vouloir","voyage","voyelle","wagon","xenon","yacht","zebre","zenith","zeste","zoologie"],ITALIAN=["abaco","abbaglio","abbinato","abete","abisso","abolire","abrasivo","abrogato","accadere","accenno","accusato","acetone","achille","acido","acqua","acre","acrilico","acrobata","acuto","adagio","addebito","addome","adeguato","aderire","adipe","adottare","adulare","affabile","affetto","affisso","affranto","aforisma","afoso","africano","agave","agente","agevole","aggancio","agire","agitare","agonismo","agricolo","agrumeto","aguzzo","alabarda","alato","albatro","alberato","albo","albume","alce","alcolico","alettone","alfa","algebra","aliante","alibi","alimento","allagato","allegro","allievo","allodola","allusivo","almeno","alogeno","alpaca","alpestre","altalena","alterno","alticcio","altrove","alunno","alveolo","alzare","amalgama","amanita","amarena","ambito","ambrato","ameba","america","ametista","amico","ammasso","ammenda","ammirare","ammonito","amore","ampio","ampliare","amuleto","anacardo","anagrafe","analista","anarchia","anatra","anca","ancella","ancora","andare","andrea","anello","angelo","angolare","angusto","anima","annegare","annidato","anno","annuncio","anonimo","anticipo","anzi","apatico","apertura","apode","apparire","appetito","appoggio","approdo","appunto","aprile","arabica","arachide","aragosta","araldica","arancio","aratura","arazzo","arbitro","archivio","ardito","arenile","argento","argine","arguto","aria","armonia","arnese","arredato","arringa","arrosto","arsenico","arso","artefice","arzillo","asciutto","ascolto","asepsi","asettico","asfalto","asino","asola","aspirato","aspro","assaggio","asse","assoluto","assurdo","asta","astenuto","astice","astratto","atavico","ateismo","atomico","atono","attesa","attivare","attorno","attrito","attuale","ausilio","austria","autista","autonomo","autunno","avanzato","avere","avvenire","avviso","avvolgere","azione","azoto","azzimo","azzurro","babele","baccano","bacino","baco","badessa","badilata","bagnato","baita","balcone","baldo","balena","ballata","balzano","bambino","bandire","baraonda","barbaro","barca","baritono","barlume","barocco","basilico","basso","batosta","battuto","baule","bava","bavosa","becco","beffa","belgio","belva","benda","benevole","benigno","benzina","bere","berlina","beta","bibita","bici","bidone","bifido","biga","bilancia","bimbo","binocolo","biologo","bipede","bipolare","birbante","birra","biscotto","bisesto","bisnonno","bisonte","bisturi","bizzarro","blando","blatta","bollito","bonifico","bordo","bosco","botanico","bottino","bozzolo","braccio","bradipo","brama","branca","bravura","bretella","brevetto","brezza","briglia","brillante","brindare","broccolo","brodo","bronzina","brullo","bruno","bubbone","buca","budino","buffone","buio","bulbo","buono","burlone","burrasca","bussola","busta","cadetto","caduco","calamaro","calcolo","calesse","calibro","calmo","caloria","cambusa","camerata","camicia","cammino","camola","campale","canapa","candela","cane","canino","canotto","cantina","capace","capello","capitolo","capogiro","cappero","capra","capsula","carapace","carcassa","cardo","carisma","carovana","carretto","cartolina","casaccio","cascata","caserma","caso","cassone","castello","casuale","catasta","catena","catrame","cauto","cavillo","cedibile","cedrata","cefalo","celebre","cellulare","cena","cenone","centesimo","ceramica","cercare","certo","cerume","cervello","cesoia","cespo","ceto","chela","chiaro","chicca","chiedere","chimera","china","chirurgo","chitarra","ciao","ciclismo","cifrare","cigno","cilindro","ciottolo","circa","cirrosi","citrico","cittadino","ciuffo","civetta","civile","classico","clinica","cloro","cocco","codardo","codice","coerente","cognome","collare","colmato","colore","colposo","coltivato","colza","coma","cometa","commando","comodo","computer","comune","conciso","condurre","conferma","congelare","coniuge","connesso","conoscere","consumo","continuo","convegno","coperto","copione","coppia","copricapo","corazza","cordata","coricato","cornice","corolla","corpo","corredo","corsia","cortese","cosmico","costante","cottura","covato","cratere","cravatta","creato","credere","cremoso","crescita","creta","criceto","crinale","crisi","critico","croce","cronaca","crostata","cruciale","crusca","cucire","cuculo","cugino","cullato","cupola","curatore","cursore","curvo","cuscino","custode","dado","daino","dalmata","damerino","daniela","dannoso","danzare","datato","davanti","davvero","debutto","decennio","deciso","declino","decollo","decreto","dedicato","definito","deforme","degno","delegare","delfino","delirio","delta","demenza","denotato","dentro","deposito","derapata","derivare","deroga","descritto","deserto","desiderio","desumere","detersivo","devoto","diametro","dicembre","diedro","difeso","diffuso","digerire","digitale","diluvio","dinamico","dinnanzi","dipinto","diploma","dipolo","diradare","dire","dirotto","dirupo","disagio","discreto","disfare","disgelo","disposto","distanza","disumano","dito","divano","divelto","dividere","divorato","doblone","docente","doganale","dogma","dolce","domato","domenica","dominare","dondolo","dono","dormire","dote","dottore","dovuto","dozzina","drago","druido","dubbio","dubitare","ducale","duna","duomo","duplice","duraturo","ebano","eccesso","ecco","eclissi","economia","edera","edicola","edile","editoria","educare","egemonia","egli","egoismo","egregio","elaborato","elargire","elegante","elencato","eletto","elevare","elfico","elica","elmo","elsa","eluso","emanato","emblema","emesso","emiro","emotivo","emozione","empirico","emulo","endemico","enduro","energia","enfasi","enoteca","entrare","enzima","epatite","epilogo","episodio","epocale","eppure","equatore","erario","erba","erboso","erede","eremita","erigere","ermetico","eroe","erosivo","errante","esagono","esame","esanime","esaudire","esca","esempio","esercito","esibito","esigente","esistere","esito","esofago","esortato","esoso","espanso","espresso","essenza","esso","esteso","estimare","estonia","estroso","esultare","etilico","etnico","etrusco","etto","euclideo","europa","evaso","evidenza","evitato","evoluto","evviva","fabbrica","faccenda","fachiro","falco","famiglia","fanale","fanfara","fango","fantasma","fare","farfalla","farinoso","farmaco","fascia","fastoso","fasullo","faticare","fato","favoloso","febbre","fecola","fede","fegato","felpa","feltro","femmina","fendere","fenomeno","fermento","ferro","fertile","fessura","festivo","fetta","feudo","fiaba","fiducia","fifa","figurato","filo","finanza","finestra","finire","fiore","fiscale","fisico","fiume","flacone","flamenco","flebo","flemma","florido","fluente","fluoro","fobico","focaccia","focoso","foderato","foglio","folata","folclore","folgore","fondente","fonetico","fonia","fontana","forbito","forchetta","foresta","formica","fornaio","foro","fortezza","forzare","fosfato","fosso","fracasso","frana","frassino","fratello","freccetta","frenata","fresco","frigo","frollino","fronde","frugale","frutta","fucilata","fucsia","fuggente","fulmine","fulvo","fumante","fumetto","fumoso","fune","funzione","fuoco","furbo","furgone","furore","fuso","futile","gabbiano","gaffe","galateo","gallina","galoppo","gambero","gamma","garanzia","garbo","garofano","garzone","gasdotto","gasolio","gastrico","gatto","gaudio","gazebo","gazzella","geco","gelatina","gelso","gemello","gemmato","gene","genitore","gennaio","genotipo","gergo","ghepardo","ghiaccio","ghisa","giallo","gilda","ginepro","giocare","gioiello","giorno","giove","girato","girone","gittata","giudizio","giurato","giusto","globulo","glutine","gnomo","gobba","golf","gomito","gommone","gonfio","gonna","governo","gracile","grado","grafico","grammo","grande","grattare","gravoso","grazia","greca","gregge","grifone","grigio","grinza","grotta","gruppo","guadagno","guaio","guanto","guardare","gufo","guidare","ibernato","icona","identico","idillio","idolo","idra","idrico","idrogeno","igiene","ignaro","ignorato","ilare","illeso","illogico","illudere","imballo","imbevuto","imbocco","imbuto","immane","immerso","immolato","impacco","impeto","impiego","importo","impronta","inalare","inarcare","inattivo","incanto","incendio","inchino","incisivo","incluso","incontro","incrocio","incubo","indagine","india","indole","inedito","infatti","infilare","inflitto","ingaggio","ingegno","inglese","ingordo","ingrosso","innesco","inodore","inoltrare","inondato","insano","insetto","insieme","insonnia","insulina","intasato","intero","intonaco","intuito","inumidire","invalido","invece","invito","iperbole","ipnotico","ipotesi","ippica","iride","irlanda","ironico","irrigato","irrorare","isolato","isotopo","isterico","istituto","istrice","italia","iterare","labbro","labirinto","lacca","lacerato","lacrima","lacuna","laddove","lago","lampo","lancetta","lanterna","lardoso","larga","laringe","lastra","latenza","latino","lattuga","lavagna","lavoro","legale","leggero","lembo","lentezza","lenza","leone","lepre","lesivo","lessato","lesto","letterale","leva","levigato","libero","lido","lievito","lilla","limatura","limitare","limpido","lineare","lingua","liquido","lira","lirica","lisca","lite","litigio","livrea","locanda","lode","logica","lombare","londra","longevo","loquace","lorenzo","loto","lotteria","luce","lucidato","lumaca","luminoso","lungo","lupo","luppolo","lusinga","lusso","lutto","macabro","macchina","macero","macinato","madama","magico","maglia","magnete","magro","maiolica","malafede","malgrado","malinteso","malsano","malto","malumore","mana","mancia","mandorla","mangiare","manifesto","mannaro","manovra","mansarda","mantide","manubrio","mappa","maratona","marcire","maretta","marmo","marsupio","maschera","massaia","mastino","materasso","matricola","mattone","maturo","mazurca","meandro","meccanico","mecenate","medesimo","meditare","mega","melassa","melis","melodia","meninge","meno","mensola","mercurio","merenda","merlo","meschino","mese","messere","mestolo","metallo","metodo","mettere","miagolare","mica","micelio","michele","microbo","midollo","miele","migliore","milano","milite","mimosa","minerale","mini","minore","mirino","mirtillo","miscela","missiva","misto","misurare","mitezza","mitigare","mitra","mittente","mnemonico","modello","modifica","modulo","mogano","mogio","mole","molosso","monastero","monco","mondina","monetario","monile","monotono","monsone","montato","monviso","mora","mordere","morsicato","mostro","motivato","motosega","motto","movenza","movimento","mozzo","mucca","mucosa","muffa","mughetto","mugnaio","mulatto","mulinello","multiplo","mummia","munto","muovere","murale","musa","muscolo","musica","mutevole","muto","nababbo","nafta","nanometro","narciso","narice","narrato","nascere","nastrare","naturale","nautica","naviglio","nebulosa","necrosi","negativo","negozio","nemmeno","neofita","neretto","nervo","nessuno","nettuno","neutrale","neve","nevrotico","nicchia","ninfa","nitido","nobile","nocivo","nodo","nome","nomina","nordico","normale","norvegese","nostrano","notare","notizia","notturno","novella","nucleo","nulla","numero","nuovo","nutrire","nuvola","nuziale","oasi","obbedire","obbligo","obelisco","oblio","obolo","obsoleto","occasione","occhio","occidente","occorrere","occultare","ocra","oculato","odierno","odorare","offerta","offrire","offuscato","oggetto","oggi","ognuno","olandese","olfatto","oliato","oliva","ologramma","oltre","omaggio","ombelico","ombra","omega","omissione","ondoso","onere","onice","onnivoro","onorevole","onta","operato","opinione","opposto","oracolo","orafo","ordine","orecchino","orefice","orfano","organico","origine","orizzonte","orma","ormeggio","ornativo","orologio","orrendo","orribile","ortensia","ortica","orzata","orzo","osare","oscurare","osmosi","ospedale","ospite","ossa","ossidare","ostacolo","oste","otite","otre","ottagono","ottimo","ottobre","ovale","ovest","ovino","oviparo","ovocito","ovunque","ovviare","ozio","pacchetto","pace","pacifico","padella","padrone","paese","paga","pagina","palazzina","palesare","pallido","palo","palude","pandoro","pannello","paolo","paonazzo","paprica","parabola","parcella","parere","pargolo","pari","parlato","parola","partire","parvenza","parziale","passivo","pasticca","patacca","patologia","pattume","pavone","peccato","pedalare","pedonale","peggio","peloso","penare","pendice","penisola","pennuto","penombra","pensare","pentola","pepe","pepita","perbene","percorso","perdonato","perforare","pergamena","periodo","permesso","perno","perplesso","persuaso","pertugio","pervaso","pesatore","pesista","peso","pestifero","petalo","pettine","petulante","pezzo","piacere","pianta","piattino","piccino","picozza","piega","pietra","piffero","pigiama","pigolio","pigro","pila","pilifero","pillola","pilota","pimpante","pineta","pinna","pinolo","pioggia","piombo","piramide","piretico","pirite","pirolisi","pitone","pizzico","placebo","planare","plasma","platano","plenario","pochezza","poderoso","podismo","poesia","poggiare","polenta","poligono","pollice","polmonite","polpetta","polso","poltrona","polvere","pomice","pomodoro","ponte","popoloso","porfido","poroso","porpora","porre","portata","posa","positivo","possesso","postulato","potassio","potere","pranzo","prassi","pratica","precluso","predica","prefisso","pregiato","prelievo","premere","prenotare","preparato","presenza","pretesto","prevalso","prima","principe","privato","problema","procura","produrre","profumo","progetto","prolunga","promessa","pronome","proposta","proroga","proteso","prova","prudente","prugna","prurito","psiche","pubblico","pudica","pugilato","pugno","pulce","pulito","pulsante","puntare","pupazzo","pupilla","puro","quadro","qualcosa","quasi","querela","quota","raccolto","raddoppio","radicale","radunato","raffica","ragazzo","ragione","ragno","ramarro","ramingo","ramo","randagio","rantolare","rapato","rapina","rappreso","rasatura","raschiato","rasente","rassegna","rastrello","rata","ravveduto","reale","recepire","recinto","recluta","recondito","recupero","reddito","redimere","regalato","registro","regola","regresso","relazione","remare","remoto","renna","replica","reprimere","reputare","resa","residente","responso","restauro","rete","retina","retorica","rettifica","revocato","riassunto","ribadire","ribelle","ribrezzo","ricarica","ricco","ricevere","riciclato","ricordo","ricreduto","ridicolo","ridurre","rifasare","riflesso","riforma","rifugio","rigare","rigettato","righello","rilassato","rilevato","rimanere","rimbalzo","rimedio","rimorchio","rinascita","rincaro","rinforzo","rinnovo","rinomato","rinsavito","rintocco","rinuncia","rinvenire","riparato","ripetuto","ripieno","riportare","ripresa","ripulire","risata","rischio","riserva","risibile","riso","rispetto","ristoro","risultato","risvolto","ritardo","ritegno","ritmico","ritrovo","riunione","riva","riverso","rivincita","rivolto","rizoma","roba","robotico","robusto","roccia","roco","rodaggio","rodere","roditore","rogito","rollio","romantico","rompere","ronzio","rosolare","rospo","rotante","rotondo","rotula","rovescio","rubizzo","rubrica","ruga","rullino","rumine","rumoroso","ruolo","rupe","russare","rustico","sabato","sabbiare","sabotato","sagoma","salasso","saldatura","salgemma","salivare","salmone","salone","saltare","saluto","salvo","sapere","sapido","saporito","saraceno","sarcasmo","sarto","sassoso","satellite","satira","satollo","saturno","savana","savio","saziato","sbadiglio","sbalzo","sbancato","sbarra","sbattere","sbavare","sbendare","sbirciare","sbloccato","sbocciato","sbrinare","sbruffone","sbuffare","scabroso","scadenza","scala","scambiare","scandalo","scapola","scarso","scatenare","scavato","scelto","scenico","scettro","scheda","schiena","sciarpa","scienza","scindere","scippo","sciroppo","scivolo","sclerare","scodella","scolpito","scomparto","sconforto","scoprire","scorta","scossone","scozzese","scriba","scrollare","scrutinio","scuderia","scultore","scuola","scuro","scusare","sdebitare","sdoganare","seccatura","secondo","sedano","seggiola","segnalato","segregato","seguito","selciato","selettivo","sella","selvaggio","semaforo","sembrare","seme","seminato","sempre","senso","sentire","sepolto","sequenza","serata","serbato","sereno","serio","serpente","serraglio","servire","sestina","setola","settimana","sfacelo","sfaldare","sfamato","sfarzoso","sfaticato","sfera","sfida","sfilato","sfinge","sfocato","sfoderare","sfogo","sfoltire","sforzato","sfratto","sfruttato","sfuggito","sfumare","sfuso","sgabello","sgarbato","sgonfiare","sgorbio","sgrassato","sguardo","sibilo","siccome","sierra","sigla","signore","silenzio","sillaba","simbolo","simpatico","simulato","sinfonia","singolo","sinistro","sino","sintesi","sinusoide","sipario","sisma","sistole","situato","slitta","slogatura","sloveno","smarrito","smemorato","smentito","smeraldo","smilzo","smontare","smottato","smussato","snellire","snervato","snodo","sobbalzo","sobrio","soccorso","sociale","sodale","soffitto","sogno","soldato","solenne","solido","sollazzo","solo","solubile","solvente","somatico","somma","sonda","sonetto","sonnifero","sopire","soppeso","sopra","sorgere","sorpasso","sorriso","sorso","sorteggio","sorvolato","sospiro","sosta","sottile","spada","spalla","spargere","spatola","spavento","spazzola","specie","spedire","spegnere","spelatura","speranza","spessore","spettrale","spezzato","spia","spigoloso","spillato","spinoso","spirale","splendido","sportivo","sposo","spranga","sprecare","spronato","spruzzo","spuntino","squillo","sradicare","srotolato","stabile","stacco","staffa","stagnare","stampato","stantio","starnuto","stasera","statuto","stelo","steppa","sterzo","stiletto","stima","stirpe","stivale","stizzoso","stonato","storico","strappo","stregato","stridulo","strozzare","strutto","stuccare","stufo","stupendo","subentro","succoso","sudore","suggerito","sugo","sultano","suonare","superbo","supporto","surgelato","surrogato","sussurro","sutura","svagare","svedese","sveglio","svelare","svenuto","svezia","sviluppo","svista","svizzera","svolta","svuotare","tabacco","tabulato","tacciare","taciturno","tale","talismano","tampone","tannino","tara","tardivo","targato","tariffa","tarpare","tartaruga","tasto","tattico","taverna","tavolata","tazza","teca","tecnico","telefono","temerario","tempo","temuto","tendone","tenero","tensione","tentacolo","teorema","terme","terrazzo","terzetto","tesi","tesserato","testato","tetro","tettoia","tifare","tigella","timbro","tinto","tipico","tipografo","tiraggio","tiro","titanio","titolo","titubante","tizio","tizzone","toccare","tollerare","tolto","tombola","tomo","tonfo","tonsilla","topazio","topologia","toppa","torba","tornare","torrone","tortora","toscano","tossire","tostatura","totano","trabocco","trachea","trafila","tragedia","tralcio","tramonto","transito","trapano","trarre","trasloco","trattato","trave","treccia","tremolio","trespolo","tributo","tricheco","trifoglio","trillo","trincea","trio","tristezza","triturato","trivella","tromba","trono","troppo","trottola","trovare","truccato","tubatura","tuffato","tulipano","tumulto","tunisia","turbare","turchino","tuta","tutela","ubicato","uccello","uccisore","udire","uditivo","uffa","ufficio","uguale","ulisse","ultimato","umano","umile","umorismo","uncinetto","ungere","ungherese","unicorno","unificato","unisono","unitario","unte","uovo","upupa","uragano","urgenza","urlo","usanza","usato","uscito","usignolo","usuraio","utensile","utilizzo","utopia","vacante","vaccinato","vagabondo","vagliato","valanga","valgo","valico","valletta","valoroso","valutare","valvola","vampata","vangare","vanitoso","vano","vantaggio","vanvera","vapore","varano","varcato","variante","vasca","vedetta","vedova","veduto","vegetale","veicolo","velcro","velina","velluto","veloce","venato","vendemmia","vento","verace","verbale","vergogna","verifica","vero","verruca","verticale","vescica","vessillo","vestale","veterano","vetrina","vetusto","viandante","vibrante","vicenda","vichingo","vicinanza","vidimare","vigilia","vigneto","vigore","vile","villano","vimini","vincitore","viola","vipera","virgola","virologo","virulento","viscoso","visione","vispo","vissuto","visura","vita","vitello","vittima","vivanda","vivido","viziare","voce","voga","volatile","volere","volpe","voragine","vulcano","zampogna","zanna","zappato","zattera","zavorra","zefiro","zelante","zelo","zenzero","zerbino","zibetto","zinco","zircone","zitto","zolla","zotico","zucchero","zufolo","zulu","zuppa"],JAPANESE=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],SPANISH=["abaco","abdomen","abeja","abierto","abogado","abono","aborto","abrazo","abrir","abuelo","abuso","acabar","academia","acceso","accion","aceite","acelga","acento","aceptar","acido","aclarar","acne","acoger","acoso","activo","acto","actriz","actuar","acudir","acuerdo","acusar","adicto","admitir","adoptar","adorno","aduana","adulto","aereo","afectar","aficion","afinar","afirmar","agil","agitar","agonia","agosto","agotar","agregar","agrio","agua","agudo","aguila","aguja","ahogo","ahorro","aire","aislar","ajedrez","ajeno","ajuste","alacran","alambre","alarma","alba","album","alcalde","aldea","alegre","alejar","alerta","aleta","alfiler","alga","algodon","aliado","aliento","alivio","alma","almeja","almibar","altar","alteza","altivo","alto","altura","alumno","alzar","amable","amante","amapola","amargo","amasar","ambar","ambito","ameno","amigo","amistad","amor","amparo","amplio","ancho","anciano","ancla","andar","anden","anemia","angulo","anillo","animo","anis","anotar","antena","antiguo","antojo","anual","anular","anuncio","anadir","anejo","ano","apagar","aparato","apetito","apio","aplicar","apodo","aporte","apoyo","aprender","aprobar","apuesta","apuro","arado","arana","arar","arbitro","arbol","arbusto","archivo","arco","arder","ardilla","arduo","area","arido","aries","armonia","arnes","aroma","arpa","arpon","arreglo","arroz","arruga","arte","artista","asa","asado","asalto","ascenso","asegurar","aseo","asesor","asiento","asilo","asistir","asno","asombro","aspero","astilla","astro","astuto","asumir","asunto","atajo","ataque","atar","atento","ateo","atico","atleta","atomo","atraer","atroz","atun","audaz","audio","auge","aula","aumento","ausente","autor","aval","avance","avaro","ave","avellana","avena","avestruz","avion","aviso","ayer","ayuda","ayuno","azafran","azar","azote","azucar","azufre","azul","baba","babor","bache","bahia","baile","bajar","balanza","balcon","balde","bambu","banco","banda","bano","barba","barco","barniz","barro","bascula","baston","basura","batalla","bateria","batir","batuta","baul","bazar","bebe","bebida","bello","besar","beso","bestia","bicho","bien","bingo","blanco","bloque","blusa","boa","bobina","bobo","boca","bocina","boda","bodega","boina","bola","bolero","bolsa","bomba","bondad","bonito","bono","bonsai","borde","borrar","bosque","bote","botin","boveda","bozal","bravo","brazo","brecha","breve","brillo","brinco","brisa","broca","broma","bronce","brote","bruja","brusco","bruto","buceo","bucle","bueno","buey","bufanda","bufon","buho","buitre","bulto","burbuja","burla","burro","buscar","butaca","buzon","caballo","cabeza","cabina","cabra","cacao","cadaver","cadena","caer","cafe","caida","caiman","caja","cajon","cal","calamar","calcio","caldo","calidad","calle","calma","calor","calvo","cama","cambio","camello","camino","campo","cancer","candil","canela","canguro","canica","canto","cana","canon","caoba","caos","capaz","capitan","capote","captar","capucha","cara","carbon","carcel","careta","carga","carino","carne","carpeta","carro","carta","casa","casco","casero","caspa","castor","catorce","catre","caudal","causa","cazo","cebolla","ceder","cedro","celda","celebre","celoso","celula","cemento","ceniza","centro","cerca","cerdo","cereza","cero","cerrar","certeza","cesped","cetro","chacal","chaleco","champu","chancla","chapa","charla","chico","chiste","chivo","choque","choza","chuleta","chupar","ciclon","ciego","cielo","cien","cierto","cifra","cigarro","cima","cinco","cine","cinta","cipres","circo","ciruela","cisne","cita","ciudad","clamor","clan","claro","clase","clave","cliente","clima","clinica","cobre","coccion","cochino","cocina","coco","codigo","codo","cofre","coger","cohete","cojin","cojo","cola","colcha","colegio","colgar","colina","collar","colmo","columna","combate","comer","comida","comodo","compra","conde","conejo","conga","conocer","consejo","contar","copa","copia","corazon","corbata","corcho","cordon","corona","correr","coser","cosmos","costa","craneo","crater","crear","crecer","creido","crema","cria","crimen","cripta","crisis","cromo","cronica","croqueta","crudo","cruz","cuadro","cuarto","cuatro","cubo","cubrir","cuchara","cuello","cuento","cuerda","cuesta","cueva","cuidar","culebra","culpa","culto","cumbre","cumplir","cuna","cuneta","cuota","cupon","cupula","curar","curioso","curso","curva","cutis","dama","danza","dar","dardo","datil","deber","debil","decada","decir","dedo","defensa","definir","dejar","delfin","delgado","delito","demora","denso","dental","deporte","derecho","derrota","desayuno","deseo","desfile","desnudo","destino","desvio","detalle","detener","deuda","dia","diablo","diadema","diamante","diana","diario","dibujo","dictar","diente","dieta","diez","dificil","digno","dilema","diluir","dinero","directo","dirigir","disco","diseno","disfraz","diva","divino","doble","doce","dolor","domingo","don","donar","dorado","dormir","dorso","dos","dosis","dragon","droga","ducha","duda","duelo","dueno","dulce","duo","duque","durar","dureza","duro","ebano","ebrio","echar","eco","ecuador","edad","edicion","edificio","editor","educar","efecto","eficaz","eje","ejemplo","elefante","elegir","elemento","elevar","elipse","elite","elixir","elogio","eludir","embudo","emitir","emocion","empate","empeno","empleo","empresa","enano","encargo","enchufe","encia","enemigo","enero","enfado","enfermo","engano","enigma","enlace","enorme","enredo","ensayo","ensenar","entero","entrar","envase","envio","epoca","equipo","erizo","escala","escena","escolar","escribir","escudo","esencia","esfera","esfuerzo","espada","espejo","espia","esposa","espuma","esqui","estar","este","estilo","estufa","etapa","eterno","etica","etnia","evadir","evaluar","evento","evitar","exacto","examen","exceso","excusa","exento","exigir","exilio","existir","exito","experto","explicar","exponer","extremo","fabrica","fabula","fachada","facil","factor","faena","faja","falda","fallo","falso","faltar","fama","familia","famoso","faraon","farmacia","farol","farsa","fase","fatiga","fauna","favor","fax","febrero","fecha","feliz","feo","feria","feroz","fertil","fervor","festin","fiable","fianza","fiar","fibra","ficcion","ficha","fideo","fiebre","fiel","fiera","fiesta","figura","fijar","fijo","fila","filete","filial","filtro","fin","finca","fingir","finito","firma","flaco","flauta","flecha","flor","flota","fluir","flujo","fluor","fobia","foca","fogata","fogon","folio","folleto","fondo","forma","forro","fortuna","forzar","fosa","foto","fracaso","fragil","franja","frase","fraude","freir","freno","fresa","frio","frito","fruta","fuego","fuente","fuerza","fuga","fumar","funcion","funda","furgon","furia","fusil","futbol","futuro","gacela","gafas","gaita","gajo","gala","galeria","gallo","gamba","ganar","gancho","ganga","ganso","garaje","garza","gasolina","gastar","gato","gavilan","gemelo","gemir","gen","genero","genio","gente","geranio","gerente","germen","gesto","gigante","gimnasio","girar","giro","glaciar","globo","gloria","gol","golfo","goloso","golpe","goma","gordo","gorila","gorra","gota","goteo","gozar","grada","grafico","grano","grasa","gratis","grave","grieta","grillo","gripe","gris","grito","grosor","grua","grueso","grumo","grupo","guante","guapo","guardia","guerra","guia","guino","guion","guiso","guitarra","gusano","gustar","haber","habil","hablar","hacer","hacha","hada","hallar","hamaca","harina","haz","hazana","hebilla","hebra","hecho","helado","helio","hembra","herir","hermano","heroe","hervir","hielo","hierro","higado","higiene","hijo","himno","historia","hocico","hogar","hoguera","hoja","hombre","hongo","honor","honra","hora","hormiga","horno","hostil","hoyo","hueco","huelga","huerta","hueso","huevo","huida","huir","humano","humedo","humilde","humo","hundir","huracan","hurto","icono","ideal","idioma","idolo","iglesia","iglu","igual","ilegal","ilusion","imagen","iman","imitar","impar","imperio","imponer","impulso","incapaz","indice","inerte","infiel","informe","ingenio","inicio","inmenso","inmune","innato","insecto","instante","interes","intimo","intuir","inutil","invierno","ira","iris","ironia","isla","islote","jabali","jabon","jamon","jarabe","jardin","jarra","jaula","jazmin","jefe","jeringa","jinete","jornada","joroba","joven","joya","juerga","jueves","juez","jugador","jugo","juguete","juicio","junco","jungla","junio","juntar","jupiter","jurar","justo","juvenil","juzgar","kilo","koala","labio","lacio","lacra","lado","ladron","lagarto","lagrima","laguna","laico","lamer","lamina","lampara","lana","lancha","langosta","lanza","lapiz","largo","larva","lastima","lata","latex","latir","laurel","lavar","lazo","leal","leccion","leche","lector","leer","legion","legumbre","lejano","lengua","lento","lena","leon","leopardo","lesion","letal","letra","leve","leyenda","libertad","libro","licor","lider","lidiar","lienzo","liga","ligero","lima","limite","limon","limpio","lince","lindo","linea","lingote","lino","linterna","liquido","liso","lista","litera","litio","litro","llaga","llama","llanto","llave","llegar","llenar","llevar","llorar","llover","lluvia","lobo","locion","loco","locura","logica","logro","lombriz","lomo","lonja","lote","lucha","lucir","lugar","lujo","luna","lunes","lupa","lustro","luto","luz","maceta","macho","madera","madre","maduro","maestro","mafia","magia","mago","maiz","maldad","maleta","malla","malo","mama","mambo","mamut","manco","mando","manejar","manga","maniqui","manjar","mano","manso","manta","manana","mapa","maquina","mar","marco","marea","marfil","margen","marido","marmol","marron","martes","marzo","masa","mascara","masivo","matar","materia","matiz","matriz","maximo","mayor","mazorca","mecha","medalla","medio","medula","mejilla","mejor","melena","melon","memoria","menor","mensaje","mente","menu","mercado","merengue","merito","mes","meson","meta","meter","metodo","metro","mezcla","miedo","miel","miembro","miga","mil","milagro","militar","millon","mimo","mina","minero","minimo","minuto","miope","mirar","misa","miseria","misil","mismo","mitad","mito","mochila","mocion","moda","modelo","moho","mojar","molde","moler","molino","momento","momia","monarca","moneda","monja","monto","mono","morada","morder","moreno","morir","morro","morsa","mortal","mosca","mostrar","motivo","mover","movil","mozo","mucho","mudar","mueble","muela","muerte","muestra","mugre","mujer","mula","muleta","multa","mundo","muneca","mural","muro","musculo","museo","musgo","musica","muslo","nacar","nacion","nadar","naipe","naranja","nariz","narrar","nasal","natal","nativo","natural","nausea","naval","nave","navidad","necio","nectar","negar","negocio","negro","neon","nervio","neto","neutro","nevar","nevera","nicho","nido","niebla","nieto","ninez","nino","nitido","nivel","nobleza","noche","nomina","noria","norma","norte","nota","noticia","novato","novela","novio","nube","nuca","nucleo","nudillo","nudo","nuera","nueve","nuez","nulo","numero","nutria","oasis","obeso","obispo","objeto","obra","obrero","observar","obtener","obvio","oca","ocaso","oceano","ochenta","ocho","ocio","ocre","octavo","octubre","oculto","ocupar","ocurrir","odiar","odio","odisea","oeste","ofensa","oferta","oficio","ofrecer","ogro","oido","oir","ojo","ola","oleada","olfato","olivo","olla","olmo","olor","olvido","ombligo","onda","onza","opaco","opcion","opera","opinar","oponer","optar","optica","opuesto","oracion","orador","oral","orbita","orca","orden","oreja","organo","orgia","orgullo","oriente","origen","orilla","oro","orquesta","oruga","osadia","oscuro","osezno","oso","ostra","otono","otro","oveja","ovulo","oxido","oxigeno","oyente","ozono","pacto","padre","paella","pagina","pago","pais","pajaro","palabra","palco","paleta","palido","palma","paloma","palpar","pan","panal","panico","pantera","panuelo","papa","papel","papilla","paquete","parar","parcela","pared","parir","paro","parpado","parque","parrafo","parte","pasar","paseo","pasion","paso","pasta","pata","patio","patria","pausa","pauta","pavo","payaso","peaton","pecado","pecera","pecho","pedal","pedir","pegar","peine","pelar","peldano","pelea","peligro","pellejo","pelo","peluca","pena","pensar","penon","peon","peor","pepino","pequeno","pera","percha","perder","pereza","perfil","perico","perla","permiso","perro","persona","pesa","pesca","pesimo","pestana","petalo","petroleo","pez","pezuna","picar","pichon","pie","piedra","pierna","pieza","pijama","pilar","piloto","pimienta","pino","pintor","pinza","pina","piojo","pipa","pirata","pisar","piscina","piso","pista","piton","pizca","placa","plan","plata","playa","plaza","pleito","pleno","plomo","pluma","plural","pobre","poco","poder","podio","poema","poesia","poeta","polen","policia","pollo","polvo","pomada","pomelo","pomo","pompa","poner","porcion","portal","posada","poseer","posible","poste","potencia","potro","pozo","prado","precoz","pregunta","premio","prensa","preso","previo","primo","principe","prision","privar","proa","probar","proceso","producto","proeza","profesor","programa","prole","promesa","pronto","propio","proximo","prueba","publico","puchero","pudor","pueblo","puerta","puesto","pulga","pulir","pulmon","pulpo","pulso","puma","punto","punal","puno","pupa","pupila","pure","quedar","queja","quemar","querer","queso","quieto","quimica","quince","quitar","rabano","rabia","rabo","racion","radical","raiz","rama","rampa","rancho","rango","rapaz","rapido","rapto","rasgo","raspa","rato","rayo","raza","razon","reaccion","realidad","rebano","rebote","recaer","receta","rechazo","recoger","recreo","recto","recurso","red","redondo","reducir","reflejo","reforma","refran","refugio","regalo","regir","regla","regreso","rehen","reino","reir","reja","relato","relevo","relieve","relleno","reloj","remar","remedio","remo","rencor","rendir","renta","reparto","repetir","reposo","reptil","res","rescate","resina","respeto","resto","resumen","retiro","retorno","retrato","reunir","reves","revista","rey","rezar","rico","riego","rienda","riesgo","rifa","rigido","rigor","rincon","rinon","rio","riqueza","risa","ritmo","rito","rizo","roble","roce","rociar","rodar","rodeo","rodilla","roer","rojizo","rojo","romero","romper","ron","ronco","ronda","ropa","ropero","rosa","rosca","rostro","rotar","rubi","rubor","rudo","rueda","rugir","ruido","ruina","ruleta","rulo","rumbo","rumor","ruptura","ruta","rutina","sabado","saber","sabio","sable","sacar","sagaz","sagrado","sala","saldo","salero","salir","salmon","salon","salsa","salto","salud","salvar","samba","sancion","sandia","sanear","sangre","sanidad","sano","santo","sapo","saque","sardina","sarten","sastre","satan","sauna","saxofon","seccion","seco","secreto","secta","sed","seguir","seis","sello","selva","semana","semilla","senda","sensor","senal","senor","separar","sepia","sequia","ser","serie","sermon","servir","sesenta","sesion","seta","setenta","severo","sexo","sexto","sidra","siesta","siete","siglo","signo","silaba","silbar","silencio","silla","simbolo","simio","sirena","sistema","sitio","situar","sobre","socio","sodio","sol","solapa","soldado","soledad","solido","soltar","solucion","sombra","sondeo","sonido","sonoro","sonrisa","sopa","soplar","soporte","sordo","sorpresa","sorteo","sosten","sotano","suave","subir","suceso","sudor","suegra","suelo","sueno","suerte","sufrir","sujeto","sultan","sumar","superar","suplir","suponer","supremo","sur","surco","sureno","surgir","susto","sutil","tabaco","tabique","tabla","tabu","taco","tacto","tajo","talar","talco","talento","talla","talon","tamano","tambor","tango","tanque","tapa","tapete","tapia","tapon","taquilla","tarde","tarea","tarifa","tarjeta","tarot","tarro","tarta","tatuaje","tauro","taza","tazon","teatro","techo","tecla","tecnica","tejado","tejer","tejido","tela","telefono","tema","temor","templo","tenaz","tender","tener","tenis","tenso","teoria","terapia","terco","termino","ternura","terror","tesis","tesoro","testigo","tetera","texto","tez","tibio","tiburon","tiempo","tienda","tierra","tieso","tigre","tijera","tilde","timbre","timido","timo","tinta","tio","tipico","tipo","tira","tiron","titan","titere","titulo","tiza","toalla","tobillo","tocar","tocino","todo","toga","toldo","tomar","tono","tonto","topar","tope","toque","torax","torero","tormenta","torneo","toro","torpedo","torre","torso","tortuga","tos","tosco","toser","toxico","trabajo","tractor","traer","trafico","trago","traje","tramo","trance","trato","trauma","trazar","trebol","tregua","treinta","tren","trepar","tres","tribu","trigo","tripa","triste","triunfo","trofeo","trompa","tronco","tropa","trote","trozo","truco","trueno","trufa","tuberia","tubo","tuerto","tumba","tumor","tunel","tunica","turbina","turismo","turno","tutor","ubicar","ulcera","umbral","unidad","unir","universo","uno","untar","una","urbano","urbe","urgente","urna","usar","usuario","util","utopia","uva","vaca","vacio","vacuna","vagar","vago","vaina","vajilla","vale","valido","valle","valor","valvula","vampiro","vara","variar","varon","vaso","vecino","vector","vehiculo","veinte","vejez","vela","velero","veloz","vena","vencer","venda","veneno","vengar","venir","venta","venus","ver","verano","verbo","verde","vereda","verja","verso","verter","via","viaje","vibrar","vicio","victima","vida","video","vidrio","viejo","viernes","vigor","vil","villa","vinagre","vino","vinedo","violin","viral","virgo","virtud","visor","vispera","vista","vitamina","viudo","vivaz","vivero","vivir","vivo","volcan","volumen","volver","voraz","votar","voto","voz","vuelo","vulgar","yacer","yate","yegua","yema","yerno","yeso","yodo","yoga","yogur","zafiro","zanja","zapato","zarza","zona","zorro","zumo","zurdo"],Words={CHINESE:CHINESE,ENGLISH:ENGLISH,FRENCH:FRENCH,ITALIAN:ITALIAN,JAPANESE:JAPANESE,SPANISH:SPANISH};const Mnemonic=function(e,t){if(!(this instanceof Mnemonic))return new Mnemonic(e,t);let r,i,o;if(_.isArray(e)&&(t=e,e=null),Buffer.isBuffer(e))o=e;else if(_.isString(e))i=unorm.nfkd(e);else if(_.isNumber(e))r=e;else if(e)throw new errors.InvalidArgument("data","Must be a Buffer, a string or an integer");if(r=r||128,t=t||Mnemonic._getDictionary(i),i&&!t)throw new errors.UnknownWordlist(i);if(t=t||Mnemonic.Words.ENGLISH,o&&(i=Mnemonic._entropy2mnemonic(o,t)),i&&!Mnemonic.isValid(i,t))throw new errors.InvalidMnemonic(i);if(0!=r%32||128>r)throw new errors.InvalidArgument("ENT","Values must be ENT > 128 and ENT % 32 == 0");i=i||Mnemonic._mnemonic(r,t),Object.defineProperty(this,"wordlist",{configurable:!1,value:t}),Object.defineProperty(this,"phrase",{configurable:!1,value:i})};Mnemonic.Words=Words,Mnemonic.isValid=function(e,t){let r;if(e=unorm.nfkd(e),!(t=t||Mnemonic._getDictionary(e)))return!1;const i=e.split(" ");let o="";for(r=0;r<i.length;r+=1){const e=t.indexOf(i[r]);if(0>e)return!1;o+="00000000000".concat(e.toString(2)).slice(-11)}const n=o.length/33,a=o.slice(-n),s=o.slice(0,o.length-n),u=Buffer.alloc(s.length/8);for(r=0;r<s.length/8;r+=1)u.writeUInt8(parseInt(o.slice(8*r,8*(r+1)),2),r);return Mnemonic._entropyChecksum(u)===a},Mnemonic._belongsToWordlist=function(e,t){const r=unorm.nfkd(e).split(" ");for(let e=0;e<r.length;e+=1){if(0>t.indexOf(r[e]))return!1}return!0},Mnemonic._getDictionary=function(e){if(!e)return null;const t=Object.keys(Mnemonic.Words);for(let r=0;r<t.length;r+=1){const i=t[r];if(Mnemonic._belongsToWordlist(e,Mnemonic.Words[i]))return Mnemonic.Words[i]}return null},Mnemonic.prototype.toSeed=function(e){return e=e||"",Mnemonic.pbkdf2(unorm.nfkd(this.phrase),unorm.nfkd("mnemonic".concat(e)),2048,64)},Mnemonic.fromSeed=function(e,t){return preconditions.checkArgument(Buffer.isBuffer(e),"seed must be a Buffer."),preconditions.checkArgument(_.isArray(t)||_.isString(t),"wordlist must be a string or an array."),new Mnemonic(e,t)},Mnemonic.prototype.toHDPrivateKey=function(e,t){const r=this.toSeed(e);return HDPrivateKey.fromSeed(r,t)},Mnemonic.prototype.toString=function(){return this.phrase},Mnemonic.prototype.inspect=function(){return"<Mnemonic: ".concat(this.toString()," >")},Mnemonic._mnemonic=function(e,t){const r=Random.getRandomBuffer(e/8);return Mnemonic._entropy2mnemonic(r,t)},Mnemonic._entropy2mnemonic=function(e,t){let r,i="";for(r=0;r<e.length;r+=1)i+="00000000".concat(e[r].toString(2)).slice(-8);if(0!=(i+=Mnemonic._entropyChecksum(e)).length%11)throw new errors.InvalidEntropy(i);const o=[];for(r=0;r<i.length/11;r+=1){const e=parseInt(i.slice(11*r,11*(r+1)),2);o.push(t[e])}let n;return n=t===Mnemonic.Words.JAPANESE?o.join(""):o.join(" ")},Mnemonic._entropyChecksum=function(e){const t=Hash.sha256(e),r=8*e.length;let i=new BN(t.toString("hex"),16).toString(2);for(;0!=i.length%256;)i="0".concat(i);return i.slice(0,r/32)},Mnemonic.pbkdf2=pbkdf2;var name="bitcoinsource",version="0.1.16",description="A simple, safe, and powerful JavaScript Bitcoin Cash library.",author="Clemens Ley <ley.clemens@gmail.com>",license="MIT",main="dist/bitcoinsource.common.js",module$1="dist/bitcoinsource.esm.js",files=["dist"],scripts={build:"rollup -c",test:"mocha","test:cover":"nyc mocha",lint:"eslint src test","lint:fix":"eslint src test --fix",flow:"flow check",clean:"rm -rf dist",readme:"mustache package.json README.tpl.md > README.md",preversion:"npm run clean && npm run lint && npm run flow && npm run test",version:"npm run build && npm run readme && git add README.md",postversion:"git push && git push --tags && npm publish",bump:"npm version patch -m 'Bump version to %s.'"},keywords=["bitcoin","source","transaction","address","p2p","cryptocurrency","blockchain","payment","multisig"],repository={type:"git",url:"https://github.com/the-bitcoin-token/bitcoin-source"},prettier={printWidth:100,proseWrap:"preserve",semi:!1,singleQuote:!0},dependencies={"big-integer":"^1.6.42","bn.js":"^4.11.8",bs58:"=2.0.0","buffer-compare":"=1.0.0",cashaddrjs:"^0.2.9",elliptic:"https://github.com/indutny/elliptic.git#8a6bb9","hash.js":"^1.1.7",lodash:"^4.17.11",randombytes:"^2.1.0",unorm:"^1.4.1"},devDependencies={"@babel/core":"^7.4.0","@babel/preset-env":"^7.4.2","@babel/preset-flow":"^7.0.0","@babel/register":"^7.4.0","babel-eslint":"^10.0.1","babel-preset-minify":"^0.5.0",chai:"^1.10.0",eslint:"^5.15.3","eslint-config-airbnb-base":"^13.1.0","eslint-config-prettier":"^4.1.0","eslint-plugin-flowtype":"^3.4.2","eslint-plugin-flowtype-errors":"^4.0.0","eslint-plugin-import":"^2.16.0","eslint-plugin-prettier":"^3.0.1","flow-bin":"^0.95.1","flow-typed":"^2.5.1",jsdoc:"^3.5.5",mocha:"^6.0.2",mustache:"^2.3.2",nyc:"^11.9.0",prettier:"^1.14.3",rollup:"^1.7.3","rollup-plugin-babel":"^4.3.2","rollup-plugin-commonjs":"^9.2.2","rollup-plugin-flow":"^1.1.1","rollup-plugin-json":"^4.0.0","rollup-plugin-node-builtins":"^2.1.2","rollup-plugin-node-globals":"^1.4.0","rollup-plugin-node-resolve":"^4.0.1","rollup-plugin-terser":"^4.0.4",sinon:"^1.13.0"},PackageInfo={name:name,version:version,description:description,author:author,license:license,main:main,module:module$1,files:files,scripts:scripts,keywords:keywords,repository:repository,prettier:prettier,dependencies:dependencies,devDependencies:devDependencies};const Interpreter=function e(t){return this instanceof e?void(t?(this.initialize(),this.set(t)):this.initialize()):new e(t)};Interpreter.prototype.verify=function(e,t,r,i,o){let n;if(_.isUndefined(r)&&(r=new Transaction),_.isUndefined(i)&&(i=0),_.isUndefined(o)&&(o=0),this.set({script:e,tx:r,nin:i,flags:o}),0!=(o&Interpreter.SCRIPT_VERIFY_SIGPUSHONLY)&&!e.isPushOnly())return this.errstr="SCRIPT_ERR_SIG_PUSHONLY",!1;if(!this.evaluate())return!1;o&Interpreter.SCRIPT_VERIFY_P2SH&&(n=this.stack.slice());const a=this.stack;if(this.initialize(),this.set({script:t,stack:a,tx:r,nin:i,flags:o}),!this.evaluate())return!1;if(0===this.stack.length)return this.errstr="SCRIPT_ERR_EVAL_FALSE_NO_RESULT",!1;const s=this.stack[this.stack.length-1];if(!Interpreter.castToBool(s))return this.errstr="SCRIPT_ERR_EVAL_FALSE_IN_STACK",!1;if(o&Interpreter.SCRIPT_VERIFY_P2SH&&t.isScriptHashOut()){if(!e.isPushOnly())return this.errstr="SCRIPT_ERR_SIG_PUSHONLY",!1;if(0===n.length)throw new Error("internal error - stack copy empty");const t=n[n.length-1],a=Script.fromBuffer(t);return n.pop(),this.initialize(),this.set({script:a,stack:n,tx:r,nin:i,flags:o}),!(!this.evaluate()||(0===n.length?(this.errstr="SCRIPT_ERR_EVAL_FALSE_NO_P2SH_STACK",1):!Interpreter.castToBool(n[n.length-1])&&(this.errstr="SCRIPT_ERR_EVAL_FALSE_IN_P2SH_STACK",1)))}return!0},Interpreter.prototype.initialize=function(){this.stack=[],this.altstack=[],this.pc=0,this.pbegincodehash=0,this.nOpCount=0,this.vfExec=[],this.errstr="",this.flags=0},Interpreter.prototype.set=function(e){this.script=e.script||this.script,this.tx=e.tx||this.tx,this.nin=void 0===e.nin?this.nin:e.nin,this.stack=e.stack||this.stack,this.altstack=e.altstack||this.altstack,this.pc=void 0===e.pc?this.pc:e.pc,this.pbegincodehash=void 0===e.pbegincodehash?this.pbegincodehash:e.pbegincodehash,this.nOpCount=void 0===e.nOpCount?this.nOpCount:e.nOpCount,this.vfExec=e.vfExec||this.vfExec,this.errstr=e.errstr||this.errstr,this.flags=void 0===e.flags?this.flags:e.flags},Interpreter.true=Buffer.from([1]),Interpreter.false=Buffer.from([]),Interpreter.MAX_SCRIPT_ELEMENT_SIZE=520,Interpreter.LOCKTIME_THRESHOLD_BN=new BN(Interpreter.LOCKTIME_THRESHOLD=5e8),Interpreter.SCRIPT_VERIFY_NONE=0,Interpreter.SCRIPT_VERIFY_P2SH=1,Interpreter.SCRIPT_VERIFY_STRICTENC=2,Interpreter.SCRIPT_VERIFY_DERSIG=4,Interpreter.SCRIPT_VERIFY_LOW_S=8,Interpreter.SCRIPT_VERIFY_NULLDUMMY=16,Interpreter.SCRIPT_VERIFY_SIGPUSHONLY=32,Interpreter.SCRIPT_VERIFY_MINIMALDATA=64,Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS=128,Interpreter.SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY=512,Interpreter.castToBool=function(e){for(let t=0;t<e.length;t+=1)if(0!==e[t])return t!=e.length-1||128!==e[t];return!1},Interpreter.prototype.checkSignatureEncoding=function(e){let t;if(0!=(this.flags&(Interpreter.SCRIPT_VERIFY_DERSIG|Interpreter.SCRIPT_VERIFY_LOW_S|Interpreter.SCRIPT_VERIFY_STRICTENC))&&!Signature.isTxDER(e))return this.errstr="SCRIPT_ERR_SIG_DER_INVALID_FORMAT",!1;if(0!=(this.flags&Interpreter.SCRIPT_VERIFY_LOW_S)){if(!(t=Signature.fromTxFormat(e)).hasLowS())return this.errstr="SCRIPT_ERR_SIG_DER_HIGH_S",!1}else if(0!=(this.flags&Interpreter.SCRIPT_VERIFY_STRICTENC)&&!(t=Signature.fromTxFormat(e)).hasDefinedHashtype())return this.errstr="SCRIPT_ERR_SIG_HASHTYPE",!1;return!0},Interpreter.prototype.checkPubkeyEncoding=function(e){return!(0!=(this.flags&Interpreter.SCRIPT_VERIFY_STRICTENC)&&!PublicKey.isValid(e)&&(this.errstr="SCRIPT_ERR_PUBKEYTYPE",1))},Interpreter.prototype.evaluate=function(){if(1e4<this.script.toBuffer().length)return this.errstr="SCRIPT_ERR_SCRIPT_SIZE",!1;try{for(;this.pc<this.script.chunks.length;){if(!this.step())return!1}if(1e3<this.stack.length+this.altstack.length)return this.errstr="SCRIPT_ERR_STACK_SIZE",!1}catch(e){return this.errstr="SCRIPT_ERR_UNKNOWN_ERROR: ".concat(e),!1}return!(0<this.vfExec.length&&(this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",1))},Interpreter.prototype.checkLockTime=function(e){return!!(this.tx.nLockTime<Interpreter.LOCKTIME_THRESHOLD&&e.lt(Interpreter.LOCKTIME_THRESHOLD_BN)||this.tx.nLockTime>=Interpreter.LOCKTIME_THRESHOLD&&e.gte(Interpreter.LOCKTIME_THRESHOLD_BN))&&!e.gt(new BN(this.tx.nLockTime))&&!!this.tx.inputs[this.nin].isFinal()},Interpreter.prototype.step=function(){const e=0!=(this.flags&Interpreter.SCRIPT_VERIFY_MINIMALDATA),t=-1===this.vfExec.indexOf(!1);let r,i,o,n,a,s,u,c,l,p,h,f,d,m,g,b,y;const S=this.script.chunks[this.pc];this.pc+=1;const v=S.opcodenum;if(_.isUndefined(v))return this.errstr="SCRIPT_ERR_UNDEFINED_OPCODE",!1;if(S.buf&&S.buf.length>Interpreter.MAX_SCRIPT_ELEMENT_SIZE)return this.errstr="SCRIPT_ERR_PUSH_SIZE",!1;if(v>Opcode.OP_16&&(this.nOpCount+=1,201<this.nOpCount))return this.errstr="SCRIPT_ERR_OP_COUNT",!1;if(v===Opcode.OP_CAT||v===Opcode.OP_SUBSTR||v===Opcode.OP_LEFT||v===Opcode.OP_RIGHT||v===Opcode.OP_INVERT||v===Opcode.OP_AND||v===Opcode.OP_OR||v===Opcode.OP_XOR||v===Opcode.OP_2MUL||v===Opcode.OP_2DIV||v===Opcode.OP_MUL||v===Opcode.OP_DIV||v===Opcode.OP_MOD||v===Opcode.OP_LSHIFT||v===Opcode.OP_RSHIFT)return this.errstr="SCRIPT_ERR_DISABLED_OPCODE",!1;if(t&&0<=v&&v<=Opcode.OP_PUSHDATA4){if(e&&!this.script.checkMinimalPush(this.pc-1))return this.errstr="SCRIPT_ERR_MINIMALDATA",!1;if(S.buf){if(S.len!==S.buf.length)throw new Error("Length of push value not equal to length of data");this.stack.push(S.buf)}else this.stack.push(Interpreter.false)}else if(t||Opcode.OP_IF<=v&&v<=Opcode.OP_ENDIF)switch(v){case Opcode.OP_1NEGATE:case Opcode.OP_1:case Opcode.OP_2:case Opcode.OP_3:case Opcode.OP_4:case Opcode.OP_5:case Opcode.OP_6:case Opcode.OP_7:case Opcode.OP_8:case Opcode.OP_9:case Opcode.OP_10:case Opcode.OP_11:case Opcode.OP_12:case Opcode.OP_13:case Opcode.OP_14:case Opcode.OP_15:case Opcode.OP_16:a=v-(Opcode.OP_1-1),r=new BN(a).toScriptNumBuffer(),this.stack.push(r);break;case Opcode.OP_NOP:break;case Opcode.OP_NOP2:case Opcode.OP_CHECKLOCKTIMEVERIFY:{if(!(this.flags&Interpreter.SCRIPT_VERIFY_CHECKLOCKTIMEVERIFY)){if(this.flags&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS",!1;break}if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;const t=BN.fromScriptNumBuffer(this.stack[this.stack.length-1],e,5);if(t.lt(new BN(0)))return this.errstr="SCRIPT_ERR_NEGATIVE_LOCKTIME",!1;if(!this.checkLockTime(t))return this.errstr="SCRIPT_ERR_UNSATISFIED_LOCKTIME",!1;break}case Opcode.OP_NOP1:case Opcode.OP_NOP3:case Opcode.OP_NOP4:case Opcode.OP_NOP5:case Opcode.OP_NOP6:case Opcode.OP_NOP7:case Opcode.OP_NOP8:case Opcode.OP_NOP9:case Opcode.OP_NOP10:if(this.flags&Interpreter.SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS)return this.errstr="SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS",!1;break;case Opcode.OP_IF:case Opcode.OP_NOTIF:if(b=!1,t){if(1>this.stack.length)return this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",!1;r=this.stack.pop(),b=Interpreter.castToBool(r),v===Opcode.OP_NOTIF&&(b=!b)}this.vfExec.push(b);break;case Opcode.OP_ELSE:if(0===this.vfExec.length)return this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",!1;this.vfExec[this.vfExec.length-1]=!this.vfExec[this.vfExec.length-1];break;case Opcode.OP_ENDIF:if(0===this.vfExec.length)return this.errstr="SCRIPT_ERR_UNBALANCED_CONDITIONAL",!1;this.vfExec.pop();break;case Opcode.OP_VERIFY:if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;if(r=this.stack[this.stack.length-1],!(b=Interpreter.castToBool(r)))return this.errstr="SCRIPT_ERR_VERIFY",!1;this.stack.pop();break;case Opcode.OP_RETURN:return this.errstr="SCRIPT_ERR_OP_RETURN",!1;case Opcode.OP_TOALTSTACK:if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.altstack.push(this.stack.pop());break;case Opcode.OP_FROMALTSTACK:if(1>this.altstack.length)return this.errstr="SCRIPT_ERR_INVALID_ALTSTACK_OPERATION",!1;this.stack.push(this.altstack.pop());break;case Opcode.OP_2DROP:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.pop(),this.stack.pop();break;case Opcode.OP_2DUP:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;i=this.stack[this.stack.length-2],o=this.stack[this.stack.length-1],this.stack.push(i),this.stack.push(o);break;case Opcode.OP_3DUP:{if(3>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;i=this.stack[this.stack.length-3],o=this.stack[this.stack.length-2];const e=this.stack[this.stack.length-1];this.stack.push(i),this.stack.push(o),this.stack.push(e)}break;case Opcode.OP_2OVER:if(4>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;i=this.stack[this.stack.length-4],o=this.stack[this.stack.length-3],this.stack.push(i),this.stack.push(o);break;case Opcode.OP_2ROT:if(6>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;n=this.stack.splice(this.stack.length-6,2),this.stack.push(n[0]),this.stack.push(n[1]);break;case Opcode.OP_2SWAP:if(4>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;n=this.stack.splice(this.stack.length-4,2),this.stack.push(n[0]),this.stack.push(n[1]);break;case Opcode.OP_IFDUP:if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;r=this.stack[this.stack.length-1],(b=Interpreter.castToBool(r))&&this.stack.push(r);break;case Opcode.OP_DEPTH:r=new BN(this.stack.length).toScriptNumBuffer(),this.stack.push(r);break;case Opcode.OP_DROP:if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.pop();break;case Opcode.OP_DUP:if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.push(this.stack[this.stack.length-1]);break;case Opcode.OP_NIP:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.splice(this.stack.length-2,1);break;case Opcode.OP_OVER:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.push(this.stack[this.stack.length-2]);break;case Opcode.OP_PICK:case Opcode.OP_ROLL:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;if(r=this.stack[this.stack.length-1],a=(c=BN.fromScriptNumBuffer(r,e)).toNumber(),this.stack.pop(),0>a||a>=this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;r=this.stack[this.stack.length-a-1],v===Opcode.OP_ROLL&&this.stack.splice(this.stack.length-a-1,1),this.stack.push(r);break;case Opcode.OP_ROT:{if(3>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;s=this.stack[this.stack.length-3],u=this.stack[this.stack.length-2];const e=this.stack[this.stack.length-1];this.stack[this.stack.length-3]=u,this.stack[this.stack.length-2]=e,this.stack[this.stack.length-1]=s}break;case Opcode.OP_SWAP:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;s=this.stack[this.stack.length-2],u=this.stack[this.stack.length-1],this.stack[this.stack.length-2]=u,this.stack[this.stack.length-1]=s;break;case Opcode.OP_TUCK:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;this.stack.splice(this.stack.length-2,0,this.stack[this.stack.length-1]);break;case Opcode.OP_SIZE:if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;c=new BN(this.stack[this.stack.length-1].length),this.stack.push(c.toScriptNumBuffer());break;case Opcode.OP_EQUAL:case Opcode.OP_EQUALVERIFY:{if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;i=this.stack[this.stack.length-2],o=this.stack[this.stack.length-1];const e=i.toString("hex")===o.toString("hex");if(this.stack.pop(),this.stack.pop(),this.stack.push(e?Interpreter.true:Interpreter.false),v===Opcode.OP_EQUALVERIFY){if(!e)return this.errstr="SCRIPT_ERR_EQUALVERIFY",!1;this.stack.pop()}}break;case Opcode.OP_1ADD:case Opcode.OP_1SUB:case Opcode.OP_NEGATE:case Opcode.OP_ABS:case Opcode.OP_NOT:case Opcode.OP_0NOTEQUAL:if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;switch(r=this.stack[this.stack.length-1],c=BN.fromScriptNumBuffer(r,e),v){case Opcode.OP_1ADD:c=c.add(BN.One);break;case Opcode.OP_1SUB:c=c.sub(BN.One);break;case Opcode.OP_NEGATE:c=c.neg();break;case Opcode.OP_ABS:0>c.cmp(BN.Zero)&&(c=c.neg());break;case Opcode.OP_NOT:c=new BN((0===c.cmp(BN.Zero))+0);break;case Opcode.OP_0NOTEQUAL:c=new BN((0!==c.cmp(BN.Zero))+0);break;default:throw new Error("Ended up in a default switch statement that should never be executed.")}this.stack.pop(),this.stack.push(c.toScriptNumBuffer());break;case Opcode.OP_ADD:case Opcode.OP_SUB:case Opcode.OP_BOOLAND:case Opcode.OP_BOOLOR:case Opcode.OP_NUMEQUAL:case Opcode.OP_NUMEQUALVERIFY:case Opcode.OP_NUMNOTEQUAL:case Opcode.OP_LESSTHAN:case Opcode.OP_GREATERTHAN:case Opcode.OP_LESSTHANOREQUAL:case Opcode.OP_GREATERTHANOREQUAL:case Opcode.OP_MIN:case Opcode.OP_MAX:if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;switch(l=BN.fromScriptNumBuffer(this.stack[this.stack.length-2],e),p=BN.fromScriptNumBuffer(this.stack[this.stack.length-1],e),c=new BN(0),v){case Opcode.OP_ADD:c=l.add(p);break;case Opcode.OP_SUB:c=l.sub(p);break;case Opcode.OP_BOOLAND:c=new BN((0!==l.cmp(BN.Zero)&&0!==p.cmp(BN.Zero))+0);break;case Opcode.OP_BOOLOR:c=new BN((0!==l.cmp(BN.Zero)||0!==p.cmp(BN.Zero))+0);break;case Opcode.OP_NUMEQUAL:case Opcode.OP_NUMEQUALVERIFY:c=new BN((0===l.cmp(p))+0);break;case Opcode.OP_NUMNOTEQUAL:c=new BN((0!==l.cmp(p))+0);break;case Opcode.OP_LESSTHAN:c=new BN((0>l.cmp(p))+0);break;case Opcode.OP_GREATERTHAN:c=new BN((0<l.cmp(p))+0);break;case Opcode.OP_LESSTHANOREQUAL:c=new BN((0>=l.cmp(p))+0);break;case Opcode.OP_GREATERTHANOREQUAL:c=new BN((0<=l.cmp(p))+0);break;case Opcode.OP_MIN:c=0>l.cmp(p)?l:p;break;case Opcode.OP_MAX:c=0<l.cmp(p)?l:p;break;default:throw new Error("Ended up in a default switch statement that should never be executed.")}if(this.stack.pop(),this.stack.pop(),this.stack.push(c.toScriptNumBuffer()),v===Opcode.OP_NUMEQUALVERIFY){if(!Interpreter.castToBool(this.stack[this.stack.length-1]))return this.errstr="SCRIPT_ERR_NUMEQUALVERIFY",!1;this.stack.pop()}break;case Opcode.OP_WITHIN:{if(3>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;l=BN.fromScriptNumBuffer(this.stack[this.stack.length-3],e),p=BN.fromScriptNumBuffer(this.stack[this.stack.length-2],e);const t=BN.fromScriptNumBuffer(this.stack[this.stack.length-1],e);b=0>=p.cmp(l)&&0>l.cmp(t),this.stack.pop(),this.stack.pop(),this.stack.pop(),this.stack.push(b?Interpreter.true:Interpreter.false)}break;case Opcode.OP_RIPEMD160:case Opcode.OP_SHA1:case Opcode.OP_SHA256:case Opcode.OP_HASH160:case Opcode.OP_HASH256:{if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;let e;r=this.stack[this.stack.length-1],v===Opcode.OP_RIPEMD160?e=Hash.ripemd160(r):v===Opcode.OP_SHA1?e=Hash.sha1(r):v===Opcode.OP_SHA256?e=Hash.sha256(r):v===Opcode.OP_HASH160?e=Hash.sha256ripemd160(r):v===Opcode.OP_HASH256&&(e=Hash.sha256sha256(r)),this.stack.pop(),this.stack.push(e)}break;case Opcode.OP_CODESEPARATOR:this.pbegincodehash=this.pc;break;case Opcode.OP_CHECKSIG:case Opcode.OP_CHECKSIGVERIFY:{if(2>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;h=this.stack[this.stack.length-2],f=this.stack[this.stack.length-1],d=(new Script).set({chunks:this.script.chunks.slice(this.pbegincodehash)});const e=(new Script).add(h);if(d.findAndDelete(e),!this.checkSignatureEncoding(h)||!this.checkPubkeyEncoding(f))return!1;try{m=Signature.fromTxFormat(h),g=PublicKey.fromBuffer(f,!1),y=this.tx.verifySignature(m,g,this.nin,d)}catch(e){y=!1}if(this.stack.pop(),this.stack.pop(),this.stack.push(y?Interpreter.true:Interpreter.false),v===Opcode.OP_CHECKSIGVERIFY){if(!y)return this.errstr="SCRIPT_ERR_CHECKSIGVERIFY",!1;this.stack.pop()}}break;case Opcode.OP_CHECKMULTISIG:case Opcode.OP_CHECKMULTISIGVERIFY:{let t=1;if(this.stack.length<t)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;let r=BN.fromScriptNumBuffer(this.stack[this.stack.length-t],e).toNumber();if(0>r||20<r)return this.errstr="SCRIPT_ERR_PUBKEY_COUNT",!1;if(this.nOpCount+=r,201<this.nOpCount)return this.errstr="SCRIPT_ERR_OP_COUNT",!1;let i=t+=1;if(t+=r,this.stack.length<t)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;let o=BN.fromScriptNumBuffer(this.stack[this.stack.length-t],e).toNumber();if(0>o||o>r)return this.errstr="SCRIPT_ERR_SIG_COUNT",!1;let n=t+=1;if(t+=o,this.stack.length<t)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;d=(new Script).set({chunks:this.script.chunks.slice(this.pbegincodehash)});for(let e=0;e<o;e+=1)h=this.stack[this.stack.length-n-e],d.findAndDelete((new Script).add(h));for(y=!0;y&&0<o;){if(h=this.stack[this.stack.length-n],f=this.stack[this.stack.length-i],!this.checkSignatureEncoding(h)||!this.checkPubkeyEncoding(f))return!1;let e;try{m=Signature.fromTxFormat(h),g=PublicKey.fromBuffer(f,!1),e=this.tx.verifySignature(m,g,this.nin,d)}catch(t){e=!1}e&&(n+=1,o-=1),i+=1,o>(r-=1)&&(y=!1)}for(;1<t;)t-=1,this.stack.pop();if(1>this.stack.length)return this.errstr="SCRIPT_ERR_INVALID_STACK_OPERATION",!1;if(this.flags&Interpreter.SCRIPT_VERIFY_NULLDUMMY&&this.stack[this.stack.length-1].length)return this.errstr="SCRIPT_ERR_SIG_NULLDUMMY",!1;if(this.stack.pop(),this.stack.push(y?Interpreter.true:Interpreter.false),v===Opcode.OP_CHECKMULTISIGVERIFY){if(!y)return this.errstr="SCRIPT_ERR_CHECKMULTISIGVERIFY",!1;this.stack.pop()}}break;default:return this.errstr="SCRIPT_ERR_BAD_OPCODE",!1}return!0};class ScriptHashInput extends Input{constructor(e,t,r){super(e,t,r);const i=this;this.publicKeys=t||e.publicKeys,this.threshold=1,this.redeemScript=r,preconditions.checkState(Script.buildScriptHashOut(this.redeemScript).equals(this.output.script),"Provided redeemScript doesn't hash to the provided output"),this.publicKeyIndex={},this.publicKeys.forEach((e,t)=>{i.publicKeyIndex[e.toString()]=t}),this.signatures=Array(this.publicKeys.length)}toObject(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];const i=Input.prototype.toObject.apply(this,t);return i.threshold=this.threshold,i.publicKeys=this.publicKeys.map(e=>e.toString()),i.signatures=this._serializeSignatures(),i}_deserializeSignatures(e){return e.map(e=>e?new TransactionSignature(e):void 0)}_serializeSignatures(){return this.signatures.map(e=>e?e.toObject():void 0)}getSignatures(e,t,r,i){return preconditions.checkState(this.output instanceof Output,"Malformed output found when signing transaction"),i=i||Signature.SIGHASH_ALL|Signature.SIGHASH_FORKID,this.publicKeys.filter(e=>e.toString()===t.publicKey.toString()).map(o=>new TransactionSignature({publicKey:o,prevTxId:this.prevTxId,outputIndex:this.outputIndex,inputIndex:r,signature:Sighash.sign(e,t,i,r,this.output.script,this.output.satoshisBN),sigtype:i}))}addSignature(e,t){return preconditions.checkState(!this.isFullySigned(),"All needed signatures have already been added"),preconditions.checkArgument(void 0!==this.publicKeyIndex[t.publicKey.toString()],"Signature has no matching public key"),preconditions.checkState(this.isValidSignature(e,t)),this.signatures[this.publicKeyIndex[t.publicKey.toString()]]=t,this._updateScript(),this}_updateScript(){return this.setScript(Script.buildP2SHMultisigIn(this.publicKeys,this.threshold,this._createSignatures(),{cachedMultisig:this.redeemScript})),this}_createSignatures(){return this.signatures.filter(e=>void 0!==e).map(e=>BufferUtil.concat([e.signature.toDER(),BufferUtil.integerAsSingleByteBuffer(e.sigtype)]))}clearSignatures(){this.signatures=Array(this.publicKeys.length),this._updateScript()}isFullySigned(){return this.countSignatures()===this.threshold}countMissingSignatures(){return this.threshold-this.countSignatures()}countSignatures(){return this.signatures.reduce((e,t)=>e+!!t,0)}publicKeysWithoutSignature(){const e=this;return this.publicKeys.filter(t=>!e.signatures[e.publicKeyIndex[t.toString()]])}isValidSignature(e,t){return t.signature.nhashtype=t.sigtype,Sighash.verify(e,t.signature,t.publicKey,t.inputIndex,this.redeemScript,this.output.satoshisBN)}_estimateSize(){return ScriptHashInput.OPCODES_SIZE+this.threshold*ScriptHashInput.SIGNATURE_SIZE+this.publicKeys.length*ScriptHashInput.PUBKEY_SIZE}}ScriptHashInput.OPCODES_SIZE=7,ScriptHashInput.SIGNATURE_SIZE=74,ScriptHashInput.PUBKEY_SIZE=34;const TXID_REGEX=/[0-9A-Fa-f]{64}/;class OutputId{constructor(e,t){if(!TXID_REGEX.test(e))throw new Error("txId not in a valid hex format: ".concat(e));if(0>t||4294967295<t||Number.isNaN(t))throw new Error("outputIndex out of range: ".concat(t));this.txId=e,this.outputIndex=t}toString(){return"".concat(this.txId,":").concat(this.outputIndex)}static fromString(e){const t=e.split(":");if(2!==t.length)throw new Error("Invalid string format");return new OutputId(t[0],parseInt(t[1],10))}get txid(){return this.txId}get vout(){return this.outputIndex}equals(e){return this.outputIndex===e.outputIndex&&this.txId.toLowerCase()===e.txId.toLowerCase()}}const URI=function(e,t){if(!(this instanceof URI))return new URI(e,t);if(this.extras={},this.knownParams=t||[],this.address=null,this.network=null,this.amount=null,this.message=null,"string"==typeof e){const t=URI.parse(e);t.amount&&(t.amount=this._parseAmount(t.amount)),this._fromObject(t)}else{if("object"!=typeof e)throw new TypeError("Unrecognized data format.");this._fromObject(e)}};URI.fromString=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return new URI(e)},URI.fromObject=function(e){return new URI(e)},URI.isValid=function(e,t){try{new URI(e,t)}catch(e){return!1}return!0},URI.parse=function(e){const t=URL.parse(e,!0);if("bitcoincash:"!==t.protocol)throw new TypeError("Invalid bitcoin cash URI");const r=/[^:]*:\/?\/?([^?]*)/.exec(e);return t.query.address=r&&r[1]||void 0,t.query},URI.Members=["address","amount","message","label","r"],URI.prototype._fromObject=function(e){if(!Address.isValid(e.address))throw new TypeError("Invalid bitcoin address");this.address=new Address(e.address),this.network=this.address.network,this.amount=e.amount,Object.keys(e).forEach(t=>{if("address"!==t&&"amount"!==t){if(/^req-/.exec(t)&&-1===this.knownParams.indexOf(t))throw Error("Unknown required argument ".concat(t));(-1<URI.Members.indexOf(t)?this:this.extras)[t]=e[t]}})},URI.prototype._parseAmount=function(e){if(e=+e,Number.isNaN(e))throw new TypeError("Invalid amount");return Unit.fromBTC(e).toSatoshis()},URI.prototype.toJSON=function(){const e={};for(let t=0;t<URI.Members.length;t+=1){const r=URI.Members[t];1!==Object.keys(this).findIndex(e=>e===r)&&void 0!==this[r]&&(e[r]=this[r].toString())}return _.extend(e,this.extras),e},URI.prototype.toObject=URI.prototype.toJSON,URI.prototype.toString=function(){const e={};return this.amount&&(e.amount=Unit.fromSatoshis(this.amount).toBTC()),this.message&&(e.message=this.message),this.label&&(e.label=this.label),this.r&&(e.r=this.r),_.extend(e,this.extras),URL.format({protocol:"bitcoincash:",host:this.address,query:e})},URI.prototype.inspect=function(){return"<URI: ".concat(this.toString(),">")};const Varint=function e(t){if(!(this instanceof e))return new e(t);Buffer.isBuffer(t)?this.buf=t:"number"==typeof t?this.fromNumber(t):t instanceof BN?this.fromBN(t):t&&this.set(t)};Varint.prototype.set=function(e){return this.buf=e.buf||this.buf,this},Varint.prototype.fromString=function(e){return this.set({buf:Buffer.from(e,"hex")}),this},Varint.prototype.toString=function(){return this.buf.toString("hex")},Varint.prototype.fromBuffer=function(e){return this.buf=e,this},Varint.prototype.fromBufferReader=function(e){return this.buf=e.readVarintBuf(),this},Varint.prototype.fromBN=function(e){return this.buf=BufferWriter().writeVarintBN(e).concat(),this},Varint.prototype.fromNumber=function(e){return this.buf=BufferWriter().writeVarintNum(e).concat(),this},Varint.prototype.toBuffer=function(){return this.buf},Varint.prototype.toBN=function(){return BufferReader(this.buf).readVarintBN()},Varint.prototype.toNumber=function(){return BufferReader(this.buf).readVarintNum()};const Bitcoin={};Bitcoin.version="v".concat(PackageInfo.version),Bitcoin.versionGuard=function(){},Bitcoin.versionGuard(global._bitcoin),global._bitcoin=Bitcoin.version,Bitcoin.crypto={},Bitcoin.crypto.BN=BN,Bitcoin.crypto.ECDSA=ECDSA,Bitcoin.crypto.Hash=Hash,Bitcoin.crypto.Random=Random,Bitcoin.crypto.Point=Point,Bitcoin.crypto.Signature=Signature,Bitcoin.encoding={},Bitcoin.encoding.Base58=Base58,Bitcoin.encoding.Base58Check=Base58Check,Bitcoin.encoding.BufferReader=BufferReader,Bitcoin.encoding.BufferWriter=BufferWriter,Bitcoin.encoding.Varint=Varint,Bitcoin.util={},Bitcoin.util.buffer=BufferUtil,Bitcoin.util.js=JSUtil,Bitcoin.util.preconditions=preconditions,Bitcoin.errors=errors,Bitcoin.Address=Address,Bitcoin.Block=Block,Bitcoin.Block.BlockHeader=BlockHeader,Bitcoin.Block.MerkleBlock=MerkleBlock,Bitcoin.BlockHeader=BlockHeader,Bitcoin.HDPrivateKey=HDPrivateKey,Bitcoin.HDPublicKey=HDPublicKey,Bitcoin.MerkleBlock=MerkleBlock,Bitcoin.Message=Message,Bitcoin.Mnemonic=Mnemonic,Bitcoin.Networks=Networks,Bitcoin.Opcode=Opcode,Bitcoin.PrivateKey=PrivateKey,Bitcoin.PublicKey=PublicKey,Bitcoin.Script=Script,Bitcoin.Script.Interpreter=Interpreter,Bitcoin.Transaction=Transaction,Bitcoin.Transaction.Input=Input,Bitcoin.Transaction.Input.MultiSig=MultiSigInput,Bitcoin.Transaction.Input.MultiSigScriptHash=MultiSigScriptHashInput,Bitcoin.Transaction.Input.PublicKey=PublicKeyInput,Bitcoin.Transaction.Input.PublicKeyHash=PublicKeyHashInput,Bitcoin.Transaction.Input.ScriptHash=ScriptHashInput,Bitcoin.Transaction.Output=Output,Bitcoin.Transaction.OutputId=OutputId,Bitcoin.Transaction.Sighash=Sighash,Bitcoin.Transaction.Signature=TransactionSignature,Bitcoin.Transaction.UnspentOutput=UnspentOutput,Bitcoin.Unit=Unit,Bitcoin.URI=URI,Bitcoin.deps={},Bitcoin.deps.bnjs=BN,Bitcoin.deps.bs58=bs58,Bitcoin.deps.Buffer=Buffer,Bitcoin.deps.elliptic=elliptic,Bitcoin.deps._=_,module.exports=Bitcoin;